module.exports=function(e,t){"use strict";var r={};function __webpack_require__(t){if(r[t]){return r[t].exports}var i=r[t]={i:t,l:false,exports:{}};var n=true;try{e[t].call(i.exports,i,i.exports,__webpack_require__);n=false}finally{if(n)delete r[t]}i.l=true;return i.exports}__webpack_require__.ab=__dirname+"/";function startup(){return __webpack_require__(903)}return startup()}({5:function(e,t,r){var i=r(936);r(621);var n=e.exports=i.pem=i.pem||{};n.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+"-----\r\n";var n;if(e.procType){n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]};r+=foldHeader(n)}if(e.contentDomain){n={name:"Content-Domain",values:[e.contentDomain]};r+=foldHeader(n)}if(e.dekInfo){n={name:"DEK-Info",values:[e.dekInfo.algorithm]};if(e.dekInfo.parameters){n.values.push(e.dekInfo.parameters)}r+=foldHeader(n)}if(e.headers){for(var a=0;a<e.headers.length;++a){r+=foldHeader(e.headers[a])}}if(e.procType){r+="\r\n"}r+=i.util.encode64(e.body,t.maxline||64)+"\r\n";r+="-----END "+e.type+"-----\r\n";return r};n.decode=function(e){var t=[];var r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g;var n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/;var a=/\r?\n/;var s;while(true){s=r.exec(e);if(!s){break}var o={type:s[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:i.util.decode64(s[3])};t.push(o);if(!s[2]){continue}var u=s[2].split(a);var f=0;while(s&&f<u.length){var c=u[f].replace(/\s+$/,"");for(var l=f+1;l<u.length;++l){var h=u[l];if(!/\s/.test(h[0])){break}c+=h;f=l}s=c.match(n);if(s){var p={name:s[1],values:[]};var d=s[2].split(",");for(var y=0;y<d.length;++y){p.values.push(ltrim(d[y]))}if(!o.procType){if(p.name!=="Proc-Type"){throw new Error("Invalid PEM formatted message. The first "+'encapsulated header must be "Proc-Type".')}else if(p.values.length!==2){throw new Error('Invalid PEM formatted message. The "Proc-Type" '+"header must have two subfields.")}o.procType={version:d[0],type:d[1]}}else if(!o.contentDomain&&p.name==="Content-Domain"){o.contentDomain=d[0]||""}else if(!o.dekInfo&&p.name==="DEK-Info"){if(p.values.length===0){throw new Error('Invalid PEM formatted message. The "DEK-Info" '+"header must have at least one subfield.")}o.dekInfo={algorithm:d[0],parameters:d[1]||null}}else{o.headers.push(p)}}++f}if(o.procType==="ENCRYPTED"&&!o.dekInfo){throw new Error('Invalid PEM formatted message. The "DEK-Info" '+'header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0){throw new Error("Invalid PEM formatted message.")}return t};function foldHeader(e){var t=e.name+": ";var r=[];var i=function(e,t){return" "+t};for(var n=0;n<e.values.length;++n){r.push(e.values[n].replace(/^(\S+\r\n)/,i))}t+=r.join(",")+"\r\n";var a=0;var s=-1;for(var n=0;n<t.length;++n,++a){if(a>65&&s!==-1){var o=t[s];if(o===","){++s;t=t.substr(0,s)+"\r\n "+t.substr(s)}else{t=t.substr(0,s)+"\r\n"+o+t.substr(s+1)}a=n-s-1;s=-1;++n}else if(t[n]===" "||t[n]==="\t"||t[n]===","){s=n}}return t}function ltrim(e){return e.replace(/^\s+/,"")}},6:function(e,t,r){var i=r(936);r(621);i.mgf=i.mgf||{};var n=e.exports=i.mgf.mgf1=i.mgf1=i.mgf1||{};n.create=function(e){var t={generate:function(t,r){var n=new i.util.ByteBuffer;var a=Math.ceil(r/e.digestLength);for(var s=0;s<a;s++){var o=new i.util.ByteBuffer;o.putInt32(s);e.start();e.update(t+o.getBytes());n.putBuffer(e.digest())}n.truncate(n.length()-r);return n.getBytes()}};return t}},25:function(e,t,r){var i=r(936);r(620);r(511);r(71);r(607);r(419);r(400);r(5);r(84);r(789);r(621);var n=i.asn1;var a=e.exports=i.pki=i.pki||{};var s=a.oids;var o={};o["CN"]=s["commonName"];o["commonName"]="CN";o["C"]=s["countryName"];o["countryName"]="C";o["L"]=s["localityName"];o["localityName"]="L";o["ST"]=s["stateOrProvinceName"];o["stateOrProvinceName"]="ST";o["O"]=s["organizationName"];o["organizationName"]="O";o["OU"]=s["organizationalUnitName"];o["organizationalUnitName"]="OU";o["E"]=s["emailAddress"];o["emailAddress"]="E";var u=i.pki.rsa.publicKeyValidator;var f={name:"Certificate",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:n.Class.UNIVERSAL,optional:true,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:n.Class.UNIVERSAL,type:n.Type.UTCTIME,constructed:false,optional:true,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:n.Class.UNIVERSAL,type:n.Type.GENERALIZEDTIME,constructed:false,optional:true,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:n.Class.UNIVERSAL,type:n.Type.UTCTIME,constructed:false,optional:true,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:n.Class.UNIVERSAL,type:n.Type.GENERALIZEDTIME,constructed:false,optional:true,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,captureAsn1:"certSubject"},u,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:false,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:n.Class.CONTEXT_SPECIFIC,type:2,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:false,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:n.Class.CONTEXT_SPECIFIC,type:3,constructed:true,captureAsn1:"certExtensions",optional:true}]},{name:"Certificate.signatureAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:n.Class.UNIVERSAL,optional:true,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:false,captureBitStringValue:"certSignature"}]};var c={name:"rsapss",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"rsapss.hashAlgorithm",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:true,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:n.Class.UNIVERSAL,type:n.Class.SEQUENCE,constructed:true,optional:true,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,constructed:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:n.Class.UNIVERSAL,type:n.Class.SEQUENCE,constructed:true,optional:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:n.Class.CONTEXT_SPECIFIC,type:2,optional:true,value:[{name:"rsapss.saltLength.saltLength",tagClass:n.Class.UNIVERSAL,type:n.Class.INTEGER,constructed:false,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:n.Class.CONTEXT_SPECIFIC,type:3,optional:true,value:[{name:"rsapss.trailer.trailer",tagClass:n.Class.UNIVERSAL,type:n.Class.INTEGER,constructed:false,capture:"trailer"}]}]};var l={name:"CertificationRequestInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,captureAsn1:"certificationRequestInfoSubject"},u,{name:"CertificationRequestInfo.attributes",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false},{name:"CertificationRequestInfo.attributes.value",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:true}]}]}]};var h={name:"CertificationRequest",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,captureAsn1:"csr",value:[l,{name:"CertificationRequest.signatureAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:n.Class.UNIVERSAL,optional:true,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:false,captureBitStringValue:"csrSignature"}]};a.RDNAttributesAsArray=function(e,t){var r=[];var i,a,u;for(var f=0;f<e.value.length;++f){i=e.value[f];for(var c=0;c<i.value.length;++c){u={};a=i.value[c];u.type=n.derToOid(a.value[0].value);u.value=a.value[1].value;u.valueTagClass=a.value[1].type;if(u.type in s){u.name=s[u.type];if(u.name in o){u.shortName=o[u.name]}}if(t){t.update(u.type);t.update(u.value)}r.push(u)}}return r};a.CRIAttributesAsArray=function(e){var t=[];for(var r=0;r<e.length;++r){var i=e[r];var u=n.derToOid(i.value[0].value);var f=i.value[1].value;for(var c=0;c<f.length;++c){var l={};l.type=u;l.value=f[c].value;l.valueTagClass=f[c].type;if(l.type in s){l.name=s[l.type];if(l.name in o){l.shortName=o[l.name]}}if(l.type===s.extensionRequest){l.extensions=[];for(var h=0;h<l.value.length;++h){l.extensions.push(a.certificateExtensionFromAsn1(l.value[h]))}}t.push(l)}}return t};function _getAttribute(e,t){if(typeof t==="string"){t={shortName:t}}var r=null;var i;for(var n=0;r===null&&n<e.attributes.length;++n){i=e.attributes[n];if(t.type&&t.type===i.type){r=i}else if(t.name&&t.name===i.name){r=i}else if(t.shortName&&t.shortName===i.shortName){r=i}}return r}var p=function(e,t,r){var i={};if(e!==s["RSASSA-PSS"]){return i}if(r){i={hash:{algorithmOid:s["sha1"]},mgf:{algorithmOid:s["mgf1"],hash:{algorithmOid:s["sha1"]}},saltLength:20}}var a={};var o=[];if(!n.validate(t,c,a,o)){var u=new Error("Cannot read RSASSA-PSS parameter block.");u.errors=o;throw u}if(a.hashOid!==undefined){i.hash=i.hash||{};i.hash.algorithmOid=n.derToOid(a.hashOid)}if(a.maskGenOid!==undefined){i.mgf=i.mgf||{};i.mgf.algorithmOid=n.derToOid(a.maskGenOid);i.mgf.hash=i.mgf.hash||{};i.mgf.hash.algorithmOid=n.derToOid(a.maskGenHashOid)}if(a.saltLength!==undefined){i.saltLength=a.saltLength.charCodeAt(0)}return i};a.certificateFromPem=function(e,t,r){var s=i.pem.decode(e)[0];if(s.type!=="CERTIFICATE"&&s.type!=="X509 CERTIFICATE"&&s.type!=="TRUSTED CERTIFICATE"){var o=new Error("Could not convert certificate from PEM; PEM header type "+'is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');o.headerType=s.type;throw o}if(s.procType&&s.procType.type==="ENCRYPTED"){throw new Error("Could not convert certificate from PEM; PEM is encrypted.")}var u=n.fromDer(s.body,r);return a.certificateFromAsn1(u,t)};a.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:n.toDer(a.certificateToAsn1(e)).getBytes()};return i.pem.encode(r,{maxline:t})};a.publicKeyFromPem=function(e){var t=i.pem.decode(e)[0];if(t.type!=="PUBLIC KEY"&&t.type!=="RSA PUBLIC KEY"){var r=new Error("Could not convert public key from PEM; PEM header "+'type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');r.headerType=t.type;throw r}if(t.procType&&t.procType.type==="ENCRYPTED"){throw new Error("Could not convert public key from PEM; PEM is encrypted.")}var s=n.fromDer(t.body);return a.publicKeyFromAsn1(s)};a.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:n.toDer(a.publicKeyToAsn1(e)).getBytes()};return i.pem.encode(r,{maxline:t})};a.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:n.toDer(a.publicKeyToRSAPublicKey(e)).getBytes()};return i.pem.encode(r,{maxline:t})};a.getPublicKeyFingerprint=function(e,t){t=t||{};var r=t.md||i.md.sha1.create();var s=t.type||"RSAPublicKey";var o;switch(s){case"RSAPublicKey":o=n.toDer(a.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":o=n.toDer(a.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}r.start();r.update(o);var u=r.digest();if(t.encoding==="hex"){var f=u.toHex();if(t.delimiter){return f.match(/.{2}/g).join(t.delimiter)}return f}else if(t.encoding==="binary"){return u.getBytes()}else if(t.encoding){throw new Error('Unknown encoding "'+t.encoding+'".')}return u};a.certificationRequestFromPem=function(e,t,r){var s=i.pem.decode(e)[0];if(s.type!=="CERTIFICATE REQUEST"){var o=new Error("Could not convert certification request from PEM; "+'PEM header type is not "CERTIFICATE REQUEST".');o.headerType=s.type;throw o}if(s.procType&&s.procType.type==="ENCRYPTED"){throw new Error("Could not convert certification request from PEM; "+"PEM is encrypted.")}var u=n.fromDer(s.body,r);return a.certificationRequestFromAsn1(u,t)};a.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:n.toDer(a.certificationRequestToAsn1(e)).getBytes()};return i.pem.encode(r,{maxline:t})};a.createCertificate=function(){var e={};e.version=2;e.serialNumber="00";e.signatureOid=null;e.signature=null;e.siginfo={};e.siginfo.algorithmOid=null;e.validity={};e.validity.notBefore=new Date;e.validity.notAfter=new Date;e.issuer={};e.issuer.getField=function(t){return _getAttribute(e.issuer,t)};e.issuer.addField=function(t){_fillMissingFields([t]);e.issuer.attributes.push(t)};e.issuer.attributes=[];e.issuer.hash=null;e.subject={};e.subject.getField=function(t){return _getAttribute(e.subject,t)};e.subject.addField=function(t){_fillMissingFields([t]);e.subject.attributes.push(t)};e.subject.attributes=[];e.subject.hash=null;e.extensions=[];e.publicKey=null;e.md=null;e.setSubject=function(t,r){_fillMissingFields(t);e.subject.attributes=t;delete e.subject.uniqueId;if(r){e.subject.uniqueId=r}e.subject.hash=null};e.setIssuer=function(t,r){_fillMissingFields(t);e.issuer.attributes=t;delete e.issuer.uniqueId;if(r){e.issuer.uniqueId=r}e.issuer.hash=null};e.setExtensions=function(t){for(var r=0;r<t.length;++r){_fillMissingExtensionFields(t[r],{cert:e})}e.extensions=t};e.getExtension=function(t){if(typeof t==="string"){t={name:t}}var r=null;var i;for(var n=0;r===null&&n<e.extensions.length;++n){i=e.extensions[n];if(t.id&&i.id===t.id){r=i}else if(t.name&&i.name===t.name){r=i}}return r};e.sign=function(t,r){e.md=r||i.md.sha1.create();var o=s[e.md.algorithm+"WithRSAEncryption"];if(!o){var u=new Error("Could not compute certificate digest. "+"Unknown message digest algorithm OID.");u.algorithm=e.md.algorithm;throw u}e.signatureOid=e.siginfo.algorithmOid=o;e.tbsCertificate=a.getTBSCertificate(e);var f=n.toDer(e.tbsCertificate);e.md.update(f.getBytes());e.signature=t.sign(e.md)};e.verify=function(t){var r=false;if(!e.issued(t)){var o=t.issuer;var u=e.subject;var f=new Error("The parent certificate did not issue the given child "+"certificate; the child certificate's issuer does not match the "+"parent's subject.");f.expectedIssuer=o.attributes;f.actualIssuer=u.attributes;throw f}var c=t.md;if(c===null){if(t.signatureOid in s){var l=s[t.signatureOid];switch(l){case"sha1WithRSAEncryption":c=i.md.sha1.create();break;case"md5WithRSAEncryption":c=i.md.md5.create();break;case"sha256WithRSAEncryption":c=i.md.sha256.create();break;case"sha384WithRSAEncryption":c=i.md.sha384.create();break;case"sha512WithRSAEncryption":c=i.md.sha512.create();break;case"RSASSA-PSS":c=i.md.sha256.create();break}}if(c===null){var f=new Error("Could not compute certificate digest. "+"Unknown signature OID.");f.signatureOid=t.signatureOid;throw f}var h=t.tbsCertificate||a.getTBSCertificate(t);var p=n.toDer(h);c.update(p.getBytes())}if(c!==null){var d;switch(t.signatureOid){case s.sha1WithRSAEncryption:d=undefined;break;case s["RSASSA-PSS"]:var y,g;y=s[t.signatureParameters.mgf.hash.algorithmOid];if(y===undefined||i.md[y]===undefined){var f=new Error("Unsupported MGF hash function.");f.oid=t.signatureParameters.mgf.hash.algorithmOid;f.name=y;throw f}g=s[t.signatureParameters.mgf.algorithmOid];if(g===undefined||i.mgf[g]===undefined){var f=new Error("Unsupported MGF function.");f.oid=t.signatureParameters.mgf.algorithmOid;f.name=g;throw f}g=i.mgf[g].create(i.md[y].create());y=s[t.signatureParameters.hash.algorithmOid];if(y===undefined||i.md[y]===undefined){throw{message:"Unsupported RSASSA-PSS hash function.",oid:t.signatureParameters.hash.algorithmOid,name:y}}d=i.pss.create(i.md[y].create(),g,t.signatureParameters.saltLength);break}r=e.publicKey.verify(c.digest().getBytes(),t.signature,d)}return r};e.isIssuer=function(t){var r=false;var i=e.issuer;var n=t.subject;if(i.hash&&n.hash){r=i.hash===n.hash}else if(i.attributes.length===n.attributes.length){r=true;var a,s;for(var o=0;r&&o<i.attributes.length;++o){a=i.attributes[o];s=n.attributes[o];if(a.type!==s.type||a.value!==s.value){r=false}}}return r};e.issued=function(t){return t.isIssuer(e)};e.generateSubjectKeyIdentifier=function(){return a.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})};e.verifySubjectKeyIdentifier=function(){var t=s["subjectKeyIdentifier"];for(var r=0;r<e.extensions.length;++r){var n=e.extensions[r];if(n.id===t){var a=e.generateSubjectKeyIdentifier().getBytes();return i.util.hexToBytes(n.subjectKeyIdentifier)===a}}return false};return e};a.certificateFromAsn1=function(e,t){var r={};var o=[];if(!n.validate(e,f,r,o)){var u=new Error("Cannot read X.509 certificate. "+"ASN.1 object is not an X509v3 Certificate.");u.errors=o;throw u}var c=n.derToOid(r.publicKeyOid);if(c!==a.oids.rsaEncryption){throw new Error("Cannot read public key. OID is not RSA.")}var l=a.createCertificate();l.version=r.certVersion?r.certVersion.charCodeAt(0):0;var h=i.util.createBuffer(r.certSerialNumber);l.serialNumber=h.toHex();l.signatureOid=i.asn1.derToOid(r.certSignatureOid);l.signatureParameters=p(l.signatureOid,r.certSignatureParams,true);l.siginfo.algorithmOid=i.asn1.derToOid(r.certinfoSignatureOid);l.siginfo.parameters=p(l.siginfo.algorithmOid,r.certinfoSignatureParams,false);l.signature=r.certSignature;var d=[];if(r.certValidity1UTCTime!==undefined){d.push(n.utcTimeToDate(r.certValidity1UTCTime))}if(r.certValidity2GeneralizedTime!==undefined){d.push(n.generalizedTimeToDate(r.certValidity2GeneralizedTime))}if(r.certValidity3UTCTime!==undefined){d.push(n.utcTimeToDate(r.certValidity3UTCTime))}if(r.certValidity4GeneralizedTime!==undefined){d.push(n.generalizedTimeToDate(r.certValidity4GeneralizedTime))}if(d.length>2){throw new Error("Cannot read notBefore/notAfter validity times; more "+"than two times were provided in the certificate.")}if(d.length<2){throw new Error("Cannot read notBefore/notAfter validity times; they "+"were not provided as either UTCTime or GeneralizedTime.")}l.validity.notBefore=d[0];l.validity.notAfter=d[1];l.tbsCertificate=r.tbsCertificate;if(t){l.md=null;if(l.signatureOid in s){var c=s[l.signatureOid];switch(c){case"sha1WithRSAEncryption":l.md=i.md.sha1.create();break;case"md5WithRSAEncryption":l.md=i.md.md5.create();break;case"sha256WithRSAEncryption":l.md=i.md.sha256.create();break;case"sha384WithRSAEncryption":l.md=i.md.sha384.create();break;case"sha512WithRSAEncryption":l.md=i.md.sha512.create();break;case"RSASSA-PSS":l.md=i.md.sha256.create();break}}if(l.md===null){var u=new Error("Could not compute certificate digest. "+"Unknown signature OID.");u.signatureOid=l.signatureOid;throw u}var y=n.toDer(l.tbsCertificate);l.md.update(y.getBytes())}var g=i.md.sha1.create();l.issuer.getField=function(e){return _getAttribute(l.issuer,e)};l.issuer.addField=function(e){_fillMissingFields([e]);l.issuer.attributes.push(e)};l.issuer.attributes=a.RDNAttributesAsArray(r.certIssuer,g);if(r.certIssuerUniqueId){l.issuer.uniqueId=r.certIssuerUniqueId}l.issuer.hash=g.digest().toHex();var v=i.md.sha1.create();l.subject.getField=function(e){return _getAttribute(l.subject,e)};l.subject.addField=function(e){_fillMissingFields([e]);l.subject.attributes.push(e)};l.subject.attributes=a.RDNAttributesAsArray(r.certSubject,v);if(r.certSubjectUniqueId){l.subject.uniqueId=r.certSubjectUniqueId}l.subject.hash=v.digest().toHex();if(r.certExtensions){l.extensions=a.certificateExtensionsFromAsn1(r.certExtensions)}else{l.extensions=[]}l.publicKey=a.publicKeyFromAsn1(r.subjectPublicKeyInfo);return l};a.certificateExtensionsFromAsn1=function(e){var t=[];for(var r=0;r<e.value.length;++r){var i=e.value[r];for(var n=0;n<i.value.length;++n){t.push(a.certificateExtensionFromAsn1(i.value[n]))}}return t};a.certificateExtensionFromAsn1=function(e){var t={};t.id=n.derToOid(e.value[0].value);t.critical=false;if(e.value[1].type===n.Type.BOOLEAN){t.critical=e.value[1].value.charCodeAt(0)!==0;t.value=e.value[2].value}else{t.value=e.value[1].value}if(t.id in s){t.name=s[t.id];if(t.name==="keyUsage"){var r=n.fromDer(t.value);var a=0;var o=0;if(r.value.length>1){a=r.value.charCodeAt(1);o=r.value.length>2?r.value.charCodeAt(2):0}t.digitalSignature=(a&128)===128;t.nonRepudiation=(a&64)===64;t.keyEncipherment=(a&32)===32;t.dataEncipherment=(a&16)===16;t.keyAgreement=(a&8)===8;t.keyCertSign=(a&4)===4;t.cRLSign=(a&2)===2;t.encipherOnly=(a&1)===1;t.decipherOnly=(o&128)===128}else if(t.name==="basicConstraints"){var r=n.fromDer(t.value);if(r.value.length>0&&r.value[0].type===n.Type.BOOLEAN){t.cA=r.value[0].value.charCodeAt(0)!==0}else{t.cA=false}var u=null;if(r.value.length>0&&r.value[0].type===n.Type.INTEGER){u=r.value[0].value}else if(r.value.length>1){u=r.value[1].value}if(u!==null){t.pathLenConstraint=n.derToInteger(u)}}else if(t.name==="extKeyUsage"){var r=n.fromDer(t.value);for(var f=0;f<r.value.length;++f){var c=n.derToOid(r.value[f].value);if(c in s){t[s[c]]=true}else{t[c]=true}}}else if(t.name==="nsCertType"){var r=n.fromDer(t.value);var a=0;if(r.value.length>1){a=r.value.charCodeAt(1)}t.client=(a&128)===128;t.server=(a&64)===64;t.email=(a&32)===32;t.objsign=(a&16)===16;t.reserved=(a&8)===8;t.sslCA=(a&4)===4;t.emailCA=(a&2)===2;t.objCA=(a&1)===1}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.altNames=[];var l;var r=n.fromDer(t.value);for(var h=0;h<r.value.length;++h){l=r.value[h];var p={type:l.type,value:l.value};t.altNames.push(p);switch(l.type){case 1:case 2:case 6:break;case 7:p.ip=i.util.bytesToIP(l.value);break;case 8:p.oid=n.derToOid(l.value);break;default:}}}else if(t.name==="subjectKeyIdentifier"){var r=n.fromDer(t.value);t.subjectKeyIdentifier=i.util.bytesToHex(r.value)}}return t};a.certificationRequestFromAsn1=function(e,t){var r={};var o=[];if(!n.validate(e,h,r,o)){var u=new Error("Cannot read PKCS#10 certificate request. "+"ASN.1 object is not a PKCS#10 CertificationRequest.");u.errors=o;throw u}var f=n.derToOid(r.publicKeyOid);if(f!==a.oids.rsaEncryption){throw new Error("Cannot read public key. OID is not RSA.")}var c=a.createCertificationRequest();c.version=r.csrVersion?r.csrVersion.charCodeAt(0):0;c.signatureOid=i.asn1.derToOid(r.csrSignatureOid);c.signatureParameters=p(c.signatureOid,r.csrSignatureParams,true);c.siginfo.algorithmOid=i.asn1.derToOid(r.csrSignatureOid);c.siginfo.parameters=p(c.siginfo.algorithmOid,r.csrSignatureParams,false);c.signature=r.csrSignature;c.certificationRequestInfo=r.certificationRequestInfo;if(t){c.md=null;if(c.signatureOid in s){var f=s[c.signatureOid];switch(f){case"sha1WithRSAEncryption":c.md=i.md.sha1.create();break;case"md5WithRSAEncryption":c.md=i.md.md5.create();break;case"sha256WithRSAEncryption":c.md=i.md.sha256.create();break;case"sha384WithRSAEncryption":c.md=i.md.sha384.create();break;case"sha512WithRSAEncryption":c.md=i.md.sha512.create();break;case"RSASSA-PSS":c.md=i.md.sha256.create();break}}if(c.md===null){var u=new Error("Could not compute certification request digest. "+"Unknown signature OID.");u.signatureOid=c.signatureOid;throw u}var l=n.toDer(c.certificationRequestInfo);c.md.update(l.getBytes())}var d=i.md.sha1.create();c.subject.getField=function(e){return _getAttribute(c.subject,e)};c.subject.addField=function(e){_fillMissingFields([e]);c.subject.attributes.push(e)};c.subject.attributes=a.RDNAttributesAsArray(r.certificationRequestInfoSubject,d);c.subject.hash=d.digest().toHex();c.publicKey=a.publicKeyFromAsn1(r.subjectPublicKeyInfo);c.getAttribute=function(e){return _getAttribute(c,e)};c.addAttribute=function(e){_fillMissingFields([e]);c.attributes.push(e)};c.attributes=a.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]);return c};a.createCertificationRequest=function(){var e={};e.version=0;e.signatureOid=null;e.signature=null;e.siginfo={};e.siginfo.algorithmOid=null;e.subject={};e.subject.getField=function(t){return _getAttribute(e.subject,t)};e.subject.addField=function(t){_fillMissingFields([t]);e.subject.attributes.push(t)};e.subject.attributes=[];e.subject.hash=null;e.publicKey=null;e.attributes=[];e.getAttribute=function(t){return _getAttribute(e,t)};e.addAttribute=function(t){_fillMissingFields([t]);e.attributes.push(t)};e.md=null;e.setSubject=function(t){_fillMissingFields(t);e.subject.attributes=t;e.subject.hash=null};e.setAttributes=function(t){_fillMissingFields(t);e.attributes=t};e.sign=function(t,r){e.md=r||i.md.sha1.create();var o=s[e.md.algorithm+"WithRSAEncryption"];if(!o){var u=new Error("Could not compute certification request digest. "+"Unknown message digest algorithm OID.");u.algorithm=e.md.algorithm;throw u}e.signatureOid=e.siginfo.algorithmOid=o;e.certificationRequestInfo=a.getCertificationRequestInfo(e);var f=n.toDer(e.certificationRequestInfo);e.md.update(f.getBytes());e.signature=t.sign(e.md)};e.verify=function(){var t=false;var r=e.md;if(r===null){if(e.signatureOid in s){var o=s[e.signatureOid];switch(o){case"sha1WithRSAEncryption":r=i.md.sha1.create();break;case"md5WithRSAEncryption":r=i.md.md5.create();break;case"sha256WithRSAEncryption":r=i.md.sha256.create();break;case"sha384WithRSAEncryption":r=i.md.sha384.create();break;case"sha512WithRSAEncryption":r=i.md.sha512.create();break;case"RSASSA-PSS":r=i.md.sha256.create();break}}if(r===null){var u=new Error("Could not compute certification request digest. "+"Unknown signature OID.");u.signatureOid=e.signatureOid;throw u}var f=e.certificationRequestInfo||a.getCertificationRequestInfo(e);var c=n.toDer(f);r.update(c.getBytes())}if(r!==null){var l;switch(e.signatureOid){case s.sha1WithRSAEncryption:break;case s["RSASSA-PSS"]:var h,p;h=s[e.signatureParameters.mgf.hash.algorithmOid];if(h===undefined||i.md[h]===undefined){var u=new Error("Unsupported MGF hash function.");u.oid=e.signatureParameters.mgf.hash.algorithmOid;u.name=h;throw u}p=s[e.signatureParameters.mgf.algorithmOid];if(p===undefined||i.mgf[p]===undefined){var u=new Error("Unsupported MGF function.");u.oid=e.signatureParameters.mgf.algorithmOid;u.name=p;throw u}p=i.mgf[p].create(i.md[h].create());h=s[e.signatureParameters.hash.algorithmOid];if(h===undefined||i.md[h]===undefined){var u=new Error("Unsupported RSASSA-PSS hash function.");u.oid=e.signatureParameters.hash.algorithmOid;u.name=h;throw u}l=i.pss.create(i.md[h].create(),p,e.signatureParameters.saltLength);break}t=e.publicKey.verify(r.digest().getBytes(),e.signature,l)}return t};return e};function _dnToAsn1(e){var t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[]);var r,a;var s=e.attributes;for(var o=0;o<s.length;++o){r=s[o];var u=r.value;var f=n.Type.PRINTABLESTRING;if("valueTagClass"in r){f=r.valueTagClass;if(f===n.Type.UTF8){u=i.util.encodeUtf8(u)}}a=n.create(n.Class.UNIVERSAL,n.Type.SET,true,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(r.type).getBytes()),n.create(n.Class.UNIVERSAL,f,false,u)])]);t.value.push(a)}return t}function _getAttributesAsJson(e){var t={};for(var r=0;r<e.length;++r){var a=e[r];if(a.shortName&&(a.valueTagClass===n.Type.UTF8||a.valueTagClass===n.Type.PRINTABLESTRING||a.valueTagClass===n.Type.IA5STRING)){var s=a.value;if(a.valueTagClass===n.Type.UTF8){s=i.util.encodeUtf8(a.value)}if(!(a.shortName in t)){t[a.shortName]=s}else if(i.util.isArray(t[a.shortName])){t[a.shortName].push(s)}else{t[a.shortName]=[t[a.shortName],s]}}}return t}function _fillMissingFields(e){var t;for(var r=0;r<e.length;++r){t=e[r];if(typeof t.name==="undefined"){if(t.type&&t.type in a.oids){t.name=a.oids[t.type]}else if(t.shortName&&t.shortName in o){t.name=a.oids[o[t.shortName]]}}if(typeof t.type==="undefined"){if(t.name&&t.name in a.oids){t.type=a.oids[t.name]}else{var i=new Error("Attribute type not specified.");i.attribute=t;throw i}}if(typeof t.shortName==="undefined"){if(t.name&&t.name in o){t.shortName=o[t.name]}}if(t.type===s.extensionRequest){t.valueConstructed=true;t.valueTagClass=n.Type.SEQUENCE;if(!t.value&&t.extensions){t.value=[];for(var u=0;u<t.extensions.length;++u){t.value.push(a.certificateExtensionToAsn1(_fillMissingExtensionFields(t.extensions[u])))}}}if(typeof t.value==="undefined"){var i=new Error("Attribute value not specified.");i.attribute=t;throw i}}}function _fillMissingExtensionFields(e,t){t=t||{};if(typeof e.name==="undefined"){if(e.id&&e.id in a.oids){e.name=a.oids[e.id]}}if(typeof e.id==="undefined"){if(e.name&&e.name in a.oids){e.id=a.oids[e.name]}else{var r=new Error("Extension ID not specified.");r.extension=e;throw r}}if(typeof e.value!=="undefined"){return e}if(e.name==="keyUsage"){var o=0;var u=0;var f=0;if(e.digitalSignature){u|=128;o=7}if(e.nonRepudiation){u|=64;o=6}if(e.keyEncipherment){u|=32;o=5}if(e.dataEncipherment){u|=16;o=4}if(e.keyAgreement){u|=8;o=3}if(e.keyCertSign){u|=4;o=2}if(e.cRLSign){u|=2;o=1}if(e.encipherOnly){u|=1;o=0}if(e.decipherOnly){f|=128;o=7}var c=String.fromCharCode(o);if(f!==0){c+=String.fromCharCode(u)+String.fromCharCode(f)}else if(u!==0){c+=String.fromCharCode(u)}e.value=n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,false,c)}else if(e.name==="basicConstraints"){e.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[]);if(e.cA){e.value.value.push(n.create(n.Class.UNIVERSAL,n.Type.BOOLEAN,false,String.fromCharCode(255)))}if("pathLenConstraint"in e){e.value.value.push(n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,n.integerToDer(e.pathLenConstraint).getBytes()))}}else if(e.name==="extKeyUsage"){e.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[]);var l=e.value.value;for(var h in e){if(e[h]!==true){continue}if(h in s){l.push(n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(s[h]).getBytes()))}else if(h.indexOf(".")!==-1){l.push(n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(h).getBytes()))}}}else if(e.name==="nsCertType"){var o=0;var u=0;if(e.client){u|=128;o=7}if(e.server){u|=64;o=6}if(e.email){u|=32;o=5}if(e.objsign){u|=16;o=4}if(e.reserved){u|=8;o=3}if(e.sslCA){u|=4;o=2}if(e.emailCA){u|=2;o=1}if(e.objCA){u|=1;o=0}var c=String.fromCharCode(o);if(u!==0){c+=String.fromCharCode(u)}e.value=n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,false,c)}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[]);var p;for(var d=0;d<e.altNames.length;++d){p=e.altNames[d];var c=p.value;if(p.type===7&&p.ip){c=i.util.bytesFromIP(p.ip);if(c===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');r.extension=e;throw r}}else if(p.type===8){if(p.oid){c=n.oidToDer(n.oidToDer(p.oid))}else{c=n.oidToDer(c)}}e.value.value.push(n.create(n.Class.CONTEXT_SPECIFIC,p.type,false,c))}}else if(e.name==="nsComment"&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128){throw new Error('Invalid "nsComment" content.')}e.value=n.create(n.Class.UNIVERSAL,n.Type.IA5STRING,false,e.comment)}else if(e.name==="subjectKeyIdentifier"&&t.cert){var y=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=y.toHex();e.value=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,y.getBytes())}else if(e.name==="authorityKeyIdentifier"&&t.cert){e.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[]);var l=e.value.value;if(e.keyIdentifier){var g=e.keyIdentifier===true?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;l.push(n.create(n.Class.CONTEXT_SPECIFIC,0,false,g))}if(e.authorityCertIssuer){var v=[n.create(n.Class.CONTEXT_SPECIFIC,4,true,[_dnToAsn1(e.authorityCertIssuer===true?t.cert.issuer:e.authorityCertIssuer)])];l.push(n.create(n.Class.CONTEXT_SPECIFIC,1,true,v))}if(e.serialNumber){var m=i.util.hexToBytes(e.serialNumber===true?t.cert.serialNumber:e.serialNumber);l.push(n.create(n.Class.CONTEXT_SPECIFIC,2,false,m))}}else if(e.name==="cRLDistributionPoints"){e.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[]);var l=e.value.value;var C=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[]);var E=n.create(n.Class.CONTEXT_SPECIFIC,0,true,[]);var p;for(var d=0;d<e.altNames.length;++d){p=e.altNames[d];var c=p.value;if(p.type===7&&p.ip){c=i.util.bytesFromIP(p.ip);if(c===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');r.extension=e;throw r}}else if(p.type===8){if(p.oid){c=n.oidToDer(n.oidToDer(p.oid))}else{c=n.oidToDer(c)}}E.value.push(n.create(n.Class.CONTEXT_SPECIFIC,p.type,false,c))}C.value.push(n.create(n.Class.CONTEXT_SPECIFIC,0,true,[E]));l.push(C)}if(typeof e.value==="undefined"){var r=new Error("Extension value not specified.");r.extension=e;throw r}return e}function _signatureParametersToAsn1(e,t){switch(e){case s["RSASSA-PSS"]:var r=[];if(t.hash.algorithmOid!==undefined){r.push(n.create(n.Class.CONTEXT_SPECIFIC,0,true,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(t.hash.algorithmOid).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,false,"")])]))}if(t.mgf.algorithmOid!==undefined){r.push(n.create(n.Class.CONTEXT_SPECIFIC,1,true,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(t.mgf.algorithmOid).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(t.mgf.hash.algorithmOid).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,false,"")])])]))}if(t.saltLength!==undefined){r.push(n.create(n.Class.CONTEXT_SPECIFIC,2,true,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,n.integerToDer(t.saltLength).getBytes())]))}return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,r);default:return n.create(n.Class.UNIVERSAL,n.Type.NULL,false,"")}}function _CRIAttributesToAsn1(e){var t=n.create(n.Class.CONTEXT_SPECIFIC,0,true,[]);if(e.attributes.length===0){return t}var r=e.attributes;for(var a=0;a<r.length;++a){var s=r[a];var o=s.value;var u=n.Type.UTF8;if("valueTagClass"in s){u=s.valueTagClass}if(u===n.Type.UTF8){o=i.util.encodeUtf8(o)}var f=false;if("valueConstructed"in s){f=s.valueConstructed}var c=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(s.type).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,true,[n.create(n.Class.UNIVERSAL,u,f,o)])]);t.value.push(c)}return t}var d=new Date("1950-01-01T00:00:00Z");var y=new Date("2050-01-01T00:00:00Z");function _dateToAsn1(e){if(e>=d&&e<y){return n.create(n.Class.UNIVERSAL,n.Type.UTCTIME,false,n.dateToUtcTime(e))}else{return n.create(n.Class.UNIVERSAL,n.Type.GENERALIZEDTIME,false,n.dateToGeneralizedTime(e))}}a.getTBSCertificate=function(e){var t=_dateToAsn1(e.validity.notBefore);var r=_dateToAsn1(e.validity.notAfter);var s=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.CONTEXT_SPECIFIC,0,true,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,n.integerToDer(e.version).getBytes())]),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,i.util.hexToBytes(e.serialNumber)),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(e.siginfo.algorithmOid).getBytes()),_signatureParametersToAsn1(e.siginfo.algorithmOid,e.siginfo.parameters)]),_dnToAsn1(e.issuer),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[t,r]),_dnToAsn1(e.subject),a.publicKeyToAsn1(e.publicKey)]);if(e.issuer.uniqueId){s.value.push(n.create(n.Class.CONTEXT_SPECIFIC,1,true,[n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,false,String.fromCharCode(0)+e.issuer.uniqueId)]))}if(e.subject.uniqueId){s.value.push(n.create(n.Class.CONTEXT_SPECIFIC,2,true,[n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,false,String.fromCharCode(0)+e.subject.uniqueId)]))}if(e.extensions.length>0){s.value.push(a.certificateExtensionsToAsn1(e.extensions))}return s};a.getCertificationRequestInfo=function(e){var t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,n.integerToDer(e.version).getBytes()),_dnToAsn1(e.subject),a.publicKeyToAsn1(e.publicKey),_CRIAttributesToAsn1(e)]);return t};a.distinguishedNameToAsn1=function(e){return _dnToAsn1(e)};a.certificateToAsn1=function(e){var t=e.tbsCertificate||a.getTBSCertificate(e);return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[t,n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(e.signatureOid).getBytes()),_signatureParametersToAsn1(e.signatureOid,e.signatureParameters)]),n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,false,String.fromCharCode(0)+e.signature)])};a.certificateExtensionsToAsn1=function(e){var t=n.create(n.Class.CONTEXT_SPECIFIC,3,true,[]);var r=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[]);t.value.push(r);for(var i=0;i<e.length;++i){r.value.push(a.certificateExtensionToAsn1(e[i]))}return t};a.certificateExtensionToAsn1=function(e){var t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[]);t.value.push(n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(e.id).getBytes()));if(e.critical){t.value.push(n.create(n.Class.UNIVERSAL,n.Type.BOOLEAN,false,String.fromCharCode(255)))}var r=e.value;if(typeof e.value!=="string"){r=n.toDer(r).getBytes()}t.value.push(n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,r));return t};a.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||a.getCertificationRequestInfo(e);return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[t,n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(e.signatureOid).getBytes()),_signatureParametersToAsn1(e.signatureOid,e.signatureParameters)]),n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,false,String.fromCharCode(0)+e.signature)])};a.createCaStore=function(e){var t={certs:{}};t.getIssuer=function(e){var t=getBySubject(e.issuer);return t};t.addCertificate=function(e){if(typeof e==="string"){e=i.pki.certificateFromPem(e)}ensureSubjectHasHash(e.subject);if(!t.hasCertificate(e)){if(e.subject.hash in t.certs){var r=t.certs[e.subject.hash];if(!i.util.isArray(r)){r=[r]}r.push(e);t.certs[e.subject.hash]=r}else{t.certs[e.subject.hash]=e}}};t.hasCertificate=function(e){if(typeof e==="string"){e=i.pki.certificateFromPem(e)}var t=getBySubject(e.subject);if(!t){return false}if(!i.util.isArray(t)){t=[t]}var r=n.toDer(a.certificateToAsn1(e)).getBytes();for(var s=0;s<t.length;++s){var o=n.toDer(a.certificateToAsn1(t[s])).getBytes();if(r===o){return true}}return false};t.listAllCertificates=function(){var e=[];for(var r in t.certs){if(t.certs.hasOwnProperty(r)){var n=t.certs[r];if(!i.util.isArray(n)){e.push(n)}else{for(var a=0;a<n.length;++a){e.push(n[a])}}}}return e};t.removeCertificate=function(e){var r;if(typeof e==="string"){e=i.pki.certificateFromPem(e)}ensureSubjectHasHash(e.subject);if(!t.hasCertificate(e)){return null}var s=getBySubject(e.subject);if(!i.util.isArray(s)){r=t.certs[e.subject.hash];delete t.certs[e.subject.hash];return r}var o=n.toDer(a.certificateToAsn1(e)).getBytes();for(var u=0;u<s.length;++u){var f=n.toDer(a.certificateToAsn1(s[u])).getBytes();if(o===f){r=s[u];s.splice(u,1)}}if(s.length===0){delete t.certs[e.subject.hash]}return r};function getBySubject(e){ensureSubjectHasHash(e);return t.certs[e.hash]||null}function ensureSubjectHasHash(e){if(!e.hash){var t=i.md.sha1.create();e.attributes=a.RDNAttributesAsArray(_dnToAsn1(e),t);e.hash=t.digest().toHex()}}if(e){for(var r=0;r<e.length;++r){var s=e[r];t.addCertificate(s)}}return t};a.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};a.verifyCertificateChain=function(e,t,r){if(typeof r==="function"){r={verify:r}}r=r||{};t=t.slice(0);var n=t.slice(0);var s=r.validityCheckDate;if(typeof s==="undefined"){s=new Date}var o=true;var u=null;var f=0;do{var c=t.shift();var l=null;var h=false;if(s){if(s<c.validity.notBefore||s>c.validity.notAfter){u={message:"Certificate is not valid yet or has expired.",error:a.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:s}}}if(u===null){l=t[0]||e.getIssuer(c);if(l===null){if(c.isIssuer(c)){h=true;l=c}}if(l){var p=l;if(!i.util.isArray(p)){p=[p]}var d=false;while(!d&&p.length>0){l=p.shift();try{d=l.verify(c)}catch(e){}}if(!d){u={message:"Certificate signature is invalid.",error:a.certificateError.bad_certificate}}}if(u===null&&(!l||h)&&!e.hasCertificate(c)){u={message:"Certificate is not trusted.",error:a.certificateError.unknown_ca}}}if(u===null&&l&&!c.isIssuer(l)){u={message:"Certificate issuer is invalid.",error:a.certificateError.bad_certificate}}if(u===null){var y={keyUsage:true,basicConstraints:true};for(var g=0;u===null&&g<c.extensions.length;++g){var v=c.extensions[g];if(v.critical&&!(v.name in y)){u={message:"Certificate has an unsupported critical extension.",error:a.certificateError.unsupported_certificate}}}}if(u===null&&(!o||t.length===0&&(!l||h))){var m=c.getExtension("basicConstraints");var C=c.getExtension("keyUsage");if(C!==null){if(!C.keyCertSign||m===null){u={message:"Certificate keyUsage or basicConstraints conflict "+"or indicate that the certificate is not a CA. "+"If the certificate is the only one in the chain or "+"isn't the first then the certificate must be a "+"valid CA.",error:a.certificateError.bad_certificate}}}if(u===null&&m!==null&&!m.cA){u={message:"Certificate basicConstraints indicates the certificate "+"is not a CA.",error:a.certificateError.bad_certificate}}if(u===null&&C!==null&&"pathLenConstraint"in m){var E=f-1;if(E>m.pathLenConstraint){u={message:"Certificate basicConstraints pathLenConstraint violated.",error:a.certificateError.bad_certificate}}}}var S=u===null?true:u.error;var T=r.verify?r.verify(S,f,n):S;if(T===true){u=null}else{if(S===true){u={message:"The application rejected the certificate.",error:a.certificateError.bad_certificate}}if(T||T===0){if(typeof T==="object"&&!i.util.isArray(T)){if(T.message){u.message=T.message}if(T.error){u.error=T.error}}else if(typeof T==="string"){u.error=T}}throw u}o=false;++f}while(t.length>0);return true}},71:function(e,t,r){var i=r(936);r(960);r(465);r(621);e.exports=i.des=i.des||{};i.des.startEncrypting=function(e,t,r,i){var n=_createCipher({key:e,output:r,decrypt:false,mode:i||(t===null?"ECB":"CBC")});n.start(t);return n};i.des.createEncryptionCipher=function(e,t){return _createCipher({key:e,output:null,decrypt:false,mode:t})};i.des.startDecrypting=function(e,t,r,i){var n=_createCipher({key:e,output:r,decrypt:true,mode:i||(t===null?"ECB":"CBC")});n.start(t);return n};i.des.createDecryptionCipher=function(e,t){return _createCipher({key:e,output:null,decrypt:true,mode:t})};i.des.Algorithm=function(e,t){var r=this;r.name=e;r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return _updateBlock(r._keys,e,t,false)},decrypt:function(e,t){return _updateBlock(r._keys,e,t,true)}}});r._init=false};i.des.Algorithm.prototype.initialize=function(e){if(this._init){return}var t=i.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0){if(t.length()!==24){throw new Error("Invalid Triple-DES key size: "+t.length()*8)}}this._keys=_createKeys(t);this._init=true};registerAlgorithm("DES-ECB",i.cipher.modes.ecb);registerAlgorithm("DES-CBC",i.cipher.modes.cbc);registerAlgorithm("DES-CFB",i.cipher.modes.cfb);registerAlgorithm("DES-OFB",i.cipher.modes.ofb);registerAlgorithm("DES-CTR",i.cipher.modes.ctr);registerAlgorithm("3DES-ECB",i.cipher.modes.ecb);registerAlgorithm("3DES-CBC",i.cipher.modes.cbc);registerAlgorithm("3DES-CFB",i.cipher.modes.cfb);registerAlgorithm("3DES-OFB",i.cipher.modes.ofb);registerAlgorithm("3DES-CTR",i.cipher.modes.ctr);function registerAlgorithm(e,t){var r=function(){return new i.des.Algorithm(e,t)};i.cipher.registerAlgorithm(e,r)}var n=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756];var a=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344];var s=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584];var o=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928];var u=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080];var f=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312];var c=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154];var l=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function _createKeys(e){var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],c=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],l=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261];var y=e.length()>8?3:1;var g=[];var v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];var m=0,C;for(var E=0;E<y;E++){var S=e.getInt32();var T=e.getInt32();C=(S>>>4^T)&252645135;T^=C;S^=C<<4;C=(T>>>-16^S)&65535;S^=C;T^=C<<-16;C=(S>>>2^T)&858993459;T^=C;S^=C<<2;C=(T>>>-16^S)&65535;S^=C;T^=C<<-16;C=(S>>>1^T)&1431655765;T^=C;S^=C<<1;C=(T>>>8^S)&16711935;S^=C;T^=C<<8;C=(S>>>1^T)&1431655765;T^=C;S^=C<<1;C=S<<8|T>>>20&240;S=T<<24|T<<8&16711680|T>>>8&65280|T>>>24&240;T=C;for(var I=0;I<v.length;++I){if(v[I]){S=S<<2|S>>>26;T=T<<2|T>>>26}else{S=S<<1|S>>>27;T=T<<1|T>>>27}S&=-15;T&=-15;var B=t[S>>>28]|r[S>>>24&15]|i[S>>>20&15]|n[S>>>16&15]|a[S>>>12&15]|s[S>>>8&15]|o[S>>>4&15];var A=u[T>>>28]|f[T>>>24&15]|c[T>>>20&15]|l[T>>>16&15]|h[T>>>12&15]|p[T>>>8&15]|d[T>>>4&15];C=(A>>>16^B)&65535;g[m++]=B^C;g[m++]=A^C<<16}}return g}function _updateBlock(e,t,r,i){var h=e.length===32?3:9;var p;if(h===3){p=i?[30,-2,-2]:[0,32,2]}else{p=i?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2]}var d;var y=t[0];var g=t[1];d=(y>>>4^g)&252645135;g^=d;y^=d<<4;d=(y>>>16^g)&65535;g^=d;y^=d<<16;d=(g>>>2^y)&858993459;y^=d;g^=d<<2;d=(g>>>8^y)&16711935;y^=d;g^=d<<8;d=(y>>>1^g)&1431655765;g^=d;y^=d<<1;y=y<<1|y>>>31;g=g<<1|g>>>31;for(var v=0;v<h;v+=3){var m=p[v+1];var C=p[v+2];for(var E=p[v];E!=m;E+=C){var S=g^e[E];var T=(g>>>4|g<<28)^e[E+1];d=y;y=g;g=d^(a[S>>>24&63]|o[S>>>16&63]|f[S>>>8&63]|l[S&63]|n[T>>>24&63]|s[T>>>16&63]|u[T>>>8&63]|c[T&63])}d=y;y=g;g=d}y=y>>>1|y<<31;g=g>>>1|g<<31;d=(y>>>1^g)&1431655765;g^=d;y^=d<<1;d=(g>>>8^y)&16711935;y^=d;g^=d<<8;d=(g>>>2^y)&858993459;y^=d;g^=d<<2;d=(y>>>16^g)&65535;g^=d;y^=d<<16;d=(y>>>4^g)&252645135;g^=d;y^=d<<4;r[0]=y;r[1]=g}function _createCipher(e){e=e||{};var t=(e.mode||"CBC").toUpperCase();var r="DES-"+t;var n;if(e.decrypt){n=i.cipher.createDecipher(r,e.key)}else{n=i.cipher.createCipher(r,e.key)}var a=n.start;n.start=function(e,t){var r=null;if(t instanceof i.util.ByteBuffer){r=t;t={}}t=t||{};t.output=r;t.iv=e;a.call(n,t)};return n}},76:function(e,t,r){var i=r(936);r(620);r(511);r(71);r(607);r(400);r(282);r(5);r(104);r(859);r(789);r(621);if(typeof n==="undefined"){var n=i.jsbn.BigInteger}var a=i.asn1;var s=i.pki=i.pki||{};e.exports=s.pbe=i.pbe=i.pbe||{};var o=s.oids;var u={name:"EncryptedPrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:true,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:false,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:true,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:false,capture:"encryptedData"}]};var f={name:"PBES2Algorithms",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:false,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.params.salt",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:false,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:false,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:false,optional:true,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:true,optional:true,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:false,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:false,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:false,capture:"encIv"}]}]};var c={name:"pkcs-12PbeParams",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:true,value:[{name:"pkcs-12PbeParams.salt",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:false,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:false,capture:"iterations"}]};s.encryptPrivateKeyInfo=function(e,t,r){r=r||{};r.saltSize=r.saltSize||8;r.count=r.count||2048;r.algorithm=r.algorithm||"aes128";r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=i.random.getBytesSync(r.saltSize);var u=r.count;var f=a.integerToDer(u);var c;var l;var h;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var p,d,y;switch(r.algorithm){case"aes128":c=16;p=16;d=o["aes128-CBC"];y=i.aes.createEncryptionCipher;break;case"aes192":c=24;p=16;d=o["aes192-CBC"];y=i.aes.createEncryptionCipher;break;case"aes256":c=32;p=16;d=o["aes256-CBC"];y=i.aes.createEncryptionCipher;break;case"des":c=8;p=8;d=o["desCBC"];y=i.des.createEncryptionCipher;break;default:var g=new Error("Cannot encrypt private key. Unknown encryption algorithm.");g.algorithm=r.algorithm;throw g}var v="hmacWith"+r.prfAlgorithm.toUpperCase();var m=prfAlgorithmToMessageDigest(v);var C=i.pkcs5.pbkdf2(t,n,u,c,m);var E=i.random.getBytesSync(p);var S=y(C);S.start(E);S.update(a.toDer(e));S.finish();h=S.output.getBytes();var T=createPbkdf2Params(n,f,c,v);l=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,true,[a.create(a.Class.UNIVERSAL,a.Type.OID,false,a.oidToDer(o["pkcs5PBES2"]).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,true,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,true,[a.create(a.Class.UNIVERSAL,a.Type.OID,false,a.oidToDer(o["pkcs5PBKDF2"]).getBytes()),T]),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,true,[a.create(a.Class.UNIVERSAL,a.Type.OID,false,a.oidToDer(d).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,false,E)])])])}else if(r.algorithm==="3des"){c=24;var I=new i.util.ByteBuffer(n);var C=s.pbe.generatePkcs12Key(t,I,1,u,c);var E=s.pbe.generatePkcs12Key(t,I,2,u,c);var S=i.des.createEncryptionCipher(C);S.start(E);S.update(a.toDer(e));S.finish();h=S.output.getBytes();l=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,true,[a.create(a.Class.UNIVERSAL,a.Type.OID,false,a.oidToDer(o["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,true,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,false,n),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,false,f.getBytes())])])}else{var g=new Error("Cannot encrypt private key. Unknown encryption algorithm.");g.algorithm=r.algorithm;throw g}var B=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,true,[l,a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,false,h)]);return B};s.decryptPrivateKeyInfo=function(e,t){var r=null;var n={};var o=[];if(!a.validate(e,u,n,o)){var f=new Error("Cannot read encrypted private key. "+"ASN.1 object is not a supported EncryptedPrivateKeyInfo.");f.errors=o;throw f}var c=a.derToOid(n.encryptionOid);var l=s.pbe.getCipher(c,n.encryptionParams,t);var h=i.util.createBuffer(n.encryptedData);l.update(h);if(l.finish()){r=a.fromDer(l.output)}return r};s.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:a.toDer(e).getBytes()};return i.pem.encode(r,{maxline:t})};s.encryptedPrivateKeyFromPem=function(e){var t=i.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error("Could not convert encrypted private key from PEM; "+'PEM header type is "ENCRYPTED PRIVATE KEY".');r.headerType=t.type;throw r}if(t.procType&&t.procType.type==="ENCRYPTED"){throw new Error("Could not convert encrypted private key from PEM; "+"PEM is encrypted.")}return a.fromDer(t.body)};s.encryptRsaPrivateKey=function(e,t,r){r=r||{};if(!r.legacy){var n=s.wrapRsaPrivateKey(s.privateKeyToAsn1(e));n=s.encryptPrivateKeyInfo(n,t,r);return s.encryptedPrivateKeyToPem(n)}var o;var u;var f;var c;switch(r.algorithm){case"aes128":o="AES-128-CBC";f=16;u=i.random.getBytesSync(16);c=i.aes.createEncryptionCipher;break;case"aes192":o="AES-192-CBC";f=24;u=i.random.getBytesSync(16);c=i.aes.createEncryptionCipher;break;case"aes256":o="AES-256-CBC";f=32;u=i.random.getBytesSync(16);c=i.aes.createEncryptionCipher;break;case"3des":o="DES-EDE3-CBC";f=24;u=i.random.getBytesSync(8);c=i.des.createEncryptionCipher;break;case"des":o="DES-CBC";f=8;u=i.random.getBytesSync(8);c=i.des.createEncryptionCipher;break;default:var l=new Error("Could not encrypt RSA private key; unsupported "+'encryption algorithm "'+r.algorithm+'".');l.algorithm=r.algorithm;throw l}var h=i.pbe.opensslDeriveBytes(t,u.substr(0,8),f);var p=c(h);p.start(u);p.update(a.toDer(s.privateKeyToAsn1(e)));p.finish();var d={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:o,parameters:i.util.bytesToHex(u).toUpperCase()},body:p.output.getBytes()};return i.pem.encode(d)};s.decryptRsaPrivateKey=function(e,t){var r=null;var n=i.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var o=new Error("Could not convert private key from PEM; PEM header type "+'is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');o.headerType=o;throw o}if(n.procType&&n.procType.type==="ENCRYPTED"){var u;var f;switch(n.dekInfo.algorithm){case"DES-CBC":u=8;f=i.des.createDecryptionCipher;break;case"DES-EDE3-CBC":u=24;f=i.des.createDecryptionCipher;break;case"AES-128-CBC":u=16;f=i.aes.createDecryptionCipher;break;case"AES-192-CBC":u=24;f=i.aes.createDecryptionCipher;break;case"AES-256-CBC":u=32;f=i.aes.createDecryptionCipher;break;case"RC2-40-CBC":u=5;f=function(e){return i.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":u=8;f=function(e){return i.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":u=16;f=function(e){return i.rc2.createDecryptionCipher(e,128)};break;default:var o=new Error("Could not decrypt private key; unsupported "+'encryption algorithm "'+n.dekInfo.algorithm+'".');o.algorithm=n.dekInfo.algorithm;throw o}var c=i.util.hexToBytes(n.dekInfo.parameters);var l=i.pbe.opensslDeriveBytes(t,c.substr(0,8),u);var h=f(l);h.start(c);h.update(i.util.createBuffer(n.body));if(h.finish()){r=h.output.getBytes()}else{return r}}else{r=n.body}if(n.type==="ENCRYPTED PRIVATE KEY"){r=s.decryptPrivateKeyInfo(a.fromDer(r),t)}else{r=a.fromDer(r)}if(r!==null){r=s.privateKeyFromAsn1(r)}return r};s.pbe.generatePkcs12Key=function(e,t,r,n,a,s){var o,u;if(typeof s==="undefined"||s===null){if(!("sha1"in i.md)){throw new Error('"sha1" hash algorithm unavailable.')}s=i.md.sha1.create()}var f=s.digestLength;var c=s.blockLength;var l=new i.util.ByteBuffer;var h=new i.util.ByteBuffer;if(e!==null&&e!==undefined){for(u=0;u<e.length;u++){h.putInt16(e.charCodeAt(u))}h.putInt16(0)}var p=h.length();var d=t.length();var y=new i.util.ByteBuffer;y.fillWithByte(r,c);var g=c*Math.ceil(d/c);var v=new i.util.ByteBuffer;for(u=0;u<g;u++){v.putByte(t.at(u%d))}var m=c*Math.ceil(p/c);var C=new i.util.ByteBuffer;for(u=0;u<m;u++){C.putByte(h.at(u%p))}var E=v;E.putBuffer(C);var S=Math.ceil(a/f);for(var T=1;T<=S;T++){var I=new i.util.ByteBuffer;I.putBytes(y.bytes());I.putBytes(E.bytes());for(var B=0;B<n;B++){s.start();s.update(I.getBytes());I=s.digest()}var A=new i.util.ByteBuffer;for(u=0;u<c;u++){A.putByte(I.at(u%f))}var _=Math.ceil(d/c)+Math.ceil(p/c);var b=new i.util.ByteBuffer;for(o=0;o<_;o++){var N=new i.util.ByteBuffer(E.getBytes(c));var w=511;for(u=A.length()-1;u>=0;u--){w=w>>8;w+=A.at(u)+N.at(u);N.setAt(u,w&255)}b.putBuffer(N)}E=b;l.putBuffer(I)}l.truncate(l.length()-a);return l};s.pbe.getCipher=function(e,t,r){switch(e){case s.oids["pkcs5PBES2"]:return s.pbe.getCipherForPBES2(e,t,r);case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case s.oids["pbewithSHAAnd40BitRC2-CBC"]:return s.pbe.getCipherForPKCS12PBE(e,t,r);default:var i=new Error("Cannot read encrypted PBE data block. Unsupported OID.");i.oid=e;i.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"];throw i}};s.pbe.getCipherForPBES2=function(e,t,r){var n={};var o=[];if(!a.validate(t,f,n,o)){var u=new Error("Cannot read password-based-encryption algorithm "+"parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");u.errors=o;throw u}e=a.derToOid(n.kdfOid);if(e!==s.oids["pkcs5PBKDF2"]){var u=new Error("Cannot read encrypted private key. "+"Unsupported key derivation function OID.");u.oid=e;u.supportedOids=["pkcs5PBKDF2"];throw u}e=a.derToOid(n.encOid);if(e!==s.oids["aes128-CBC"]&&e!==s.oids["aes192-CBC"]&&e!==s.oids["aes256-CBC"]&&e!==s.oids["des-EDE3-CBC"]&&e!==s.oids["desCBC"]){var u=new Error("Cannot read encrypted private key. "+"Unsupported encryption scheme OID.");u.oid=e;u.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"];throw u}var c=n.kdfSalt;var l=i.util.createBuffer(n.kdfIterationCount);l=l.getInt(l.length()<<3);var h;var p;switch(s.oids[e]){case"aes128-CBC":h=16;p=i.aes.createDecryptionCipher;break;case"aes192-CBC":h=24;p=i.aes.createDecryptionCipher;break;case"aes256-CBC":h=32;p=i.aes.createDecryptionCipher;break;case"des-EDE3-CBC":h=24;p=i.des.createDecryptionCipher;break;case"desCBC":h=8;p=i.des.createDecryptionCipher;break}var d=prfOidToMessageDigest(n.prfOid);var y=i.pkcs5.pbkdf2(r,c,l,h,d);var g=n.encIv;var v=p(y);v.start(g);return v};s.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={};var o=[];if(!a.validate(t,c,n,o)){var u=new Error("Cannot read password-based-encryption algorithm "+"parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");u.errors=o;throw u}var f=i.util.createBuffer(n.salt);var l=i.util.createBuffer(n.iterations);l=l.getInt(l.length()<<3);var h,p,d;switch(e){case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:h=24;p=8;d=i.des.startDecrypting;break;case s.oids["pbewithSHAAnd40BitRC2-CBC"]:h=5;p=8;d=function(e,t){var r=i.rc2.createDecryptionCipher(e,40);r.start(t,null);return r};break;default:var u=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");u.oid=e;throw u}var y=prfOidToMessageDigest(n.prfOid);var g=s.pbe.generatePkcs12Key(r,f,1,l,h,y);y.start();var v=s.pbe.generatePkcs12Key(r,f,2,l,p,y);return d(g,v)};s.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n==="undefined"||n===null){if(!("md5"in i.md)){throw new Error('"md5" hash algorithm unavailable.')}n=i.md.md5.create()}if(t===null){t=""}var a=[hash(n,e+t)];for(var s=16,o=1;s<r;++o,s+=16){a.push(hash(n,a[o-1]+e+t))}return a.join("").substr(0,r)};function hash(e,t){return e.start().update(t).digest().getBytes()}function prfOidToMessageDigest(e){var t;if(!e){t="hmacWithSHA1"}else{t=s.oids[a.derToOid(e)];if(!t){var r=new Error("Unsupported PRF OID.");r.oid=e;r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"];throw r}}return prfAlgorithmToMessageDigest(t)}function prfAlgorithmToMessageDigest(e){var t=i.md;switch(e){case"hmacWithSHA224":t=i.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");r.algorithm=e;r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"];throw r}if(!t||!(e in t)){throw new Error("Unknown hash algorithm: "+e)}return t[e].create()}function createPbkdf2Params(e,t,r,n){var o=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,true,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,false,e),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,false,t.getBytes())]);if(n!=="hmacWithSHA1"){o.value.push(a.create(a.Class.UNIVERSAL,a.Type.INTEGER,false,i.util.hexToBytes(r.toString(16))),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,true,[a.create(a.Class.UNIVERSAL,a.Type.OID,false,a.oidToDer(s.oids[n]).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,false,"")]))}return o}},84:function(e,t,r){var i=r(936);r(104);r(621);var n=e.exports=i.pss=i.pss||{};n.create=function(e){if(arguments.length===3){e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]}}var t=e.md;var r=e.mgf;var n=t.digestLength;var a=e.salt||null;if(typeof a==="string"){a=i.util.createBuffer(a)}var s;if("saltLength"in e){s=e.saltLength}else if(a!==null){s=a.length()}else{throw new Error("Salt length not specified or specific salt not given.")}if(a!==null&&a.length()!==s){throw new Error("Given salt length does not match length of given salt.")}var o=e.prng||i.random;var u={};u.encode=function(e,u){var f;var c=u-1;var l=Math.ceil(c/8);var h=e.digest().getBytes();if(l<n+s+2){throw new Error("Message is too long to encrypt.")}var p;if(a===null){p=o.getBytesSync(s)}else{p=a.bytes()}var d=new i.util.ByteBuffer;d.fillWithByte(0,8);d.putBytes(h);d.putBytes(p);t.start();t.update(d.getBytes());var y=t.digest().getBytes();var g=new i.util.ByteBuffer;g.fillWithByte(0,l-s-n-2);g.putByte(1);g.putBytes(p);var v=g.getBytes();var m=l-n-1;var C=r.generate(y,m);var E="";for(f=0;f<m;f++){E+=String.fromCharCode(v.charCodeAt(f)^C.charCodeAt(f))}var S=65280>>8*l-c&255;E=String.fromCharCode(E.charCodeAt(0)&~S)+E.substr(1);return E+y+String.fromCharCode(188)};u.verify=function(e,a,o){var u;var f=o-1;var c=Math.ceil(f/8);a=a.substr(-c);if(c<n+s+2){throw new Error("Inconsistent parameters to PSS signature verification.")}if(a.charCodeAt(c-1)!==188){throw new Error("Encoded message does not end in 0xBC.")}var l=c-n-1;var h=a.substr(0,l);var p=a.substr(l,n);var d=65280>>8*c-f&255;if((h.charCodeAt(0)&d)!==0){throw new Error("Bits beyond keysize not zero as expected.")}var y=r.generate(p,l);var g="";for(u=0;u<l;u++){g+=String.fromCharCode(h.charCodeAt(u)^y.charCodeAt(u))}g=String.fromCharCode(g.charCodeAt(0)&~d)+g.substr(1);var v=c-n-s-2;for(u=0;u<v;u++){if(g.charCodeAt(u)!==0){throw new Error("Leftmost octets not zero as expected")}}if(g.charCodeAt(v)!==1){throw new Error("Inconsistent PSS signature, 0x01 marker not found")}var m=g.substr(-s);var C=new i.util.ByteBuffer;C.fillWithByte(0,8);C.putBytes(e);C.putBytes(m);t.start();t.update(C.getBytes());var E=t.digest().getBytes();return p===E};return u}},88:function(e,t,r){var i=r(936);r(621);r(104);r(334);var n=e.exports=i.pkcs1=i.pkcs1||{};n.encode_rsa_oaep=function(e,t,r){var n;var a;var s;var o;if(typeof r==="string"){n=r;a=arguments[3]||undefined;s=arguments[4]||undefined}else if(r){n=r.label||undefined;a=r.seed||undefined;s=r.md||undefined;if(r.mgf1&&r.mgf1.md){o=r.mgf1.md}}if(!s){s=i.md.sha1.create()}else{s.start()}if(!o){o=s}var u=Math.ceil(e.n.bitLength()/8);var f=u-2*s.digestLength-2;if(t.length>f){var c=new Error("RSAES-OAEP input message length is too long.");c.length=t.length;c.maxLength=f;throw c}if(!n){n=""}s.update(n,"raw");var l=s.digest();var h="";var p=f-t.length;for(var d=0;d<p;d++){h+="\0"}var y=l.getBytes()+h+""+t;if(!a){a=i.random.getBytes(s.digestLength)}else if(a.length!==s.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must "+"match the digest length.");c.seedLength=a.length;c.digestLength=s.digestLength;throw c}var g=rsa_mgf1(a,u-s.digestLength-1,o);var v=i.util.xorBytes(y,g,y.length);var m=rsa_mgf1(v,s.digestLength,o);var C=i.util.xorBytes(a,m,a.length);return"\0"+C+v};n.decode_rsa_oaep=function(e,t,r){var n;var a;var s;if(typeof r==="string"){n=r;a=arguments[3]||undefined}else if(r){n=r.label||undefined;a=r.md||undefined;if(r.mgf1&&r.mgf1.md){s=r.mgf1.md}}var o=Math.ceil(e.n.bitLength()/8);if(t.length!==o){var u=new Error("RSAES-OAEP encoded message length is invalid.");u.length=t.length;u.expectedLength=o;throw u}if(a===undefined){a=i.md.sha1.create()}else{a.start()}if(!s){s=a}if(o<2*a.digestLength+2){throw new Error("RSAES-OAEP key is too short for the hash function.")}if(!n){n=""}a.update(n,"raw");var f=a.digest().getBytes();var c=t.charAt(0);var l=t.substring(1,a.digestLength+1);var h=t.substring(1+a.digestLength);var p=rsa_mgf1(h,a.digestLength,s);var d=i.util.xorBytes(l,p,l.length);var y=rsa_mgf1(d,o-a.digestLength-1,s);var g=i.util.xorBytes(h,y,h.length);var v=g.substring(0,a.digestLength);var u=c!=="\0";for(var m=0;m<a.digestLength;++m){u|=f.charAt(m)!==v.charAt(m)}var C=1;var E=a.digestLength;for(var S=a.digestLength;S<g.length;S++){var T=g.charCodeAt(S);var I=T&1^1;var B=C?65534:0;u|=T&B;C=C&I;E+=C}if(u||g.charCodeAt(E)!==1){throw new Error("Invalid RSAES-OAEP padding.")}return g.substring(E+1)};function rsa_mgf1(e,t,r){if(!r){r=i.md.sha1.create()}var n="";var a=Math.ceil(t/r.digestLength);for(var s=0;s<a;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start();r.update(e+o);n+=r.digest().getBytes()}return n.substring(0,t)}},103:function(e,t,r){var i=r(936);r(607);r(621);var n=e.exports=i.md5=i.md5||{};i.md.md5=i.md.algorithms.md5=n;n.create=function(){if(!f){_init()}var e=null;var t=i.util.createBuffer();var r=new Array(16);var n={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};n.start=function(){n.messageLength=0;n.fullMessageLength=n.messageLength64=[];var r=n.messageLengthSize/4;for(var a=0;a<r;++a){n.fullMessageLength.push(0)}t=i.util.createBuffer();e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878};return n};n.start();n.update=function(a,s){if(s==="utf8"){a=i.util.encodeUtf8(a)}var o=a.length;n.messageLength+=o;o=[o/4294967296>>>0,o>>>0];for(var u=n.fullMessageLength.length-1;u>=0;--u){n.fullMessageLength[u]+=o[1];o[1]=o[0]+(n.fullMessageLength[u]/4294967296>>>0);n.fullMessageLength[u]=n.fullMessageLength[u]>>>0;o[0]=o[1]/4294967296>>>0}t.putBytes(a);_update(e,r,t);if(t.read>2048||t.length()===0){t.compact()}return n};n.digest=function(){var s=i.util.createBuffer();s.putBytes(t.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize;var u=o&n.blockLength-1;s.putBytes(a.substr(0,n.blockLength-u));var f,c=0;for(var l=n.fullMessageLength.length-1;l>=0;--l){f=n.fullMessageLength[l]*8+c;c=f/4294967296>>>0;s.putInt32Le(f>>>0)}var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};_update(h,r,s);var p=i.util.createBuffer();p.putInt32Le(h.h0);p.putInt32Le(h.h1);p.putInt32Le(h.h2);p.putInt32Le(h.h3);return p};return n};var a=null;var s=null;var o=null;var u=null;var f=false;function _init(){a=String.fromCharCode(128);a+=i.util.fillString(String.fromCharCode(0),64);s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9];o=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21];u=new Array(64);for(var e=0;e<64;++e){u[e]=Math.floor(Math.abs(Math.sin(e+1))*4294967296)}f=true}function _update(e,t,r){var i,n,a,f,c,l,h,p;var d=r.length();while(d>=64){n=e.h0;a=e.h1;f=e.h2;c=e.h3;for(p=0;p<16;++p){t[p]=r.getInt32Le();l=c^a&(f^c);i=n+l+u[p]+t[p];h=o[p];n=c;c=f;f=a;a+=i<<h|i>>>32-h}for(;p<32;++p){l=f^c&(a^f);i=n+l+u[p]+t[s[p]];h=o[p];n=c;c=f;f=a;a+=i<<h|i>>>32-h}for(;p<48;++p){l=a^f^c;i=n+l+u[p]+t[s[p]];h=o[p];n=c;c=f;f=a;a+=i<<h|i>>>32-h}for(;p<64;++p){l=f^(a|~c);i=n+l+u[p]+t[s[p]];h=o[p];n=c;c=f;f=a;a+=i<<h|i>>>32-h}e.h0=e.h0+n|0;e.h1=e.h1+a|0;e.h2=e.h2+f|0;e.h3=e.h3+c|0;d-=64}}},104:function(e,t,r){var i=r(936);r(620);r(588);r(538);r(621);(function(){if(i.random&&i.random.getBytes){e.exports=i.random;return}(function(t){var r={};var n=new Array(4);var a=i.util.createBuffer();r.formatKey=function(e){var t=i.util.createBuffer(e);e=new Array(4);e[0]=t.getInt32();e[1]=t.getInt32();e[2]=t.getInt32();e[3]=t.getInt32();return i.aes._expandKey(e,false)};r.formatSeed=function(e){var t=i.util.createBuffer(e);e=new Array(4);e[0]=t.getInt32();e[1]=t.getInt32();e[2]=t.getInt32();e[3]=t.getInt32();return e};r.cipher=function(e,t){i.aes._updateBlock(e,t,n,false);a.putInt32(n[0]);a.putInt32(n[1]);a.putInt32(n[2]);a.putInt32(n[3]);return a.getBytes()};r.increment=function(e){++e[3];return e};r.md=i.md.sha256;function spawnPrng(){var e=i.prng.create(r);e.getBytes=function(t,r){return e.generate(t,r)};e.getBytesSync=function(t){return e.generate(t)};return e}var s=spawnPrng();var o=null;var u=i.util.globalScope;var f=u.crypto||u.msCrypto;if(f&&f.getRandomValues){o=function(e){return f.getRandomValues(e)}}if(i.options.usePureJavaScript||!i.util.isNodejs&&!o){if(typeof window==="undefined"||window.document===undefined){}s.collectInt(+new Date,32);if(typeof navigator!=="undefined"){var c="";for(var l in navigator){try{if(typeof navigator[l]=="string"){c+=navigator[l]}}catch(e){}}s.collect(c);c=null}if(t){t().mousemove(function(e){s.collectInt(e.clientX,16);s.collectInt(e.clientY,16)});t().keypress(function(e){s.collectInt(e.charCode,8)})}}if(!i.random){i.random=s}else{for(var l in s){i.random[l]=s[l]}}i.random.createInstance=spawnPrng;e.exports=i.random})(typeof jQuery!=="undefined"?jQuery:null)})()},111:function(e,t,r){var i=r(936);r(511);var n=i.asn1;t.privateKeyValidator={name:"PrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"PrivateKeyInfo.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:false,capture:"privateKey"}]};t.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"publicKeyOid"}]},{tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:false,composed:true,captureBitStringValue:"ed25519PublicKey"}]}},120:function(e,t,r){var i=r(936);r(607);r(621);var n=e.exports=i.hmac=i.hmac||{};n.create=function(){var e=null;var t=null;var r=null;var n=null;var a={};a.start=function(a,s){if(a!==null){if(typeof a==="string"){a=a.toLowerCase();if(a in i.md.algorithms){t=i.md.algorithms[a].create()}else{throw new Error('Unknown hash algorithm "'+a+'"')}}else{t=a}}if(s===null){s=e}else{if(typeof s==="string"){s=i.util.createBuffer(s)}else if(i.util.isArray(s)){var o=s;s=i.util.createBuffer();for(var u=0;u<o.length;++u){s.putByte(o[u])}}var f=s.length();if(f>t.blockLength){t.start();t.update(s.bytes());s=t.digest()}r=i.util.createBuffer();n=i.util.createBuffer();f=s.length();for(var u=0;u<f;++u){var o=s.at(u);r.putByte(54^o);n.putByte(92^o)}if(f<t.blockLength){var o=t.blockLength-f;for(var u=0;u<o;++u){r.putByte(54);n.putByte(92)}}e=s;r=r.bytes();n=n.bytes()}t.start();t.update(r)};a.update=function(e){t.update(e)};a.getMac=function(){var e=t.digest().bytes();t.start();t.update(n);t.update(e);return t.digest()};a.digest=a.getMac;return a}},161:function(e,t,r){var i=r(936);r(620);r(120);r(103);r(334);r(621);var n=e.exports=i.ssh=i.ssh||{};n.privateKeyToPutty=function(e,t,r){r=r||"";t=t||"";var n="ssh-rsa";var a=t===""?"none":"aes256-cbc";var s="PuTTY-User-Key-File-2: "+n+"\r\n";s+="Encryption: "+a+"\r\n";s+="Comment: "+r+"\r\n";var o=i.util.createBuffer();_addStringToBuffer(o,n);_addBigIntegerToBuffer(o,e.e);_addBigIntegerToBuffer(o,e.n);var u=i.util.encode64(o.bytes(),64);var f=Math.floor(u.length/66)+1;s+="Public-Lines: "+f+"\r\n";s+=u;var c=i.util.createBuffer();_addBigIntegerToBuffer(c,e.d);_addBigIntegerToBuffer(c,e.p);_addBigIntegerToBuffer(c,e.q);_addBigIntegerToBuffer(c,e.qInv);var l;if(!t){l=i.util.encode64(c.bytes(),64)}else{var h=c.length()+16-1;h-=h%16;var p=_sha1(c.bytes());p.truncate(p.length()-h+c.length());c.putBuffer(p);var d=i.util.createBuffer();d.putBuffer(_sha1("\0\0\0\0",t));d.putBuffer(_sha1("\0\0\0",t));var y=i.aes.createEncryptionCipher(d.truncate(8),"CBC");y.start(i.util.createBuffer().fillWithByte(0,16));y.update(c.copy());y.finish();var g=y.output;g.truncate(16);l=i.util.encode64(g.bytes(),64)}f=Math.floor(l.length/66)+1;s+="\r\nPrivate-Lines: "+f+"\r\n";s+=l;var v=_sha1("putty-private-key-file-mac-key",t);var m=i.util.createBuffer();_addStringToBuffer(m,n);_addStringToBuffer(m,a);_addStringToBuffer(m,r);m.putInt32(o.length());m.putBuffer(o);m.putInt32(c.length());m.putBuffer(c);var C=i.hmac.create();C.start("sha1",v);C.update(m.bytes());s+="\r\nPrivate-MAC: "+C.digest().toHex()+"\r\n";return s};n.publicKeyToOpenSSH=function(e,t){var r="ssh-rsa";t=t||"";var n=i.util.createBuffer();_addStringToBuffer(n,r);_addBigIntegerToBuffer(n,e.e);_addBigIntegerToBuffer(n,e.n);return r+" "+i.util.encode64(n.bytes())+" "+t};n.privateKeyToOpenSSH=function(e,t){if(!t){return i.pki.privateKeyToPem(e)}return i.pki.encryptRsaPrivateKey(e,t,{legacy:true,algorithm:"aes128"})};n.getPublicKeyFingerprint=function(e,t){t=t||{};var r=t.md||i.md.md5.create();var n="ssh-rsa";var a=i.util.createBuffer();_addStringToBuffer(a,n);_addBigIntegerToBuffer(a,e.e);_addBigIntegerToBuffer(a,e.n);r.start();r.update(a.getBytes());var s=r.digest();if(t.encoding==="hex"){var o=s.toHex();if(t.delimiter){return o.match(/.{2}/g).join(t.delimiter)}return o}else if(t.encoding==="binary"){return s.getBytes()}else if(t.encoding){throw new Error('Unknown encoding "'+t.encoding+'".')}return s};function _addBigIntegerToBuffer(e,t){var r=t.toString(16);if(r[0]>="8"){r="00"+r}var n=i.util.hexToBytes(r);e.putInt32(n.length);e.putBytes(n)}function _addStringToBuffer(e,t){e.putInt32(t.length);e.putString(t)}function _sha1(){var e=i.md.sha1.create();var t=arguments.length;for(var r=0;r<t;++r){e.update(arguments[r])}return e.digest()}},183:function(e,t,r){var i=r(936);r(621);r(722);r(104);(function(){if(i.prime){e.exports=i.prime;return}var t=e.exports=i.prime=i.prime||{};var r=i.jsbn.BigInteger;var n=[6,4,2,4,2,4,6,2];var a=new r(null);a.fromInt(30);var s=function(e,t){return e|t};t.generateProbablePrime=function(e,t,r){if(typeof t==="function"){r=t;t={}}t=t||{};var n=t.algorithm||"PRIMEINC";if(typeof n==="string"){n={name:n}}n.options=n.options||{};var a=t.prng||i.random;var s={nextBytes:function(e){var t=a.getBytesSync(e.length);for(var r=0;r<e.length;++r){e[r]=t.charCodeAt(r)}}};if(n.name==="PRIMEINC"){return primeincFindPrime(e,s,n.options,r)}throw new Error("Invalid prime generation algorithm: "+n.name)};function primeincFindPrime(e,t,r,i){if("workers"in r){return primeincFindPrimeWithWorkers(e,t,r,i)}return primeincFindPrimeWithoutWorkers(e,t,r,i)}function primeincFindPrimeWithoutWorkers(e,t,r,i){var n=generateRandom(e,t);var a=0;var s=getMillerRabinTests(n.bitLength());if("millerRabinTests"in r){s=r.millerRabinTests}var o=10;if("maxBlockTime"in r){o=r.maxBlockTime}_primeinc(n,e,t,a,s,o,i)}function _primeinc(e,t,r,a,s,o,u){var f=+new Date;do{if(e.bitLength()>t){e=generateRandom(t,r)}if(e.isProbablePrime(s)){return u(null,e)}e.dAddOffset(n[a++%8],0)}while(o<0||+new Date-f<o);i.util.setImmediate(function(){_primeinc(e,t,r,a,s,o,u)})}function primeincFindPrimeWithWorkers(e,t,n,a){if(typeof Worker==="undefined"){return primeincFindPrimeWithoutWorkers(e,t,n,a)}var s=generateRandom(e,t);var o=n.workers;var u=n.workLoad||100;var f=u*30/8;var c=n.workerScript||"forge/prime.worker.js";if(o===-1){return i.util.estimateCores(function(e,t){if(e){t=2}o=t-1;generate()})}generate();function generate(){o=Math.max(1,o);var i=[];for(var n=0;n<o;++n){i[n]=new Worker(c)}var l=o;for(var n=0;n<o;++n){i[n].addEventListener("message",workerMessage)}var h=false;function workerMessage(n){if(h){return}--l;var o=n.data;if(o.found){for(var c=0;c<i.length;++c){i[c].terminate()}h=true;return a(null,new r(o.prime,16))}if(s.bitLength()>e){s=generateRandom(e,t)}var p=s.toString(16);n.target.postMessage({hex:p,workLoad:u});s.dAddOffset(f,0)}}}function generateRandom(e,t){var i=new r(e,t);var n=e-1;if(!i.testBit(n)){i.bitwiseTo(r.ONE.shiftLeft(n),s,i)}i.dAddOffset(31-i.mod(a).byteValue(),0);return i}function getMillerRabinTests(e){if(e<=100)return 27;if(e<=150)return 18;if(e<=200)return 15;if(e<=250)return 12;if(e<=300)return 9;if(e<=350)return 8;if(e<=400)return 7;if(e<=500)return 6;if(e<=600)return 5;if(e<=800)return 4;if(e<=1250)return 3;return 2}})()},194:function(e,t,r){e.exports=r(607);r(103);r(334);r(588);r(783)},282:function(e,t,r){var i=r(936);r(120);r(607);r(621);var n=i.pkcs5=i.pkcs5||{};var a;if(i.util.isNodejs&&!i.options.usePureJavaScript){a=r(417)}e.exports=i.pbkdf2=n.pbkdf2=function(e,t,r,n,s,o){if(typeof s==="function"){o=s;s=null}if(i.util.isNodejs&&!i.options.usePureJavaScript&&a.pbkdf2&&(s===null||typeof s!=="object")&&(a.pbkdf2Sync.length>4||(!s||s==="sha1"))){if(typeof s!=="string"){s="sha1"}e=Buffer.from(e,"binary");t=Buffer.from(t,"binary");if(!o){if(a.pbkdf2Sync.length===4){return a.pbkdf2Sync(e,t,r,n).toString("binary")}return a.pbkdf2Sync(e,t,r,n,s).toString("binary")}if(a.pbkdf2Sync.length===4){return a.pbkdf2(e,t,r,n,function(e,t){if(e){return o(e)}o(null,t.toString("binary"))})}return a.pbkdf2(e,t,r,n,s,function(e,t){if(e){return o(e)}o(null,t.toString("binary"))})}if(typeof s==="undefined"||s===null){s="sha1"}if(typeof s==="string"){if(!(s in i.md.algorithms)){throw new Error("Unknown hash algorithm: "+s)}s=i.md[s].create()}var u=s.digestLength;if(n>4294967295*u){var f=new Error("Derived key is too long.");if(o){return o(f)}throw f}var c=Math.ceil(n/u);var l=n-(c-1)*u;var h=i.hmac.create();h.start(s,e);var p="";var d,y,g;if(!o){for(var v=1;v<=c;++v){h.start(null,null);h.update(t);h.update(i.util.int32ToBytes(v));d=g=h.digest().getBytes();for(var m=2;m<=r;++m){h.start(null,null);h.update(g);y=h.digest().getBytes();d=i.util.xorBytes(d,y,u);g=y}p+=v<c?d:d.substr(0,l)}return p}var v=1,m;function outer(){if(v>c){return o(null,p)}h.start(null,null);h.update(t);h.update(i.util.int32ToBytes(v));d=g=h.digest().getBytes();m=2;inner()}function inner(){if(m<=r){h.start(null,null);h.update(g);y=h.digest().getBytes();d=i.util.xorBytes(d,y,u);g=y;++m;return i.util.setImmediate(inner)}p+=v<c?d:d.substr(0,l);++v;outer()}outer()}},334:function(e,t,r){var i=r(936);r(607);r(621);var n=e.exports=i.sha1=i.sha1||{};i.md.sha1=i.md.algorithms.sha1=n;n.create=function(){if(!s){_init()}var e=null;var t=i.util.createBuffer();var r=new Array(80);var n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};n.start=function(){n.messageLength=0;n.fullMessageLength=n.messageLength64=[];var r=n.messageLengthSize/4;for(var a=0;a<r;++a){n.fullMessageLength.push(0)}t=i.util.createBuffer();e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520};return n};n.start();n.update=function(a,s){if(s==="utf8"){a=i.util.encodeUtf8(a)}var o=a.length;n.messageLength+=o;o=[o/4294967296>>>0,o>>>0];for(var u=n.fullMessageLength.length-1;u>=0;--u){n.fullMessageLength[u]+=o[1];o[1]=o[0]+(n.fullMessageLength[u]/4294967296>>>0);n.fullMessageLength[u]=n.fullMessageLength[u]>>>0;o[0]=o[1]/4294967296>>>0}t.putBytes(a);_update(e,r,t);if(t.read>2048||t.length()===0){t.compact()}return n};n.digest=function(){var s=i.util.createBuffer();s.putBytes(t.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize;var u=o&n.blockLength-1;s.putBytes(a.substr(0,n.blockLength-u));var f,c;var l=n.fullMessageLength[0]*8;for(var h=0;h<n.fullMessageLength.length-1;++h){f=n.fullMessageLength[h+1]*8;c=f/4294967296>>>0;l+=c;s.putInt32(l>>>0);l=f>>>0}s.putInt32(l);var p={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};_update(p,r,s);var d=i.util.createBuffer();d.putInt32(p.h0);d.putInt32(p.h1);d.putInt32(p.h2);d.putInt32(p.h3);d.putInt32(p.h4);return d};return n};var a=null;var s=false;function _init(){a=String.fromCharCode(128);a+=i.util.fillString(String.fromCharCode(0),64);s=true}function _update(e,t,r){var i,n,a,s,o,u,f,c;var l=r.length();while(l>=64){n=e.h0;a=e.h1;s=e.h2;o=e.h3;u=e.h4;for(c=0;c<16;++c){i=r.getInt32();t[c]=i;f=o^a&(s^o);i=(n<<5|n>>>27)+f+u+1518500249+i;u=o;o=s;s=(a<<30|a>>>2)>>>0;a=n;n=i}for(;c<20;++c){i=t[c-3]^t[c-8]^t[c-14]^t[c-16];i=i<<1|i>>>31;t[c]=i;f=o^a&(s^o);i=(n<<5|n>>>27)+f+u+1518500249+i;u=o;o=s;s=(a<<30|a>>>2)>>>0;a=n;n=i}for(;c<32;++c){i=t[c-3]^t[c-8]^t[c-14]^t[c-16];i=i<<1|i>>>31;t[c]=i;f=a^s^o;i=(n<<5|n>>>27)+f+u+1859775393+i;u=o;o=s;s=(a<<30|a>>>2)>>>0;a=n;n=i}for(;c<40;++c){i=t[c-6]^t[c-16]^t[c-28]^t[c-32];i=i<<2|i>>>30;t[c]=i;f=a^s^o;i=(n<<5|n>>>27)+f+u+1859775393+i;u=o;o=s;s=(a<<30|a>>>2)>>>0;a=n;n=i}for(;c<60;++c){i=t[c-6]^t[c-16]^t[c-28]^t[c-32];i=i<<2|i>>>30;t[c]=i;f=a&s|o&(a^s);i=(n<<5|n>>>27)+f+u+2400959708+i;u=o;o=s;s=(a<<30|a>>>2)>>>0;a=n;n=i}for(;c<80;++c){i=t[c-6]^t[c-16]^t[c-28]^t[c-32];i=i<<2|i>>>30;t[c]=i;f=a^s^o;i=(n<<5|n>>>27)+f+u+3395469782+i;u=o;o=s;s=(a<<30|a>>>2)>>>0;a=n;n=i}e.h0=e.h0+n|0;e.h1=e.h1+a|0;e.h2=e.h2+s|0;e.h3=e.h3+o|0;e.h4=e.h4+u|0;l-=64}}},369:function(e,t,r){var i=r(936);r(511);r(120);r(400);r(923);r(76);r(104);r(789);r(334);r(621);r(25);var n=i.asn1;var a=i.pki;var s=e.exports=i.pkcs12=i.pkcs12||{};var o={name:"ContentInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"ContentInfo.contentType",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"contentType"},{name:"ContentInfo.content",tagClass:n.Class.CONTEXT_SPECIFIC,constructed:true,captureAsn1:"content"}]};var u={name:"PFX",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"PFX.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,capture:"version"},o,{name:"PFX.macData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,optional:true,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:n.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:false,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:false,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,optional:true,capture:"macIterations"}]}]};var f={name:"SafeBag",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"SafeBag.bagId",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:n.Class.CONTEXT_SPECIFIC,constructed:true,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:true,optional:true,capture:"bagAttributes"}]};var c={name:"Attribute",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"Attribute.attrId",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"oid"},{name:"Attribute.attrValues",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:true,capture:"values"}]};var l={name:"CertBag",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"CertBag.certId",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"certId"},{name:"CertBag.certValue",tagClass:n.Class.CONTEXT_SPECIFIC,constructed:true,value:[{name:"CertBag.certValue[0]",tagClass:n.Class.UNIVERSAL,type:n.Class.OCTETSTRING,constructed:false,capture:"cert"}]}]};function _getBagsByAttribute(e,t,r,i){var n=[];for(var a=0;a<e.length;a++){for(var s=0;s<e[a].safeBags.length;s++){var o=e[a].safeBags[s];if(i!==undefined&&o.type!==i){continue}if(t===null){n.push(o);continue}if(o.attributes[t]!==undefined&&o.attributes[t].indexOf(r)>=0){n.push(o)}}}return n}s.pkcs12FromAsn1=function(e,t,r){if(typeof t==="string"){r=t;t=true}else if(t===undefined){t=true}var o={};var f=[];if(!n.validate(e,u,o,f)){var c=new Error("Cannot read PKCS#12 PFX. "+"ASN.1 object is not an PKCS#12 PFX.");c.errors=c;throw c}var l={version:o.version.charCodeAt(0),safeContents:[],getBags:function(e){var t={};var r;if("localKeyId"in e){r=e.localKeyId}else if("localKeyIdHex"in e){r=i.util.hexToBytes(e.localKeyIdHex)}if(r===undefined&&!("friendlyName"in e)&&"bagType"in e){t[e.bagType]=_getBagsByAttribute(l.safeContents,null,null,e.bagType)}if(r!==undefined){t.localKeyId=_getBagsByAttribute(l.safeContents,"localKeyId",r,e.bagType)}if("friendlyName"in e){t.friendlyName=_getBagsByAttribute(l.safeContents,"friendlyName",e.friendlyName,e.bagType)}return t},getBagsByFriendlyName:function(e,t){return _getBagsByAttribute(l.safeContents,"friendlyName",e,t)},getBagsByLocalKeyId:function(e,t){return _getBagsByAttribute(l.safeContents,"localKeyId",e,t)}};if(o.version.charCodeAt(0)!==3){var c=new Error("PKCS#12 PFX of version other than 3 not supported.");c.version=o.version.charCodeAt(0);throw c}if(n.derToOid(o.contentType)!==a.oids.data){var c=new Error("Only PKCS#12 PFX in password integrity mode supported.");c.oid=n.derToOid(o.contentType);throw c}var h=o.content.value[0];if(h.tagClass!==n.Class.UNIVERSAL||h.type!==n.Type.OCTETSTRING){throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.")}h=_decodePkcs7Data(h);if(o.mac){var p=null;var d=0;var y=n.derToOid(o.macAlgorithm);switch(y){case a.oids.sha1:p=i.md.sha1.create();d=20;break;case a.oids.sha256:p=i.md.sha256.create();d=32;break;case a.oids.sha384:p=i.md.sha384.create();d=48;break;case a.oids.sha512:p=i.md.sha512.create();d=64;break;case a.oids.md5:p=i.md.md5.create();d=16;break}if(p===null){throw new Error("PKCS#12 uses unsupported MAC algorithm: "+y)}var g=new i.util.ByteBuffer(o.macSalt);var v="macIterations"in o?parseInt(i.util.bytesToHex(o.macIterations),16):1;var m=s.generateKey(r,g,3,v,d,p);var C=i.hmac.create();C.start(p,m);C.update(h.value);var E=C.getMac();if(E.getBytes()!==o.macDigest){throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}}_decodeAuthenticatedSafe(l,h.value,t,r);return l};function _decodePkcs7Data(e){if(e.composed||e.constructed){var t=i.util.createBuffer();for(var r=0;r<e.value.length;++r){t.putBytes(e.value[r].value)}e.composed=e.constructed=false;e.value=t.getBytes()}return e}function _decodeAuthenticatedSafe(e,t,r,i){t=n.fromDer(t,r);if(t.tagClass!==n.Class.UNIVERSAL||t.type!==n.Type.SEQUENCE||t.constructed!==true){throw new Error("PKCS#12 AuthenticatedSafe expected to be a "+"SEQUENCE OF ContentInfo")}for(var s=0;s<t.value.length;s++){var u=t.value[s];var f={};var c=[];if(!n.validate(u,o,f,c)){var l=new Error("Cannot read ContentInfo.");l.errors=c;throw l}var h={encrypted:false};var p=null;var d=f.content.value[0];switch(n.derToOid(f.contentType)){case a.oids.data:if(d.tagClass!==n.Class.UNIVERSAL||d.type!==n.Type.OCTETSTRING){throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.")}p=_decodePkcs7Data(d).value;break;case a.oids.encryptedData:p=_decryptSafeContents(d,i);h.encrypted=true;break;default:var l=new Error("Unsupported PKCS#12 contentType.");l.contentType=n.derToOid(f.contentType);throw l}h.safeBags=_decodeSafeContents(p,r,i);e.safeContents.push(h)}}function _decryptSafeContents(e,t){var r={};var s=[];if(!n.validate(e,i.pkcs7.asn1.encryptedDataValidator,r,s)){var o=new Error("Cannot read EncryptedContentInfo.");o.errors=s;throw o}var u=n.derToOid(r.contentType);if(u!==a.oids.data){var o=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");o.oid=u;throw o}u=n.derToOid(r.encAlgorithm);var f=a.pbe.getCipher(u,r.encParameter,t);var c=_decodePkcs7Data(r.encryptedContentAsn1);var l=i.util.createBuffer(c.value);f.update(l);if(!f.finish()){throw new Error("Failed to decrypt PKCS#12 SafeContents.")}return f.output.getBytes()}function _decodeSafeContents(e,t,r){if(!t&&e.length===0){return[]}e=n.fromDer(e,t);if(e.tagClass!==n.Class.UNIVERSAL||e.type!==n.Type.SEQUENCE||e.constructed!==true){throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.")}var i=[];for(var s=0;s<e.value.length;s++){var o=e.value[s];var u={};var c=[];if(!n.validate(o,f,u,c)){var h=new Error("Cannot read SafeBag.");h.errors=c;throw h}var p={type:n.derToOid(u.bagId),attributes:_decodeBagAttributes(u.bagAttributes)};i.push(p);var d,y;var g=u.bagValue.value[0];switch(p.type){case a.oids.pkcs8ShroudedKeyBag:g=a.decryptPrivateKeyInfo(g,r);if(g===null){throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?")}case a.oids.keyBag:try{p.key=a.privateKeyFromAsn1(g)}catch(e){p.key=null;p.asn1=g}continue;case a.oids.certBag:d=l;y=function(){if(n.derToOid(u.certId)!==a.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");e.oid=n.derToOid(u.certId);throw e}var r=n.fromDer(u.cert,t);try{p.cert=a.certificateFromAsn1(r,true)}catch(e){p.cert=null;p.asn1=r}};break;default:var h=new Error("Unsupported PKCS#12 SafeBag type.");h.oid=p.type;throw h}if(d!==undefined&&!n.validate(g,d,u,c)){var h=new Error("Cannot read PKCS#12 "+d.name);h.errors=c;throw h}y()}return i}function _decodeBagAttributes(e){var t={};if(e!==undefined){for(var r=0;r<e.length;++r){var i={};var s=[];if(!n.validate(e[r],c,i,s)){var o=new Error("Cannot read PKCS#12 BagAttribute.");o.errors=s;throw o}var u=n.derToOid(i.oid);if(a.oids[u]===undefined){continue}t[a.oids[u]]=[];for(var f=0;f<i.values.length;++f){t[a.oids[u]].push(i.values[f].value)}}}return t}s.toPkcs12Asn1=function(e,t,r,o){o=o||{};o.saltSize=o.saltSize||8;o.count=o.count||2048;o.algorithm=o.algorithm||o.encAlgorithm||"aes128";if(!("useMac"in o)){o.useMac=true}if(!("localKeyId"in o)){o.localKeyId=null}if(!("generateLocalKeyId"in o)){o.generateLocalKeyId=true}var u=o.localKeyId;var f;if(u!==null){u=i.util.hexToBytes(u)}else if(o.generateLocalKeyId){if(t){var c=i.util.isArray(t)?t[0]:t;if(typeof c==="string"){c=a.certificateFromPem(c)}var l=i.md.sha1.create();l.update(n.toDer(a.certificateToAsn1(c)).getBytes());u=l.digest().getBytes()}else{u=i.random.getBytes(20)}}var h=[];if(u!==null){h.push(n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(a.oids.localKeyId).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,true,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,u)])]))}if("friendlyName"in o){h.push(n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(a.oids.friendlyName).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,true,[n.create(n.Class.UNIVERSAL,n.Type.BMPSTRING,false,o.friendlyName)])]))}if(h.length>0){f=n.create(n.Class.UNIVERSAL,n.Type.SET,true,h)}var p=[];var d=[];if(t!==null){if(i.util.isArray(t)){d=t}else{d=[t]}}var y=[];for(var g=0;g<d.length;++g){t=d[g];if(typeof t==="string"){t=a.certificateFromPem(t)}var v=g===0?f:undefined;var m=a.certificateToAsn1(t);var C=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(a.oids.certBag).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,true,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(a.oids.x509Certificate).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,true,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,n.toDer(m).getBytes())])])]),v]);y.push(C)}if(y.length>0){var E=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,y);var S=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(a.oids.data).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,true,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,n.toDer(E).getBytes())])]);p.push(S)}var T=null;if(e!==null){var I=a.wrapRsaPrivateKey(a.privateKeyToAsn1(e));if(r===null){T=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(a.oids.keyBag).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,true,[I]),f])}else{T=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(a.oids.pkcs8ShroudedKeyBag).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,true,[a.encryptPrivateKeyInfo(I,r,o)]),f])}var B=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[T]);var A=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(a.oids.data).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,true,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,n.toDer(B).getBytes())])]);p.push(A)}var _=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,p);var b;if(o.useMac){var l=i.md.sha1.create();var N=new i.util.ByteBuffer(i.random.getBytes(o.saltSize));var w=o.count;var e=s.generateKey(r,N,3,w,20);var R=i.hmac.create();R.start(l,e);R.update(n.toDer(_).getBytes());var L=R.getMac();b=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(a.oids.sha1).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,false,"")]),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,L.getBytes())]),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,N.getBytes()),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,n.integerToDer(w).getBytes())])}return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,n.integerToDer(3).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(a.oids.data).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,true,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,n.toDer(_).getBytes())])]),b])};s.generateKey=i.pbe.generatePkcs12Key},400:function(e,t,r){var i=r(936);i.pki=i.pki||{};var n=e.exports=i.pki.oids=i.oids=i.oids||{};function _IN(e,t){n[e]=t;n[t]=e}function _I_(e,t){n[e]=t}_IN("1.2.840.113549.1.1.1","rsaEncryption");_IN("1.2.840.113549.1.1.4","md5WithRSAEncryption");_IN("1.2.840.113549.1.1.5","sha1WithRSAEncryption");_IN("1.2.840.113549.1.1.7","RSAES-OAEP");_IN("1.2.840.113549.1.1.8","mgf1");_IN("1.2.840.113549.1.1.9","pSpecified");_IN("1.2.840.113549.1.1.10","RSASSA-PSS");_IN("1.2.840.113549.1.1.11","sha256WithRSAEncryption");_IN("1.2.840.113549.1.1.12","sha384WithRSAEncryption");_IN("1.2.840.113549.1.1.13","sha512WithRSAEncryption");_IN("1.3.101.112","EdDSA25519");_IN("1.2.840.10040.4.3","dsa-with-sha1");_IN("1.3.14.3.2.7","desCBC");_IN("1.3.14.3.2.26","sha1");_IN("2.16.840.1.101.3.4.2.1","sha256");_IN("2.16.840.1.101.3.4.2.2","sha384");_IN("2.16.840.1.101.3.4.2.3","sha512");_IN("1.2.840.113549.2.5","md5");_IN("1.2.840.113549.1.7.1","data");_IN("1.2.840.113549.1.7.2","signedData");_IN("1.2.840.113549.1.7.3","envelopedData");_IN("1.2.840.113549.1.7.4","signedAndEnvelopedData");_IN("1.2.840.113549.1.7.5","digestedData");_IN("1.2.840.113549.1.7.6","encryptedData");_IN("1.2.840.113549.1.9.1","emailAddress");_IN("1.2.840.113549.1.9.2","unstructuredName");_IN("1.2.840.113549.1.9.3","contentType");_IN("1.2.840.113549.1.9.4","messageDigest");_IN("1.2.840.113549.1.9.5","signingTime");_IN("1.2.840.113549.1.9.6","counterSignature");_IN("1.2.840.113549.1.9.7","challengePassword");_IN("1.2.840.113549.1.9.8","unstructuredAddress");_IN("1.2.840.113549.1.9.14","extensionRequest");_IN("1.2.840.113549.1.9.20","friendlyName");_IN("1.2.840.113549.1.9.21","localKeyId");_IN("1.2.840.113549.1.9.22.1","x509Certificate");_IN("1.2.840.113549.1.12.10.1.1","keyBag");_IN("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");_IN("1.2.840.113549.1.12.10.1.3","certBag");_IN("1.2.840.113549.1.12.10.1.4","crlBag");_IN("1.2.840.113549.1.12.10.1.5","secretBag");_IN("1.2.840.113549.1.12.10.1.6","safeContentsBag");_IN("1.2.840.113549.1.5.13","pkcs5PBES2");_IN("1.2.840.113549.1.5.12","pkcs5PBKDF2");_IN("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");_IN("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");_IN("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");_IN("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");_IN("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");_IN("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");_IN("1.2.840.113549.2.7","hmacWithSHA1");_IN("1.2.840.113549.2.8","hmacWithSHA224");_IN("1.2.840.113549.2.9","hmacWithSHA256");_IN("1.2.840.113549.2.10","hmacWithSHA384");_IN("1.2.840.113549.2.11","hmacWithSHA512");_IN("1.2.840.113549.3.7","des-EDE3-CBC");_IN("2.16.840.1.101.3.4.1.2","aes128-CBC");_IN("2.16.840.1.101.3.4.1.22","aes192-CBC");_IN("2.16.840.1.101.3.4.1.42","aes256-CBC");_IN("2.5.4.3","commonName");_IN("2.5.4.5","serialName");_IN("2.5.4.6","countryName");_IN("2.5.4.7","localityName");_IN("2.5.4.8","stateOrProvinceName");_IN("2.5.4.9","streetAddress");_IN("2.5.4.10","organizationName");_IN("2.5.4.11","organizationalUnitName");_IN("2.5.4.13","description");_IN("2.5.4.15","businessCategory");_IN("2.5.4.17","postalCode");_IN("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");_IN("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");_IN("2.16.840.1.113730.1.1","nsCertType");_IN("2.16.840.1.113730.1.13","nsComment");_I_("2.5.29.1","authorityKeyIdentifier");_I_("2.5.29.2","keyAttributes");_I_("2.5.29.3","certificatePolicies");_I_("2.5.29.4","keyUsageRestriction");_I_("2.5.29.5","policyMapping");_I_("2.5.29.6","subtreesConstraint");_I_("2.5.29.7","subjectAltName");_I_("2.5.29.8","issuerAltName");_I_("2.5.29.9","subjectDirectoryAttributes");_I_("2.5.29.10","basicConstraints");_I_("2.5.29.11","nameConstraints");_I_("2.5.29.12","policyConstraints");_I_("2.5.29.13","basicConstraints");_IN("2.5.29.14","subjectKeyIdentifier");_IN("2.5.29.15","keyUsage");_I_("2.5.29.16","privateKeyUsagePeriod");_IN("2.5.29.17","subjectAltName");_IN("2.5.29.18","issuerAltName");_IN("2.5.29.19","basicConstraints");_I_("2.5.29.20","cRLNumber");_I_("2.5.29.21","cRLReason");_I_("2.5.29.22","expirationDate");_I_("2.5.29.23","instructionCode");_I_("2.5.29.24","invalidityDate");_I_("2.5.29.25","cRLDistributionPoints");_I_("2.5.29.26","issuingDistributionPoint");_I_("2.5.29.27","deltaCRLIndicator");_I_("2.5.29.28","issuingDistributionPoint");_I_("2.5.29.29","certificateIssuer");_I_("2.5.29.30","nameConstraints");_IN("2.5.29.31","cRLDistributionPoints");_IN("2.5.29.32","certificatePolicies");_I_("2.5.29.33","policyMappings");_I_("2.5.29.34","policyConstraints");_IN("2.5.29.35","authorityKeyIdentifier");_I_("2.5.29.36","policyConstraints");_IN("2.5.29.37","extKeyUsage");_I_("2.5.29.46","freshestCRL");_I_("2.5.29.54","inhibitAnyPolicy");_IN("1.3.6.1.4.1.11129.2.4.2","timestampList");_IN("1.3.6.1.5.5.7.1.1","authorityInfoAccess");_IN("1.3.6.1.5.5.7.3.1","serverAuth");_IN("1.3.6.1.5.5.7.3.2","clientAuth");_IN("1.3.6.1.5.5.7.3.3","codeSigning");_IN("1.3.6.1.5.5.7.3.4","emailProtection");_IN("1.3.6.1.5.5.7.3.8","timeStamping")},417:function(e){e.exports=require("crypto")},419:function(e,t,r){var i=r(936);r(6);e.exports=i.mgf=i.mgf||{};i.mgf.mgf1=i.mgf1},457:function(e,t,r){var i=r(936);r(621);e.exports=i.log=i.log||{};i.log.levels=["none","error","warning","info","debug","verbose","max"];var n={};var a=[];var s=null;i.log.LEVEL_LOCKED=1<<1;i.log.NO_LEVEL_CHECK=1<<2;i.log.INTERPOLATE=1<<3;for(var o=0;o<i.log.levels.length;++o){var u=i.log.levels[o];n[u]={index:o,name:u.toUpperCase()}}i.log.logMessage=function(e){var t=n[e.level].index;for(var r=0;r<a.length;++r){var s=a[r];if(s.flags&i.log.NO_LEVEL_CHECK){s.f(e)}else{var o=n[s.level].index;if(t<=o){s.f(s,e)}}}};i.log.prepareStandard=function(e){if(!("standard"in e)){e.standard=n[e.level].name+" ["+e.category+"] "+e.message}};i.log.prepareFull=function(e){if(!("full"in e)){var t=[e.message];t=t.concat([]||false);e.full=i.util.format.apply(this,t)}};i.log.prepareStandardFull=function(e){if(!("standardFull"in e)){i.log.prepareStandard(e);e.standardFull=e.standard}};if(true){var f=["error","warning","info","debug","verbose"];for(var o=0;o<f.length;++o){(function(e){i.log[e]=function(t,r){var n=Array.prototype.slice.call(arguments).slice(2);var a={timestamp:new Date,level:e,category:t,message:r,arguments:n};i.log.logMessage(a)}})(f[o])}}i.log.makeLogger=function(e){var t={flags:0,f:e};i.log.setLevel(t,"none");return t};i.log.setLevel=function(e,t){var r=false;if(e&&!(e.flags&i.log.LEVEL_LOCKED)){for(var n=0;n<i.log.levels.length;++n){var a=i.log.levels[n];if(t==a){e.level=t;r=true;break}}}return r};i.log.lock=function(e,t){if(typeof t==="undefined"||t){e.flags|=i.log.LEVEL_LOCKED}else{e.flags&=~i.log.LEVEL_LOCKED}};i.log.addLogger=function(e){a.push(e)};if(typeof console!=="undefined"&&"log"in console){var c;if(console.error&&console.warn&&console.info&&console.debug){var l={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug};var h=function(e,t){i.log.prepareStandard(t);var r=l[t.level];var n=[t.standard];n=n.concat(t["arguments"].slice());r.apply(console,n)};c=i.log.makeLogger(h)}else{var h=function(e,t){i.log.prepareStandardFull(t);console.log(t.standardFull)};c=i.log.makeLogger(h)}i.log.setLevel(c,"debug");i.log.addLogger(c);s=c}else{console={log:function(){}}}if(s!==null){var p=i.util.getQueryVariables();if("console.level"in p){i.log.setLevel(s,p["console.level"].slice(-1)[0])}if("console.lock"in p){var d=p["console.lock"].slice(-1)[0];if(d=="true"){i.log.lock(s)}}}i.log.consoleLogger=s},465:function(e,t,r){var i=r(936);r(621);i.cipher=i.cipher||{};var n=e.exports=i.cipher.modes=i.cipher.modes||{};n.ecb=function(e){e=e||{};this.name="ECB";this.cipher=e.cipher;this.blockSize=e.blockSize||16;this._ints=this.blockSize/4;this._inBlock=new Array(this._ints);this._outBlock=new Array(this._ints)};n.ecb.prototype.start=function(e){};n.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0)){return true}for(var i=0;i<this._ints;++i){this._inBlock[i]=e.getInt32()}this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i){t.putInt32(this._outBlock[i])}};n.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0)){return true}for(var i=0;i<this._ints;++i){this._inBlock[i]=e.getInt32()}this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i){t.putInt32(this._outBlock[i])}};n.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();e.fillWithByte(r,r);return true};n.ecb.prototype.unpad=function(e,t){if(t.overflow>0){return false}var r=e.length();var i=e.at(r-1);if(i>this.blockSize<<2){return false}e.truncate(i);return true};n.cbc=function(e){e=e||{};this.name="CBC";this.cipher=e.cipher;this.blockSize=e.blockSize||16;this._ints=this.blockSize/4;this._inBlock=new Array(this._ints);this._outBlock=new Array(this._ints)};n.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev){throw new Error("Invalid IV parameter.")}this._iv=this._prev.slice(0)}else if(!("iv"in e)){throw new Error("Invalid IV parameter.")}else{this._iv=transformIV(e.iv,this.blockSize);this._prev=this._iv.slice(0)}};n.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0)){return true}for(var i=0;i<this._ints;++i){this._inBlock[i]=this._prev[i]^e.getInt32()}this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i){t.putInt32(this._outBlock[i])}this._prev=this._outBlock};n.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0)){return true}for(var i=0;i<this._ints;++i){this._inBlock[i]=e.getInt32()}this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i){t.putInt32(this._prev[i]^this._outBlock[i])}this._prev=this._inBlock.slice(0)};n.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();e.fillWithByte(r,r);return true};n.cbc.prototype.unpad=function(e,t){if(t.overflow>0){return false}var r=e.length();var i=e.at(r-1);if(i>this.blockSize<<2){return false}e.truncate(i);return true};n.cfb=function(e){e=e||{};this.name="CFB";this.cipher=e.cipher;this.blockSize=e.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._ints);this._partialBlock=new Array(this._ints);this._partialOutput=i.util.createBuffer();this._partialBytes=0};n.cfb.prototype.start=function(e){if(!("iv"in e)){throw new Error("Invalid IV parameter.")}this._iv=transformIV(e.iv,this.blockSize);this._inBlock=this._iv.slice(0);this._partialBytes=0};n.cfb.prototype.encrypt=function(e,t,r){var i=e.length();if(i===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n){this._inBlock[n]=e.getInt32()^this._outBlock[n];t.putInt32(this._inBlock[n])}return}var a=(this.blockSize-i)%this.blockSize;if(a>0){a=this.blockSize-a}this._partialOutput.clear();for(var n=0;n<this._ints;++n){this._partialBlock[n]=e.getInt32()^this._outBlock[n];this._partialOutput.putInt32(this._partialBlock[n])}if(a>0){e.read-=this.blockSize}else{for(var n=0;n<this._ints;++n){this._inBlock[n]=this._partialBlock[n]}}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(a>0&&!r){t.putBytes(this._partialOutput.getBytes(a-this._partialBytes));this._partialBytes=a;return true}t.putBytes(this._partialOutput.getBytes(i-this._partialBytes));this._partialBytes=0};n.cfb.prototype.decrypt=function(e,t,r){var i=e.length();if(i===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n){this._inBlock[n]=e.getInt32();t.putInt32(this._inBlock[n]^this._outBlock[n])}return}var a=(this.blockSize-i)%this.blockSize;if(a>0){a=this.blockSize-a}this._partialOutput.clear();for(var n=0;n<this._ints;++n){this._partialBlock[n]=e.getInt32();this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n])}if(a>0){e.read-=this.blockSize}else{for(var n=0;n<this._ints;++n){this._inBlock[n]=this._partialBlock[n]}}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(a>0&&!r){t.putBytes(this._partialOutput.getBytes(a-this._partialBytes));this._partialBytes=a;return true}t.putBytes(this._partialOutput.getBytes(i-this._partialBytes));this._partialBytes=0};n.ofb=function(e){e=e||{};this.name="OFB";this.cipher=e.cipher;this.blockSize=e.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._ints);this._partialOutput=i.util.createBuffer();this._partialBytes=0};n.ofb.prototype.start=function(e){if(!("iv"in e)){throw new Error("Invalid IV parameter.")}this._iv=transformIV(e.iv,this.blockSize);this._inBlock=this._iv.slice(0);this._partialBytes=0};n.ofb.prototype.encrypt=function(e,t,r){var i=e.length();if(e.length()===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n){t.putInt32(e.getInt32()^this._outBlock[n]);this._inBlock[n]=this._outBlock[n]}return}var a=(this.blockSize-i)%this.blockSize;if(a>0){a=this.blockSize-a}this._partialOutput.clear();for(var n=0;n<this._ints;++n){this._partialOutput.putInt32(e.getInt32()^this._outBlock[n])}if(a>0){e.read-=this.blockSize}else{for(var n=0;n<this._ints;++n){this._inBlock[n]=this._outBlock[n]}}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(a>0&&!r){t.putBytes(this._partialOutput.getBytes(a-this._partialBytes));this._partialBytes=a;return true}t.putBytes(this._partialOutput.getBytes(i-this._partialBytes));this._partialBytes=0};n.ofb.prototype.decrypt=n.ofb.prototype.encrypt;n.ctr=function(e){e=e||{};this.name="CTR";this.cipher=e.cipher;this.blockSize=e.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._ints);this._partialOutput=i.util.createBuffer();this._partialBytes=0};n.ctr.prototype.start=function(e){if(!("iv"in e)){throw new Error("Invalid IV parameter.")}this._iv=transformIV(e.iv,this.blockSize);this._inBlock=this._iv.slice(0);this._partialBytes=0};n.ctr.prototype.encrypt=function(e,t,r){var i=e.length();if(i===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n){t.putInt32(e.getInt32()^this._outBlock[n])}}else{var a=(this.blockSize-i)%this.blockSize;if(a>0){a=this.blockSize-a}this._partialOutput.clear();for(var n=0;n<this._ints;++n){this._partialOutput.putInt32(e.getInt32()^this._outBlock[n])}if(a>0){e.read-=this.blockSize}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(a>0&&!r){t.putBytes(this._partialOutput.getBytes(a-this._partialBytes));this._partialBytes=a;return true}t.putBytes(this._partialOutput.getBytes(i-this._partialBytes));this._partialBytes=0}inc32(this._inBlock)};n.ctr.prototype.decrypt=n.ctr.prototype.encrypt;n.gcm=function(e){e=e||{};this.name="GCM";this.cipher=e.cipher;this.blockSize=e.blockSize||16;this._ints=this.blockSize/4;this._inBlock=new Array(this._ints);this._outBlock=new Array(this._ints);this._partialOutput=i.util.createBuffer();this._partialBytes=0;this._R=3774873600};n.gcm.prototype.start=function(e){if(!("iv"in e)){throw new Error("Invalid IV parameter.")}var t=i.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e){r=i.util.createBuffer(e.additionalData)}else{r=i.util.createBuffer()}if("tagLength"in e){this._tagLength=e.tagLength}else{this._tagLength=128}this._tag=null;if(e.decrypt){this._tag=i.util.createBuffer(e.tag).getBytes();if(this._tag.length!==this._tagLength/8){throw new Error("Authentication tag does not match tag length.")}}this._hashBlock=new Array(this._ints);this.tag=null;this._hashSubkey=new Array(this._ints);this.cipher.encrypt([0,0,0,0],this._hashSubkey);this.componentBits=4;this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12){this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1]}else{this._j0=[0,0,0,0];while(t.length()>0){this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])}this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(from64To32(n*8)))}this._inBlock=this._j0.slice(0);inc32(this._inBlock);this._partialBytes=0;r=i.util.createBuffer(r);this._aDataLength=from64To32(r.length()*8);var a=r.length()%this.blockSize;if(a){r.fillWithByte(0,this.blockSize-a)}this._s=[0,0,0,0];while(r.length()>0){this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])}};n.gcm.prototype.encrypt=function(e,t,r){var i=e.length();if(i===0){return true}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n){t.putInt32(this._outBlock[n]^=e.getInt32())}this._cipherLength+=this.blockSize}else{var a=(this.blockSize-i)%this.blockSize;if(a>0){a=this.blockSize-a}this._partialOutput.clear();for(var n=0;n<this._ints;++n){this._partialOutput.putInt32(e.getInt32()^this._outBlock[n])}if(a<=0||r){if(r){var s=i%this.blockSize;this._cipherLength+=s;this._partialOutput.truncate(this.blockSize-s)}else{this._cipherLength+=this.blockSize}for(var n=0;n<this._ints;++n){this._outBlock[n]=this._partialOutput.getInt32()}this._partialOutput.read-=this.blockSize}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes)}if(a>0&&!r){e.read-=this.blockSize;t.putBytes(this._partialOutput.getBytes(a-this._partialBytes));this._partialBytes=a;return true}t.putBytes(this._partialOutput.getBytes(i-this._partialBytes));this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock);inc32(this._inBlock)};n.gcm.prototype.decrypt=function(e,t,r){var i=e.length();if(i<this.blockSize&&!(r&&i>0)){return true}this.cipher.encrypt(this._inBlock,this._outBlock);inc32(this._inBlock);this._hashBlock[0]=e.getInt32();this._hashBlock[1]=e.getInt32();this._hashBlock[2]=e.getInt32();this._hashBlock[3]=e.getInt32();this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n){t.putInt32(this._outBlock[n]^this._hashBlock[n])}if(i<this.blockSize){this._cipherLength+=i%this.blockSize}else{this._cipherLength+=this.blockSize}};n.gcm.prototype.afterFinish=function(e,t){var r=true;if(t.decrypt&&t.overflow){e.truncate(this.blockSize-t.overflow)}this.tag=i.util.createBuffer();var n=this._aDataLength.concat(from64To32(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var a=[];this.cipher.encrypt(this._j0,a);for(var s=0;s<this._ints;++s){this.tag.putInt32(this._s[s]^a[s])}this.tag.truncate(this.tag.length()%(this._tagLength/8));if(t.decrypt&&this.tag.bytes()!==this._tag){r=false}return r};n.gcm.prototype.multiply=function(e,t){var r=[0,0,0,0];var i=t.slice(0);for(var n=0;n<128;++n){var a=e[n/32|0]&1<<31-n%32;if(a){r[0]^=i[0];r[1]^=i[1];r[2]^=i[2];r[3]^=i[3]}this.pow(i,i)}return r};n.gcm.prototype.pow=function(e,t){var r=e[3]&1;for(var i=3;i>0;--i){t[i]=e[i]>>>1|(e[i-1]&1)<<31}t[0]=e[0]>>>1;if(r){t[0]^=this._R}};n.gcm.prototype.tableMultiply=function(e){var t=[0,0,0,0];for(var r=0;r<32;++r){var i=r/8|0;var n=e[i]>>>(7-r%8)*4&15;var a=this._m[r][n];t[0]^=a[0];t[1]^=a[1];t[2]^=a[2];t[3]^=a[3]}return t};n.gcm.prototype.ghash=function(e,t,r){t[0]^=r[0];t[1]^=r[1];t[2]^=r[2];t[3]^=r[3];return this.tableMultiply(t)};n.gcm.prototype.generateHashTable=function(e,t){var r=8/t;var i=4*r;var n=16*r;var a=new Array(n);for(var s=0;s<n;++s){var o=[0,0,0,0];var u=s/i|0;var f=(i-1-s%i)*t;o[u]=1<<t-1<<f;a[s]=this.generateSubHashTable(this.multiply(o,e),t)}return a};n.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t;var i=r>>>1;var n=new Array(r);n[i]=e.slice(0);var a=i>>>1;while(a>0){this.pow(n[2*a],n[a]=[]);a>>=1}a=2;while(a<i){for(var s=1;s<a;++s){var o=n[a];var u=n[s];n[a+s]=[o[0]^u[0],o[1]^u[1],o[2]^u[2],o[3]^u[3]]}a*=2}n[0]=[0,0,0,0];for(a=i+1;a<r;++a){var f=n[a^i];n[a]=[e[0]^f[0],e[1]^f[1],e[2]^f[2],e[3]^f[3]]}return n};function transformIV(e,t){if(typeof e==="string"){e=i.util.createBuffer(e)}if(i.util.isArray(e)&&e.length>4){var r=e;e=i.util.createBuffer();for(var n=0;n<r.length;++n){e.putByte(r[n])}}if(e.length()<t){throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.")}if(!i.util.isArray(e)){var a=[];var s=t/4;for(var n=0;n<s;++n){a.push(e.getInt32())}e=a}return e}function inc32(e){e[e.length-1]=e[e.length-1]+1&4294967295}function from64To32(e){return[e/4294967296|0,e&4294967295]}},503:function(e,t,r){var i=r(936);r(620);r(511);r(71);r(400);r(5);r(923);r(104);r(621);r(25);var n=i.asn1;var a=e.exports=i.pkcs7=i.pkcs7||{};a.messageFromPem=function(e){var t=i.pem.decode(e)[0];if(t.type!=="PKCS7"){var r=new Error("Could not convert PKCS#7 message from PEM; PEM "+'header type is not "PKCS#7".');r.headerType=t.type;throw r}if(t.procType&&t.procType.type==="ENCRYPTED"){throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.")}var s=n.fromDer(t.body);return a.messageFromAsn1(s)};a.messageToPem=function(e,t){var r={type:"PKCS7",body:n.toDer(e.toAsn1()).getBytes()};return i.pem.encode(r,{maxline:t})};a.messageFromAsn1=function(e){var t={};var r=[];if(!n.validate(e,a.asn1.contentInfoValidator,t,r)){var s=new Error("Cannot read PKCS#7 message. "+"ASN.1 object is not an PKCS#7 ContentInfo.");s.errors=r;throw s}var o=n.derToOid(t.contentType);var u;switch(o){case i.pki.oids.envelopedData:u=a.createEnvelopedData();break;case i.pki.oids.encryptedData:u=a.createEncryptedData();break;case i.pki.oids.signedData:u=a.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+o+" is not (yet) supported.")}u.fromAsn1(t.content.value[0]);return u};a.createSignedData=function(){var e=null;e={type:i.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){_fromAsn1(e,t,a.asn1.signedDataValidator);e.certificates=[];e.crls=[];e.digestAlgorithmIdentifiers=[];e.contentInfo=null;e.signerInfos=[];if(e.rawCapture.certificates){var r=e.rawCapture.certificates.value;for(var n=0;n<r.length;++n){e.certificates.push(i.pki.certificateFromAsn1(r[n]))}}},toAsn1:function(){if(!e.contentInfo){e.sign()}var t=[];for(var r=0;r<e.certificates.length;++r){t.push(i.pki.certificateToAsn1(e.certificates[r]))}var a=[];var s=n.create(n.Class.CONTEXT_SPECIFIC,0,true,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,n.integerToDer(e.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,true,e.digestAlgorithmIdentifiers),e.contentInfo])]);if(t.length>0){s.value[0].value.push(n.create(n.Class.CONTEXT_SPECIFIC,0,true,t))}if(a.length>0){s.value[0].value.push(n.create(n.Class.CONTEXT_SPECIFIC,1,true,a))}s.value[0].value.push(n.create(n.Class.UNIVERSAL,n.Type.SET,true,e.signerInfos));return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(e.type).getBytes()),s])},addSigner:function(t){var r=t.issuer;var n=t.serialNumber;if(t.certificate){var a=t.certificate;if(typeof a==="string"){a=i.pki.certificateFromPem(a)}r=a.issuer.attributes;n=a.serialNumber}var s=t.key;if(!s){throw new Error("Could not add PKCS#7 signer; no private key specified.")}if(typeof s==="string"){s=i.pki.privateKeyFromPem(s)}var o=t.digestAlgorithm||i.pki.oids.sha1;switch(o){case i.pki.oids.sha1:case i.pki.oids.sha256:case i.pki.oids.sha384:case i.pki.oids.sha512:case i.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+o)}var u=t.authenticatedAttributes||[];if(u.length>0){var f=false;var c=false;for(var l=0;l<u.length;++l){var h=u[l];if(!f&&h.type===i.pki.oids.contentType){f=true;if(c){break}continue}if(!c&&h.type===i.pki.oids.messageDigest){c=true;if(f){break}continue}}if(!f||!c){throw new Error("Invalid signer.authenticatedAttributes. If "+"signer.authenticatedAttributes is specified, then it must "+"contain at least two attributes, PKCS #9 content-type and "+"PKCS #9 message-digest.")}}e.signers.push({key:s,version:1,issuer:r,serialNumber:n,digestAlgorithm:o,signatureAlgorithm:i.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(t){t=t||{};if(typeof e.content!=="object"||e.contentInfo===null){e.contentInfo=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(i.pki.oids.data).getBytes())]);if("content"in e){var r;if(e.content instanceof i.util.ByteBuffer){r=e.content.bytes()}else if(typeof e.content==="string"){r=i.util.encodeUtf8(e.content)}if(t.detached){e.detachedContent=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,r)}else{e.contentInfo.value.push(n.create(n.Class.CONTEXT_SPECIFIC,0,true,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,r)]))}}}if(e.signers.length===0){return}var a=addDigestAlgorithmIds();addSignerInfos(a)},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){if(typeof t==="string"){t=i.pki.certificateFromPem(t)}e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}};return e;function addDigestAlgorithmIds(){var t={};for(var r=0;r<e.signers.length;++r){var a=e.signers[r];var s=a.digestAlgorithm;if(!(s in t)){t[s]=i.md[i.pki.oids[s]].create()}if(a.authenticatedAttributes.length===0){a.md=t[s]}else{a.md=i.md[i.pki.oids[s]].create()}}e.digestAlgorithmIdentifiers=[];for(var s in t){e.digestAlgorithmIdentifiers.push(n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(s).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,false,"")]))}return t}function addSignerInfos(t){var r;if(e.detachedContent){r=e.detachedContent}else{r=e.contentInfo.value[1];r=r.value[0]}if(!r){throw new Error("Could not sign PKCS#7 message; there is no content to sign.")}var a=n.derToOid(e.contentInfo.value[0].value);var s=n.toDer(r);s.getByte();n.getBerValueLength(s);s=s.getBytes();for(var o in t){t[o].start().update(s)}var u=new Date;for(var f=0;f<e.signers.length;++f){var c=e.signers[f];if(c.authenticatedAttributes.length===0){if(a!==i.pki.oids.data){throw new Error("Invalid signer; authenticatedAttributes must be present "+"when the ContentInfo content type is not PKCS#7 Data.")}}else{c.authenticatedAttributesAsn1=n.create(n.Class.CONTEXT_SPECIFIC,0,true,[]);var l=n.create(n.Class.UNIVERSAL,n.Type.SET,true,[]);for(var h=0;h<c.authenticatedAttributes.length;++h){var p=c.authenticatedAttributes[h];if(p.type===i.pki.oids.messageDigest){p.value=t[c.digestAlgorithm].digest()}else if(p.type===i.pki.oids.signingTime){if(!p.value){p.value=u}}l.value.push(_attributeToAsn1(p));c.authenticatedAttributesAsn1.value.push(_attributeToAsn1(p))}s=n.toDer(l).getBytes();c.md.start().update(s)}c.signature=c.key.sign(c.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=_signersToAsn1(e.signers)}};a.createEncryptedData=function(){var e=null;e={type:i.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:i.pki.oids["aes256-CBC"]},fromAsn1:function(t){_fromAsn1(e,t,a.asn1.encryptedDataValidator)},decrypt:function(t){if(t!==undefined){e.encryptedContent.key=t}_decryptContent(e)}};return e};a.createEnvelopedData=function(){var e=null;e={type:i.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:i.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=_fromAsn1(e,t,a.asn1.envelopedDataValidator);e.recipients=_recipientsFromAsn1(r.recipientInfos.value)},toAsn1:function(){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(e.type).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,true,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,n.integerToDer(e.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,true,_recipientsToAsn1(e.recipients)),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,_encryptedContentToAsn1(e.encryptedContent))])])])},findRecipient:function(t){var r=t.issuer.attributes;for(var i=0;i<e.recipients.length;++i){var n=e.recipients[i];var a=n.issuer;if(n.serialNumber!==t.serialNumber){continue}if(a.length!==r.length){continue}var s=true;for(var o=0;o<r.length;++o){if(a[o].type!==r[o].type||a[o].value!==r[o].value){s=false;break}}if(s){return n}}return null},decrypt:function(t,r){if(e.encryptedContent.key===undefined&&t!==undefined&&r!==undefined){switch(t.encryptedContent.algorithm){case i.pki.oids.rsaEncryption:case i.pki.oids.desCBC:var n=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=i.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, "+"OID "+t.encryptedContent.algorithm)}}_decryptContent(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:i.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(e.encryptedContent.content===undefined){r=r||e.encryptedContent.algorithm;t=t||e.encryptedContent.key;var n,a,s;switch(r){case i.pki.oids["aes128-CBC"]:n=16;a=16;s=i.aes.createEncryptionCipher;break;case i.pki.oids["aes192-CBC"]:n=24;a=16;s=i.aes.createEncryptionCipher;break;case i.pki.oids["aes256-CBC"]:n=32;a=16;s=i.aes.createEncryptionCipher;break;case i.pki.oids["des-EDE3-CBC"]:n=24;a=8;s=i.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(t===undefined){t=i.util.createBuffer(i.random.getBytes(n))}else if(t.length()!=n){throw new Error("Symmetric key has wrong length; "+"got "+t.length()+" bytes, expected "+n+".")}e.encryptedContent.algorithm=r;e.encryptedContent.key=t;e.encryptedContent.parameter=i.util.createBuffer(i.random.getBytes(a));var o=s(t);o.start(e.encryptedContent.parameter.copy());o.update(e.content);if(!o.finish()){throw new Error("Symmetric encryption failed.")}e.encryptedContent.content=o.output}for(var u=0;u<e.recipients.length;++u){var f=e.recipients[u];if(f.encryptedContent.content!==undefined){continue}switch(f.encryptedContent.algorithm){case i.pki.oids.rsaEncryption:f.encryptedContent.content=f.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+f.encryptedContent.algorithm)}}}};return e};function _recipientFromAsn1(e){var t={};var r=[];if(!n.validate(e,a.asn1.recipientInfoValidator,t,r)){var s=new Error("Cannot read PKCS#7 RecipientInfo. "+"ASN.1 object is not an PKCS#7 RecipientInfo.");s.errors=r;throw s}return{version:t.version.charCodeAt(0),issuer:i.pki.RDNAttributesAsArray(t.issuer),serialNumber:i.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:n.derToOid(t.encAlgorithm),parameter:t.encParameter.value,content:t.encKey}}}function _recipientToAsn1(e){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,n.integerToDer(e.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[i.pki.distinguishedNameToAsn1({attributes:e.issuer}),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,i.util.hexToBytes(e.serialNumber))]),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(e.encryptedContent.algorithm).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,false,"")]),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,e.encryptedContent.content)])}function _recipientsFromAsn1(e){var t=[];for(var r=0;r<e.length;++r){t.push(_recipientFromAsn1(e[r]))}return t}function _recipientsToAsn1(e){var t=[];for(var r=0;r<e.length;++r){t.push(_recipientToAsn1(e[r]))}return t}function _signerFromAsn1(e){var t={};var r=[];if(!n.validate(e,a.asn1.signerInfoValidator,t,r)){var s=new Error("Cannot read PKCS#7 SignerInfo. "+"ASN.1 object is not an PKCS#7 SignerInfo.");s.errors=r;throw s}var o={version:t.version.charCodeAt(0),issuer:i.pki.RDNAttributesAsArray(t.issuer),serialNumber:i.util.createBuffer(t.serial).toHex(),digestAlgorithm:n.derToOid(t.digestAlgorithm),signatureAlgorithm:n.derToOid(t.signatureAlgorithm),signature:t.signature,authenticatedAttributes:[],unauthenticatedAttributes:[]};var u=t.authenticatedAttributes||[];var f=t.unauthenticatedAttributes||[];return o}function _signerToAsn1(e){var t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,n.integerToDer(e.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[i.pki.distinguishedNameToAsn1({attributes:e.issuer}),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,false,i.util.hexToBytes(e.serialNumber))]),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(e.digestAlgorithm).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,false,"")])]);if(e.authenticatedAttributesAsn1){t.value.push(e.authenticatedAttributesAsn1)}t.value.push(n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(e.signatureAlgorithm).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,false,"")]));t.value.push(n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,e.signature));if(e.unauthenticatedAttributes.length>0){var r=n.create(n.Class.CONTEXT_SPECIFIC,1,true,[]);for(var a=0;a<e.unauthenticatedAttributes.length;++a){var s=e.unauthenticatedAttributes[a];r.values.push(_attributeToAsn1(s))}t.value.push(r)}return t}function _signersFromAsn1(e){var t=[];for(var r=0;r<e.length;++r){t.push(_signerFromAsn1(e[r]))}return t}function _signersToAsn1(e){var t=[];for(var r=0;r<e.length;++r){t.push(_signerToAsn1(e[r]))}return t}function _attributeToAsn1(e){var t;if(e.type===i.pki.oids.contentType){t=n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(e.value).getBytes())}else if(e.type===i.pki.oids.messageDigest){t=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,e.value.bytes())}else if(e.type===i.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z");var a=new Date("2050-01-01T00:00:00Z");var s=e.value;if(typeof s==="string"){var o=Date.parse(s);if(!isNaN(o)){s=new Date(o)}else if(s.length===13){s=n.utcTimeToDate(s)}else{s=n.generalizedTimeToDate(s)}}if(s>=r&&s<a){t=n.create(n.Class.UNIVERSAL,n.Type.UTCTIME,false,n.dateToUtcTime(s))}else{t=n.create(n.Class.UNIVERSAL,n.Type.GENERALIZEDTIME,false,n.dateToGeneralizedTime(s))}}return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(e.type).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,true,[t])])}function _encryptedContentToAsn1(e){return[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(i.pki.oids.data).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,true,[n.create(n.Class.UNIVERSAL,n.Type.OID,false,n.oidToDer(e.algorithm).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,e.parameter.getBytes())]),n.create(n.Class.CONTEXT_SPECIFIC,0,true,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,false,e.content.getBytes())])]}function _fromAsn1(e,t,r){var a={};var s=[];if(!n.validate(t,r,a,s)){var o=new Error("Cannot read PKCS#7 message. "+"ASN.1 object is not a supported PKCS#7 message.");o.errors=o;throw o}var u=n.derToOid(a.contentType);if(u!==i.pki.oids.data){throw new Error("Unsupported PKCS#7 message. "+"Only wrapped ContentType Data supported.")}if(a.encryptedContent){var f="";if(i.util.isArray(a.encryptedContent)){for(var c=0;c<a.encryptedContent.length;++c){if(a.encryptedContent[c].type!==n.Type.OCTETSTRING){throw new Error("Malformed PKCS#7 message, expecting encrypted "+"content constructed of only OCTET STRING objects.")}f+=a.encryptedContent[c].value}}else{f=a.encryptedContent}e.encryptedContent={algorithm:n.derToOid(a.encAlgorithm),parameter:i.util.createBuffer(a.encParameter.value),content:i.util.createBuffer(f)}}if(a.content){var f="";if(i.util.isArray(a.content)){for(var c=0;c<a.content.length;++c){if(a.content[c].type!==n.Type.OCTETSTRING){throw new Error("Malformed PKCS#7 message, expecting "+"content constructed of only OCTET STRING objects.")}f+=a.content[c].value}}else{f=a.content}e.content=i.util.createBuffer(f)}e.version=a.version.charCodeAt(0);e.rawCapture=a;return a}function _decryptContent(e){if(e.encryptedContent.key===undefined){throw new Error("Symmetric key not available.")}if(e.content===undefined){var t;switch(e.encryptedContent.algorithm){case i.pki.oids["aes128-CBC"]:case i.pki.oids["aes192-CBC"]:case i.pki.oids["aes256-CBC"]:t=i.aes.createDecryptionCipher(e.encryptedContent.key);break;case i.pki.oids["desCBC"]:case i.pki.oids["des-EDE3-CBC"]:t=i.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}t.start(e.encryptedContent.parameter);t.update(e.encryptedContent.content);if(!t.finish()){throw new Error("Symmetric decryption failed.")}e.content=t.output}}},511:function(e,t,r){var i=r(936);r(621);r(400);var n=e.exports=i.asn1=i.asn1||{};n.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};n.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};n.create=function(e,t,r,a,s){if(i.util.isArray(a)){var o=[];for(var u=0;u<a.length;++u){if(a[u]!==undefined){o.push(a[u])}}a=o}var f={tagClass:e,type:t,constructed:r,composed:r||i.util.isArray(a),value:a};if(s&&"bitStringContents"in s){f.bitStringContents=s.bitStringContents;f.original=n.copy(f)}return f};n.copy=function(e,t){var r;if(i.util.isArray(e)){r=[];for(var a=0;a<e.length;++a){r.push(n.copy(e[a],t))}return r}if(typeof e==="string"){return e}r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:n.copy(e.value,t)};if(t&&!t.excludeBitStringContents){r.bitStringContents=e.bitStringContents}return r};n.equals=function(e,t,r){if(i.util.isArray(e)){if(!i.util.isArray(t)){return false}if(e.length!==t.length){return false}for(var a=0;a<e.length;++a){if(!n.equals(e[a],t[a])){return false}}return true}if(typeof e!==typeof t){return false}if(typeof e==="string"){return e===t}var s=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&n.equals(e.value,t.value);if(r&&r.includeBitStringContents){s=s&&e.bitStringContents===t.bitStringContents}return s};n.getBerValueLength=function(e){var t=e.getByte();if(t===128){return undefined}var r;var i=t&128;if(!i){r=t}else{r=e.getInt((t&127)<<3)}return r};function _checkBufferLength(e,t,r){if(r>t){var i=new Error("Too few bytes to parse DER.");i.available=e.length();i.remaining=t;i.requested=r;throw i}}var a=function(e,t){var r=e.getByte();t--;if(r===128){return undefined}var i;var n=r&128;if(!n){i=r}else{var a=r&127;_checkBufferLength(e,t,a);i=e.getInt(a<<3)}if(i<0){throw new Error("Negative length: "+i)}return i};n.fromDer=function(e,t){if(t===undefined){t={strict:true,decodeBitStrings:true}}if(typeof t==="boolean"){t={strict:t,decodeBitStrings:true}}if(!("strict"in t)){t.strict=true}if(!("decodeBitStrings"in t)){t.decodeBitStrings=true}if(typeof e==="string"){e=i.util.createBuffer(e)}return _fromDer(e,e.length(),0,t)};function _fromDer(e,t,r,i){var s;_checkBufferLength(e,t,2);var o=e.getByte();t--;var u=o&192;var f=o&31;s=e.length();var c=a(e,t);t-=s-e.length();if(c!==undefined&&c>t){if(i.strict){var l=new Error("Too few bytes to read ASN.1 value.");l.available=e.length();l.remaining=t;l.requested=c;throw l}c=t}var h;var p;var d=(o&32)===32;if(d){h=[];if(c===undefined){for(;;){_checkBufferLength(e,t,2);if(e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2);t-=2;break}s=e.length();h.push(_fromDer(e,t,r+1,i));t-=s-e.length()}}else{while(c>0){s=e.length();h.push(_fromDer(e,c,r+1,i));t-=s-e.length();c-=s-e.length()}}}if(h===undefined&&u===n.Class.UNIVERSAL&&f===n.Type.BITSTRING){p=e.bytes(c)}if(h===undefined&&i.decodeBitStrings&&u===n.Class.UNIVERSAL&&f===n.Type.BITSTRING&&c>1){var y=e.read;var g=t;var v=0;if(f===n.Type.BITSTRING){_checkBufferLength(e,t,1);v=e.getByte();t--}if(v===0){try{s=e.length();var m={verbose:i.verbose,strict:true,decodeBitStrings:true};var C=_fromDer(e,t,r+1,m);var E=s-e.length();t-=E;if(f==n.Type.BITSTRING){E++}var S=C.tagClass;if(E===c&&(S===n.Class.UNIVERSAL||S===n.Class.CONTEXT_SPECIFIC)){h=[C]}}catch(e){}}if(h===undefined){e.read=y;t=g}}if(h===undefined){if(c===undefined){if(i.strict){throw new Error("Non-constructed ASN.1 object of indefinite length.")}c=t}if(f===n.Type.BMPSTRING){h="";for(;c>0;c-=2){_checkBufferLength(e,t,2);h+=String.fromCharCode(e.getInt16());t-=2}}else{h=e.getBytes(c)}}var T=p===undefined?null:{bitStringContents:p};return n.create(u,f,d,h,T)}n.toDer=function(e){var t=i.util.createBuffer();var r=e.tagClass|e.type;var a=i.util.createBuffer();var s=false;if("bitStringContents"in e){s=true;if(e.original){s=n.equals(e,e.original)}}if(s){a.putBytes(e.bitStringContents)}else if(e.composed){if(e.constructed){r|=32}else{a.putByte(0)}for(var o=0;o<e.value.length;++o){if(e.value[o]!==undefined){a.putBuffer(n.toDer(e.value[o]))}}}else{if(e.type===n.Type.BMPSTRING){for(var o=0;o<e.value.length;++o){a.putInt16(e.value.charCodeAt(o))}}else{if(e.type===n.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&(e.value.charCodeAt(1)&128)===0||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)){a.putBytes(e.value.substr(1))}else{a.putBytes(e.value)}}}t.putByte(r);if(a.length()<=127){t.putByte(a.length()&127)}else{var u=a.length();var f="";do{f+=String.fromCharCode(u&255);u=u>>>8}while(u>0);t.putByte(f.length|128);for(var o=f.length-1;o>=0;--o){t.putByte(f.charCodeAt(o))}}t.putBuffer(a);return t};n.oidToDer=function(e){var t=e.split(".");var r=i.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));var n,a,s,o;for(var u=2;u<t.length;++u){n=true;a=[];s=parseInt(t[u],10);do{o=s&127;s=s>>>7;if(!n){o|=128}a.push(o);n=false}while(s>0);for(var f=a.length-1;f>=0;--f){r.putByte(a[f])}}return r};n.derToOid=function(e){var t;if(typeof e==="string"){e=i.util.createBuffer(e)}var r=e.getByte();t=Math.floor(r/40)+"."+r%40;var n=0;while(e.length()>0){r=e.getByte();n=n<<7;if(r&128){n+=r&127}else{t+="."+(n+r);n=0}}return t};n.utcTimeToDate=function(e){var t=new Date;var r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var i=parseInt(e.substr(2,2),10)-1;var n=parseInt(e.substr(4,2),10);var a=parseInt(e.substr(6,2),10);var s=parseInt(e.substr(8,2),10);var o=0;if(e.length>11){var u=e.charAt(10);var f=10;if(u!=="+"&&u!=="-"){o=parseInt(e.substr(10,2),10);f+=2}}t.setUTCFullYear(r,i,n);t.setUTCHours(a,s,o,0);if(f){u=e.charAt(f);if(u==="+"||u==="-"){var c=parseInt(e.substr(f+1,2),10);var l=parseInt(e.substr(f+4,2),10);var h=c*60+l;h*=6e4;if(u==="+"){t.setTime(+t-h)}else{t.setTime(+t+h)}}}return t};n.generalizedTimeToDate=function(e){var t=new Date;var r=parseInt(e.substr(0,4),10);var i=parseInt(e.substr(4,2),10)-1;var n=parseInt(e.substr(6,2),10);var a=parseInt(e.substr(8,2),10);var s=parseInt(e.substr(10,2),10);var o=parseInt(e.substr(12,2),10);var u=0;var f=0;var c=false;if(e.charAt(e.length-1)==="Z"){c=true}var l=e.length-5,h=e.charAt(l);if(h==="+"||h==="-"){var p=parseInt(e.substr(l+1,2),10);var d=parseInt(e.substr(l+4,2),10);f=p*60+d;f*=6e4;if(h==="+"){f*=-1}c=true}if(e.charAt(14)==="."){u=parseFloat(e.substr(14),10)*1e3}if(c){t.setUTCFullYear(r,i,n);t.setUTCHours(a,s,o,u);t.setTime(+t+f)}else{t.setFullYear(r,i,n);t.setHours(a,s,o,u)}return t};n.dateToUtcTime=function(e){if(typeof e==="string"){return e}var t="";var r=[];r.push((""+e.getUTCFullYear()).substr(2));r.push(""+(e.getUTCMonth()+1));r.push(""+e.getUTCDate());r.push(""+e.getUTCHours());r.push(""+e.getUTCMinutes());r.push(""+e.getUTCSeconds());for(var i=0;i<r.length;++i){if(r[i].length<2){t+="0"}t+=r[i]}t+="Z";return t};n.dateToGeneralizedTime=function(e){if(typeof e==="string"){return e}var t="";var r=[];r.push(""+e.getUTCFullYear());r.push(""+(e.getUTCMonth()+1));r.push(""+e.getUTCDate());r.push(""+e.getUTCHours());r.push(""+e.getUTCMinutes());r.push(""+e.getUTCSeconds());for(var i=0;i<r.length;++i){if(r[i].length<2){t+="0"}t+=r[i]}t+="Z";return t};n.integerToDer=function(e){var t=i.util.createBuffer();if(e>=-128&&e<128){return t.putSignedInt(e,8)}if(e>=-32768&&e<32768){return t.putSignedInt(e,16)}if(e>=-8388608&&e<8388608){return t.putSignedInt(e,24)}if(e>=-2147483648&&e<2147483648){return t.putSignedInt(e,32)}var r=new Error("Integer too large; max is 32-bits.");r.integer=e;throw r};n.derToInteger=function(e){if(typeof e==="string"){e=i.util.createBuffer(e)}var t=e.length()*8;if(t>32){throw new Error("Integer too large; max is 32-bits.")}return e.getSignedInt(t)};n.validate=function(e,t,r,a){var s=false;if((e.tagClass===t.tagClass||typeof t.tagClass==="undefined")&&(e.type===t.type||typeof t.type==="undefined")){if(e.constructed===t.constructed||typeof t.constructed==="undefined"){s=true;if(t.value&&i.util.isArray(t.value)){var o=0;for(var u=0;s&&u<t.value.length;++u){s=t.value[u].optional||false;if(e.value[o]){s=n.validate(e.value[o],t.value[u],r,a);if(s){++o}else if(t.value[u].optional){s=true}}if(!s&&a){a.push("["+t.name+"] "+'Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"')}}}if(s&&r){if(t.capture){r[t.capture]=e.value}if(t.captureAsn1){r[t.captureAsn1]=e}if(t.captureBitStringContents&&"bitStringContents"in e){r[t.captureBitStringContents]=e.bitStringContents}if(t.captureBitStringValue&&"bitStringContents"in e){var f;if(e.bitStringContents.length<2){r[t.captureBitStringValue]=""}else{var c=e.bitStringContents.charCodeAt(0);if(c!==0){throw new Error("captureBitStringValue only supported for zero unused bits")}r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}}else if(a){a.push("["+t.name+"] "+'Expected constructed "'+t.constructed+'", got "'+e.constructed+'"')}}else if(a){if(e.tagClass!==t.tagClass){a.push("["+t.name+"] "+'Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"')}if(e.type!==t.type){a.push("["+t.name+"] "+'Expected type "'+t.type+'", got "'+e.type+'"')}}return s};var s=/[^\\u0000-\\u00ff]/;n.prettyPrint=function(e,t,r){var a="";t=t||0;r=r||2;if(t>0){a+="\n"}var o="";for(var u=0;u<t*r;++u){o+=" "}a+=o+"Tag: ";switch(e.tagClass){case n.Class.UNIVERSAL:a+="Universal:";break;case n.Class.APPLICATION:a+="Application:";break;case n.Class.CONTEXT_SPECIFIC:a+="Context-Specific:";break;case n.Class.PRIVATE:a+="Private:";break}if(e.tagClass===n.Class.UNIVERSAL){a+=e.type;switch(e.type){case n.Type.NONE:a+=" (None)";break;case n.Type.BOOLEAN:a+=" (Boolean)";break;case n.Type.INTEGER:a+=" (Integer)";break;case n.Type.BITSTRING:a+=" (Bit string)";break;case n.Type.OCTETSTRING:a+=" (Octet string)";break;case n.Type.NULL:a+=" (Null)";break;case n.Type.OID:a+=" (Object Identifier)";break;case n.Type.ODESC:a+=" (Object Descriptor)";break;case n.Type.EXTERNAL:a+=" (External or Instance of)";break;case n.Type.REAL:a+=" (Real)";break;case n.Type.ENUMERATED:a+=" (Enumerated)";break;case n.Type.EMBEDDED:a+=" (Embedded PDV)";break;case n.Type.UTF8:a+=" (UTF8)";break;case n.Type.ROID:a+=" (Relative Object Identifier)";break;case n.Type.SEQUENCE:a+=" (Sequence)";break;case n.Type.SET:a+=" (Set)";break;case n.Type.PRINTABLESTRING:a+=" (Printable String)";break;case n.Type.IA5String:a+=" (IA5String (ASCII))";break;case n.Type.UTCTIME:a+=" (UTC time)";break;case n.Type.GENERALIZEDTIME:a+=" (Generalized time)";break;case n.Type.BMPSTRING:a+=" (BMP String)";break}}else{a+=e.type}a+="\n";a+=o+"Constructed: "+e.constructed+"\n";if(e.composed){var f=0;var c="";for(var u=0;u<e.value.length;++u){if(e.value[u]!==undefined){f+=1;c+=n.prettyPrint(e.value[u],t+1,r);if(u+1<e.value.length){c+=","}}}a+=o+"Sub values: "+f+c}else{a+=o+"Value: ";if(e.type===n.Type.OID){var l=n.derToOid(e.value);a+=l;if(i.pki&&i.pki.oids){if(l in i.pki.oids){a+=" ("+i.pki.oids[l]+") "}}}if(e.type===n.Type.INTEGER){try{a+=n.derToInteger(e.value)}catch(t){a+="0x"+i.util.bytesToHex(e.value)}}else if(e.type===n.Type.BITSTRING){if(e.value.length>1){a+="0x"+i.util.bytesToHex(e.value.slice(1))}else{a+="(none)"}if(e.value.length>0){var h=e.value.charCodeAt(0);if(h==1){a+=" (1 unused bit shown)"}else if(h>1){a+=" ("+h+" unused bits shown)"}}}else if(e.type===n.Type.OCTETSTRING){if(!s.test(e.value)){a+="("+e.value+") "}a+="0x"+i.util.bytesToHex(e.value)}else if(e.type===n.Type.UTF8){a+=i.util.decodeUtf8(e.value)}else if(e.type===n.Type.PRINTABLESTRING||e.type===n.Type.IA5String){a+=e.value}else if(s.test(e.value)){a+="0x"+i.util.bytesToHex(e.value)}else if(e.value.length===0){a+="[null]"}else{a+=e.value}}return a}},515:function(e,t,r){var i=r(936);r(511);r(400);r(76);r(5);r(282);r(369);r(84);r(789);r(621);r(25);var n=i.asn1;var a=e.exports=i.pki=i.pki||{};a.pemToDer=function(e){var t=i.pem.decode(e)[0];if(t.procType&&t.procType.type==="ENCRYPTED"){throw new Error("Could not convert PEM to DER; PEM is encrypted.")}return i.util.createBuffer(t.body)};a.privateKeyFromPem=function(e){var t=i.pem.decode(e)[0];if(t.type!=="PRIVATE KEY"&&t.type!=="RSA PRIVATE KEY"){var r=new Error("Could not convert private key from PEM; PEM "+'header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');r.headerType=t.type;throw r}if(t.procType&&t.procType.type==="ENCRYPTED"){throw new Error("Could not convert private key from PEM; PEM is encrypted.")}var s=n.fromDer(t.body);return a.privateKeyFromAsn1(s)};a.privateKeyToPem=function(e,t){var r={type:"RSA PRIVATE KEY",body:n.toDer(a.privateKeyToAsn1(e)).getBytes()};return i.pem.encode(r,{maxline:t})};a.privateKeyInfoToPem=function(e,t){var r={type:"PRIVATE KEY",body:n.toDer(e).getBytes()};return i.pem.encode(r,{maxline:t})}},538:function(e,t,r){var i=r(936);r(621);var n=null;if(i.util.isNodejs&&!i.options.usePureJavaScript&&!process.versions["node-webkit"]){n=r(417)}var a=e.exports=i.prng=i.prng||{};a.create=function(e){var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""};var r=e.md;var a=new Array(32);for(var s=0;s<32;++s){a[s]=r.create()}t.pools=a;t.pool=0;t.generate=function(e,r){if(!r){return t.generateSync(e)}var n=t.plugin.cipher;var a=t.plugin.increment;var s=t.plugin.formatKey;var o=t.plugin.formatSeed;var u=i.util.createBuffer();t.key=null;generate();function generate(f){if(f){return r(f)}if(u.length()>=e){return r(null,u.getBytes(e))}if(t.generated>1048575){t.key=null}if(t.key===null){return i.util.nextTick(function(){_reseed(generate)})}var c=n(t.key,t.seed);t.generated+=c.length;u.putBytes(c);t.key=s(n(t.key,a(t.seed)));t.seed=o(n(t.key,t.seed));i.util.setImmediate(generate)}};t.generateSync=function(e){var r=t.plugin.cipher;var n=t.plugin.increment;var a=t.plugin.formatKey;var s=t.plugin.formatSeed;t.key=null;var o=i.util.createBuffer();while(o.length()<e){if(t.generated>1048575){t.key=null}if(t.key===null){_reseedSync()}var u=r(t.key,t.seed);t.generated+=u.length;o.putBytes(u);t.key=a(r(t.key,n(t.seed)));t.seed=s(r(t.key,t.seed))}return o.getBytes(e)};function _reseed(e){if(t.pools[0].messageLength>=32){_seed();return e()}var r=32-t.pools[0].messageLength<<5;t.seedFile(r,function(r,i){if(r){return e(r)}t.collect(i);_seed();e()})}function _reseedSync(){if(t.pools[0].messageLength>=32){return _seed()}var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e));_seed()}function _seed(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);var r=1;for(var i=0;i<32;++i){if(t.reseeds%r===0){e.update(t.pools[i].digest().getBytes());t.pools[i].start()}r=r<<1}t.keyBytes=e.digest().getBytes();e.start();e.update(t.keyBytes);var n=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes);t.seed=t.plugin.formatSeed(n);t.generated=0}function defaultSeedFile(e){var t=null;var r=i.util.globalScope;var n=r.crypto||r.msCrypto;if(n&&n.getRandomValues){t=function(e){return n.getRandomValues(e)}}var a=i.util.createBuffer();if(t){while(a.length()<e){var s=Math.max(1,Math.min(e-a.length(),65536)/4);var o=new Uint32Array(Math.floor(s));try{t(o);for(var u=0;u<o.length;++u){a.putInt32(o[u])}}catch(e){if(!(typeof QuotaExceededError!=="undefined"&&e instanceof QuotaExceededError)){throw e}}}}if(a.length()<e){var f,c,l;var h=Math.floor(Math.random()*65536);while(a.length()<e){c=16807*(h&65535);f=16807*(h>>16);c+=(f&32767)<<16;c+=f>>15;c=(c&2147483647)+(c>>31);h=c&4294967295;for(var u=0;u<3;++u){l=h>>>(u<<3);l^=Math.floor(Math.random()*256);a.putByte(String.fromCharCode(l&255))}}}return a.getBytes(e)}if(n){t.seedFile=function(e,t){n.randomBytes(e,function(e,r){if(e){return t(e)}t(null,r.toString())})};t.seedFileSync=function(e){return n.randomBytes(e).toString()}}else{t.seedFile=function(e,t){try{t(null,defaultSeedFile(e))}catch(e){t(e)}};t.seedFileSync=defaultSeedFile}t.collect=function(e){var r=e.length;for(var i=0;i<r;++i){t.pools[t.pool].update(e.substr(i,1));t.pool=t.pool===31?0:t.pool+1}};t.collectInt=function(e,r){var i="";for(var n=0;n<r;n+=8){i+=String.fromCharCode(e>>n&255)}t.collect(i)};t.registerWorker=function(e){if(e===self){t.seedFile=function(e,t){function listener(e){var r=e.data;if(r.forge&&r.forge.prng){self.removeEventListener("message",listener);t(r.forge.prng.err,r.forge.prng.bytes)}}self.addEventListener("message",listener);self.postMessage({forge:{prng:{needed:e}}})}}else{var r=function(r){var i=r.data;if(i.forge&&i.forge.prng){t.seedFile(i.forge.prng.needed,function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})})}};e.addEventListener("message",r)}};return t}},582:function(e,t,r){e.exports=r(936);r(620);r(650);r(511);r(960);r(907);r(71);r(608);r(120);r(867);r(457);r(194);r(6);r(282);r(5);r(88);r(369);r(503);r(515);r(183);r(538);r(84);r(104);r(859);r(161);r(613);r(661);r(621)},588:function(e,t,r){var i=r(936);r(607);r(621);var n=e.exports=i.sha256=i.sha256||{};i.md.sha256=i.md.algorithms.sha256=n;n.create=function(){if(!s){_init()}var e=null;var t=i.util.createBuffer();var r=new Array(64);var n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};n.start=function(){n.messageLength=0;n.fullMessageLength=n.messageLength64=[];var r=n.messageLengthSize/4;for(var a=0;a<r;++a){n.fullMessageLength.push(0)}t=i.util.createBuffer();e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225};return n};n.start();n.update=function(a,s){if(s==="utf8"){a=i.util.encodeUtf8(a)}var o=a.length;n.messageLength+=o;o=[o/4294967296>>>0,o>>>0];for(var u=n.fullMessageLength.length-1;u>=0;--u){n.fullMessageLength[u]+=o[1];o[1]=o[0]+(n.fullMessageLength[u]/4294967296>>>0);n.fullMessageLength[u]=n.fullMessageLength[u]>>>0;o[0]=o[1]/4294967296>>>0}t.putBytes(a);_update(e,r,t);if(t.read>2048||t.length()===0){t.compact()}return n};n.digest=function(){var s=i.util.createBuffer();s.putBytes(t.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize;var u=o&n.blockLength-1;s.putBytes(a.substr(0,n.blockLength-u));var f,c;var l=n.fullMessageLength[0]*8;for(var h=0;h<n.fullMessageLength.length-1;++h){f=n.fullMessageLength[h+1]*8;c=f/4294967296>>>0;l+=c;s.putInt32(l>>>0);l=f>>>0}s.putInt32(l);var p={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};_update(p,r,s);var d=i.util.createBuffer();d.putInt32(p.h0);d.putInt32(p.h1);d.putInt32(p.h2);d.putInt32(p.h3);d.putInt32(p.h4);d.putInt32(p.h5);d.putInt32(p.h6);d.putInt32(p.h7);return d};return n};var a=null;var s=false;var o=null;function _init(){a=String.fromCharCode(128);a+=i.util.fillString(String.fromCharCode(0),64);o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];s=true}function _update(e,t,r){var i,n,a,s,u,f,c,l,h,p,d,y,g,v,m;var C=r.length();while(C>=64){for(c=0;c<16;++c){t[c]=r.getInt32()}for(;c<64;++c){i=t[c-2];i=(i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10;n=t[c-15];n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3;t[c]=i+t[c-7]+n+t[c-16]|0}l=e.h0;h=e.h1;p=e.h2;d=e.h3;y=e.h4;g=e.h5;v=e.h6;m=e.h7;for(c=0;c<64;++c){s=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7);u=v^y&(g^v);a=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10);f=l&h|p&(l^h);i=m+s+u+o[c]+t[c];n=a+f;m=v;v=g;g=y;y=d+i>>>0;d=p;p=h;h=l;l=i+n>>>0}e.h0=e.h0+l|0;e.h1=e.h1+h|0;e.h2=e.h2+p|0;e.h3=e.h3+d|0;e.h4=e.h4+y|0;e.h5=e.h5+g|0;e.h6=e.h6+v|0;e.h7=e.h7+m|0;C-=64}}},607:function(e,t,r){var i=r(936);e.exports=i.md=i.md||{};i.md.algorithms=i.md.algorithms||{}},608:function(e,t,r){var i=r(936);r(722);r(104);r(783);r(621);var n=r(111);var a=n.publicKeyValidator;var s=n.privateKeyValidator;if(typeof o==="undefined"){var o=i.jsbn.BigInteger}var u=i.util.ByteBuffer;var f=typeof Buffer==="undefined"?Uint8Array:Buffer;i.pki=i.pki||{};e.exports=i.pki.ed25519=i.ed25519=i.ed25519||{};var c=i.ed25519;c.constants={};c.constants.PUBLIC_KEY_BYTE_LENGTH=32;c.constants.PRIVATE_KEY_BYTE_LENGTH=64;c.constants.SEED_BYTE_LENGTH=32;c.constants.SIGN_BYTE_LENGTH=64;c.constants.HASH_BYTE_LENGTH=64;c.generateKeyPair=function(e){e=e||{};var t=e.seed;if(t===undefined){t=i.random.getBytesSync(c.constants.SEED_BYTE_LENGTH)}else if(typeof t==="string"){if(t.length!==c.constants.SEED_BYTE_LENGTH){throw new TypeError('"seed" must be '+c.constants.SEED_BYTE_LENGTH+" bytes in length.")}}else if(!(t instanceof Uint8Array)){throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.')}t=messageToNativeBuffer({message:t,encoding:"binary"});var r=new f(c.constants.PUBLIC_KEY_BYTE_LENGTH);var n=new f(c.constants.PRIVATE_KEY_BYTE_LENGTH);for(var a=0;a<32;++a){n[a]=t[a]}crypto_sign_keypair(r,n);return{publicKey:r,privateKey:n}};c.privateKeyFromAsn1=function(e){var t={};var r=[];var n=i.asn1.validate(e,s,t,r);if(!n){var a=new Error("Invalid Key.");a.errors=r;throw a}var o=i.asn1.derToOid(t.privateKeyOid);var u=i.oids.EdDSA25519;if(o!==u){throw new Error('Invalid OID "'+o+'"; OID must be "'+u+'".')}var f=t.privateKey;var c=messageToNativeBuffer({message:i.asn1.fromDer(f).value,encoding:"binary"});return{privateKeyBytes:c}};c.publicKeyFromAsn1=function(e){var t={};var r=[];var n=i.asn1.validate(e,a,t,r);if(!n){var s=new Error("Invalid Key.");s.errors=r;throw s}var o=i.asn1.derToOid(t.publicKeyOid);var u=i.oids.EdDSA25519;if(o!==u){throw new Error('Invalid OID "'+o+'"; OID must be "'+u+'".')}var f=t.ed25519PublicKey;if(f.length!==c.constants.PUBLIC_KEY_BYTE_LENGTH){throw new Error("Key length is invalid.")}return messageToNativeBuffer({message:f,encoding:"binary"})};c.publicKeyFromPrivateKey=function(e){e=e||{};var t=messageToNativeBuffer({message:e.privateKey,encoding:"binary"});if(t.length!==c.constants.PRIVATE_KEY_BYTE_LENGTH){throw new TypeError('"options.privateKey" must have a byte length of '+c.constants.PRIVATE_KEY_BYTE_LENGTH)}var r=new f(c.constants.PUBLIC_KEY_BYTE_LENGTH);for(var i=0;i<r.length;++i){r[i]=t[32+i]}return r};c.sign=function(e){e=e||{};var t=messageToNativeBuffer(e);var r=messageToNativeBuffer({message:e.privateKey,encoding:"binary"});if(r.length===c.constants.SEED_BYTE_LENGTH){var i=c.generateKeyPair({seed:r});r=i.privateKey}else if(r.length!==c.constants.PRIVATE_KEY_BYTE_LENGTH){throw new TypeError('"options.privateKey" must have a byte length of '+c.constants.SEED_BYTE_LENGTH+" or "+c.constants.PRIVATE_KEY_BYTE_LENGTH)}var n=new f(c.constants.SIGN_BYTE_LENGTH+t.length);crypto_sign(n,t,t.length,r);var a=new f(c.constants.SIGN_BYTE_LENGTH);for(var s=0;s<a.length;++s){a[s]=n[s]}return a};c.verify=function(e){e=e||{};var t=messageToNativeBuffer(e);if(e.signature===undefined){throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge '+"ByteBuffer, or a binary string.")}var r=messageToNativeBuffer({message:e.signature,encoding:"binary"});if(r.length!==c.constants.SIGN_BYTE_LENGTH){throw new TypeError('"options.signature" must have a byte length of '+c.constants.SIGN_BYTE_LENGTH)}var i=messageToNativeBuffer({message:e.publicKey,encoding:"binary"});if(i.length!==c.constants.PUBLIC_KEY_BYTE_LENGTH){throw new TypeError('"options.publicKey" must have a byte length of '+c.constants.PUBLIC_KEY_BYTE_LENGTH)}var n=new f(c.constants.SIGN_BYTE_LENGTH+t.length);var a=new f(c.constants.SIGN_BYTE_LENGTH+t.length);var s;for(s=0;s<c.constants.SIGN_BYTE_LENGTH;++s){n[s]=r[s]}for(s=0;s<t.length;++s){n[s+c.constants.SIGN_BYTE_LENGTH]=t[s]}return crypto_sign_open(a,n,n.length,i)>=0};function messageToNativeBuffer(e){var t=e.message;if(t instanceof Uint8Array||t instanceof f){return t}var r=e.encoding;if(t===undefined){if(e.md){t=e.md.digest().getBytes();r="binary"}else{throw new TypeError('"options.message" or "options.md" not specified.')}}if(typeof t==="string"&&!r){throw new TypeError('"options.encoding" must be "binary" or "utf8".')}if(typeof t==="string"){if(typeof Buffer!=="undefined"){return Buffer.from(t,r)}t=new u(t,r)}else if(!(t instanceof u)){throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge '+'ByteBuffer, or a string with "options.encoding" specifying its '+"encoding.")}var i=new f(t.length());for(var n=0;n<i.length;++n){i[n]=t.at(n)}return i}var l=gf();var h=gf([1]);var p=gf([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]);var d=gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]);var y=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]);var g=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]);var v=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);var m=gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function sha512(e,t){var r=i.md.sha512.create();var n=new u(e);r.update(n.getBytes(t),"binary");var a=r.digest().getBytes();if(typeof Buffer!=="undefined"){return Buffer.from(a,"binary")}var s=new f(c.constants.HASH_BYTE_LENGTH);for(var o=0;o<64;++o){s[o]=a.charCodeAt(o)}return s}function crypto_sign_keypair(e,t){var r=[gf(),gf(),gf(),gf()];var i;var n=sha512(t,32);n[0]&=248;n[31]&=127;n[31]|=64;scalarbase(r,n);pack(e,r);for(i=0;i<32;++i){t[i+32]=e[i]}return 0}function crypto_sign(e,t,r,i){var n,a,s=new Float64Array(64);var o=[gf(),gf(),gf(),gf()];var u=sha512(i,32);u[0]&=248;u[31]&=127;u[31]|=64;var f=r+64;for(n=0;n<r;++n){e[64+n]=t[n]}for(n=0;n<32;++n){e[32+n]=u[32+n]}var c=sha512(e.subarray(32),r+32);reduce(c);scalarbase(o,c);pack(e,o);for(n=32;n<64;++n){e[n]=i[n]}var l=sha512(e,r+64);reduce(l);for(n=32;n<64;++n){s[n]=0}for(n=0;n<32;++n){s[n]=c[n]}for(n=0;n<32;++n){for(a=0;a<32;a++){s[n+a]+=l[n]*u[a]}}modL(e.subarray(32),s);return f}function crypto_sign_open(e,t,r,i){var n,a;var s=new f(32);var o=[gf(),gf(),gf(),gf()],u=[gf(),gf(),gf(),gf()];a=-1;if(r<64){return-1}if(unpackneg(u,i)){return-1}for(n=0;n<r;++n){e[n]=t[n]}for(n=0;n<32;++n){e[n+32]=i[n]}var c=sha512(e,r);reduce(c);scalarmult(o,u,c);scalarbase(u,t.subarray(32));add(o,u);pack(s,o);r-=64;if(crypto_verify_32(t,0,s,0)){for(n=0;n<r;++n){e[n]=0}return-1}for(n=0;n<r;++n){e[n]=t[n+64]}a=r;return a}function modL(e,t){var r,i,n,a;for(i=63;i>=32;--i){r=0;for(n=i-32,a=i-12;n<a;++n){t[n]+=r-16*t[i]*v[n-(i-32)];r=t[n]+128>>8;t[n]-=r*256}t[n]+=r;t[i]=0}r=0;for(n=0;n<32;++n){t[n]+=r-(t[31]>>4)*v[n];r=t[n]>>8;t[n]&=255}for(n=0;n<32;++n){t[n]-=r*v[n]}for(i=0;i<32;++i){t[i+1]+=t[i]>>8;e[i]=t[i]&255}}function reduce(e){var t=new Float64Array(64);for(var r=0;r<64;++r){t[r]=e[r];e[r]=0}modL(e,t)}function add(e,t){var r=gf(),i=gf(),n=gf(),a=gf(),s=gf(),o=gf(),u=gf(),f=gf(),c=gf();Z(r,e[1],e[0]);Z(c,t[1],t[0]);M(r,r,c);A(i,e[0],e[1]);A(c,t[0],t[1]);M(i,i,c);M(n,e[3],t[3]);M(n,n,d);M(a,e[2],t[2]);A(a,a,a);Z(s,i,r);Z(o,a,n);A(u,a,n);A(f,i,r);M(e[0],s,o);M(e[1],f,u);M(e[2],u,o);M(e[3],s,f)}function cswap(e,t,r){for(var i=0;i<4;++i){sel25519(e[i],t[i],r)}}function pack(e,t){var r=gf(),i=gf(),n=gf();inv25519(n,t[2]);M(r,t[0],n);M(i,t[1],n);pack25519(e,i);e[31]^=par25519(r)<<7}function pack25519(e,t){var r,i,n;var a=gf(),s=gf();for(r=0;r<16;++r){s[r]=t[r]}car25519(s);car25519(s);car25519(s);for(i=0;i<2;++i){a[0]=s[0]-65517;for(r=1;r<15;++r){a[r]=s[r]-65535-(a[r-1]>>16&1);a[r-1]&=65535}a[15]=s[15]-32767-(a[14]>>16&1);n=a[15]>>16&1;a[14]&=65535;sel25519(s,a,1-n)}for(r=0;r<16;r++){e[2*r]=s[r]&255;e[2*r+1]=s[r]>>8}}function unpackneg(e,t){var r=gf(),i=gf(),n=gf(),a=gf(),s=gf(),o=gf(),u=gf();set25519(e[2],h);unpack25519(e[1],t);S(n,e[1]);M(a,n,p);Z(n,n,e[2]);A(a,e[2],a);S(s,a);S(o,s);M(u,o,s);M(r,u,n);M(r,r,a);pow2523(r,r);M(r,r,n);M(r,r,a);M(r,r,a);M(e[0],r,a);S(i,e[0]);M(i,i,a);if(neq25519(i,n)){M(e[0],e[0],m)}S(i,e[0]);M(i,i,a);if(neq25519(i,n)){return-1}if(par25519(e[0])===t[31]>>7){Z(e[0],l,e[0])}M(e[3],e[0],e[1]);return 0}function unpack25519(e,t){var r;for(r=0;r<16;++r){e[r]=t[2*r]+(t[2*r+1]<<8)}e[15]&=32767}function pow2523(e,t){var r=gf();var i;for(i=0;i<16;++i){r[i]=t[i]}for(i=250;i>=0;--i){S(r,r);if(i!==1){M(r,r,t)}}for(i=0;i<16;++i){e[i]=r[i]}}function neq25519(e,t){var r=new f(32);var i=new f(32);pack25519(r,e);pack25519(i,t);return crypto_verify_32(r,0,i,0)}function crypto_verify_32(e,t,r,i){return vn(e,t,r,i,32)}function vn(e,t,r,i,n){var a,s=0;for(a=0;a<n;++a){s|=e[t+a]^r[i+a]}return(1&s-1>>>8)-1}function par25519(e){var t=new f(32);pack25519(t,e);return t[0]&1}function scalarmult(e,t,r){var i,n;set25519(e[0],l);set25519(e[1],h);set25519(e[2],h);set25519(e[3],l);for(n=255;n>=0;--n){i=r[n/8|0]>>(n&7)&1;cswap(e,t,i);add(t,e);add(e,e);cswap(e,t,i)}}function scalarbase(e,t){var r=[gf(),gf(),gf(),gf()];set25519(r[0],y);set25519(r[1],g);set25519(r[2],h);M(r[3],y,g);scalarmult(e,r,t)}function set25519(e,t){var r;for(r=0;r<16;r++){e[r]=t[r]|0}}function inv25519(e,t){var r=gf();var i;for(i=0;i<16;++i){r[i]=t[i]}for(i=253;i>=0;--i){S(r,r);if(i!==2&&i!==4){M(r,r,t)}}for(i=0;i<16;++i){e[i]=r[i]}}function car25519(e){var t,r,i=1;for(t=0;t<16;++t){r=e[t]+i+65535;i=Math.floor(r/65536);e[t]=r-i*65536}e[0]+=i-1+37*(i-1)}function sel25519(e,t,r){var i,n=~(r-1);for(var a=0;a<16;++a){i=n&(e[a]^t[a]);e[a]^=i;t[a]^=i}}function gf(e){var t,r=new Float64Array(16);if(e){for(t=0;t<e.length;++t){r[t]=e[t]}}return r}function A(e,t,r){for(var i=0;i<16;++i){e[i]=t[i]+r[i]}}function Z(e,t,r){for(var i=0;i<16;++i){e[i]=t[i]-r[i]}}function S(e,t){M(e,t,t)}function M(e,t,r){var i,n,a=0,s=0,o=0,u=0,f=0,c=0,l=0,h=0,p=0,d=0,y=0,g=0,v=0,m=0,C=0,E=0,S=0,T=0,I=0,B=0,A=0,_=0,b=0,N=0,w=0,R=0,L=0,U=0,D=0,k=0,P=0,V=r[0],O=r[1],M=r[2],K=r[3],x=r[4],F=r[5],q=r[6],G=r[7],H=r[8],Q=r[9],z=r[10],W=r[11],X=r[12],Y=r[13],Z=r[14],j=r[15];i=t[0];a+=i*V;s+=i*O;o+=i*M;u+=i*K;f+=i*x;c+=i*F;l+=i*q;h+=i*G;p+=i*H;d+=i*Q;y+=i*z;g+=i*W;v+=i*X;m+=i*Y;C+=i*Z;E+=i*j;i=t[1];s+=i*V;o+=i*O;u+=i*M;f+=i*K;c+=i*x;l+=i*F;h+=i*q;p+=i*G;d+=i*H;y+=i*Q;g+=i*z;v+=i*W;m+=i*X;C+=i*Y;E+=i*Z;S+=i*j;i=t[2];o+=i*V;u+=i*O;f+=i*M;c+=i*K;l+=i*x;h+=i*F;p+=i*q;d+=i*G;y+=i*H;g+=i*Q;v+=i*z;m+=i*W;C+=i*X;E+=i*Y;S+=i*Z;T+=i*j;i=t[3];u+=i*V;f+=i*O;c+=i*M;l+=i*K;h+=i*x;p+=i*F;d+=i*q;y+=i*G;g+=i*H;v+=i*Q;m+=i*z;C+=i*W;E+=i*X;S+=i*Y;T+=i*Z;I+=i*j;i=t[4];f+=i*V;c+=i*O;l+=i*M;h+=i*K;p+=i*x;d+=i*F;y+=i*q;g+=i*G;v+=i*H;m+=i*Q;C+=i*z;E+=i*W;S+=i*X;T+=i*Y;I+=i*Z;B+=i*j;i=t[5];c+=i*V;l+=i*O;h+=i*M;p+=i*K;d+=i*x;y+=i*F;g+=i*q;v+=i*G;m+=i*H;C+=i*Q;E+=i*z;S+=i*W;T+=i*X;I+=i*Y;B+=i*Z;A+=i*j;i=t[6];l+=i*V;h+=i*O;p+=i*M;d+=i*K;y+=i*x;g+=i*F;v+=i*q;m+=i*G;C+=i*H;E+=i*Q;S+=i*z;T+=i*W;I+=i*X;B+=i*Y;A+=i*Z;_+=i*j;i=t[7];h+=i*V;p+=i*O;d+=i*M;y+=i*K;g+=i*x;v+=i*F;m+=i*q;C+=i*G;E+=i*H;S+=i*Q;T+=i*z;I+=i*W;B+=i*X;A+=i*Y;_+=i*Z;b+=i*j;i=t[8];p+=i*V;d+=i*O;y+=i*M;g+=i*K;v+=i*x;m+=i*F;C+=i*q;E+=i*G;S+=i*H;T+=i*Q;I+=i*z;B+=i*W;A+=i*X;_+=i*Y;b+=i*Z;N+=i*j;i=t[9];d+=i*V;y+=i*O;g+=i*M;v+=i*K;m+=i*x;C+=i*F;E+=i*q;S+=i*G;T+=i*H;I+=i*Q;B+=i*z;A+=i*W;_+=i*X;b+=i*Y;N+=i*Z;w+=i*j;i=t[10];y+=i*V;g+=i*O;v+=i*M;m+=i*K;C+=i*x;E+=i*F;S+=i*q;T+=i*G;I+=i*H;B+=i*Q;A+=i*z;_+=i*W;b+=i*X;N+=i*Y;w+=i*Z;R+=i*j;i=t[11];g+=i*V;v+=i*O;m+=i*M;C+=i*K;E+=i*x;S+=i*F;T+=i*q;I+=i*G;B+=i*H;A+=i*Q;_+=i*z;b+=i*W;N+=i*X;w+=i*Y;R+=i*Z;L+=i*j;i=t[12];v+=i*V;m+=i*O;C+=i*M;E+=i*K;S+=i*x;T+=i*F;I+=i*q;B+=i*G;A+=i*H;_+=i*Q;b+=i*z;N+=i*W;w+=i*X;R+=i*Y;L+=i*Z;U+=i*j;i=t[13];m+=i*V;C+=i*O;E+=i*M;S+=i*K;T+=i*x;I+=i*F;B+=i*q;A+=i*G;_+=i*H;b+=i*Q;N+=i*z;w+=i*W;R+=i*X;L+=i*Y;U+=i*Z;D+=i*j;i=t[14];C+=i*V;E+=i*O;S+=i*M;T+=i*K;I+=i*x;B+=i*F;A+=i*q;_+=i*G;b+=i*H;N+=i*Q;w+=i*z;R+=i*W;L+=i*X;U+=i*Y;D+=i*Z;k+=i*j;i=t[15];E+=i*V;S+=i*O;T+=i*M;I+=i*K;B+=i*x;A+=i*F;_+=i*q;b+=i*G;N+=i*H;w+=i*Q;R+=i*z;L+=i*W;U+=i*X;D+=i*Y;k+=i*Z;P+=i*j;a+=38*S;s+=38*T;o+=38*I;u+=38*B;f+=38*A;c+=38*_;l+=38*b;h+=38*N;p+=38*w;d+=38*R;y+=38*L;g+=38*U;v+=38*D;m+=38*k;C+=38*P;n=1;i=a+n+65535;n=Math.floor(i/65536);a=i-n*65536;i=s+n+65535;n=Math.floor(i/65536);s=i-n*65536;i=o+n+65535;n=Math.floor(i/65536);o=i-n*65536;i=u+n+65535;n=Math.floor(i/65536);u=i-n*65536;i=f+n+65535;n=Math.floor(i/65536);f=i-n*65536;i=c+n+65535;n=Math.floor(i/65536);c=i-n*65536;i=l+n+65535;n=Math.floor(i/65536);l=i-n*65536;i=h+n+65535;n=Math.floor(i/65536);h=i-n*65536;i=p+n+65535;n=Math.floor(i/65536);p=i-n*65536;i=d+n+65535;n=Math.floor(i/65536);d=i-n*65536;i=y+n+65535;n=Math.floor(i/65536);y=i-n*65536;i=g+n+65535;n=Math.floor(i/65536);g=i-n*65536;i=v+n+65535;n=Math.floor(i/65536);v=i-n*65536;i=m+n+65535;n=Math.floor(i/65536);m=i-n*65536;i=C+n+65535;n=Math.floor(i/65536);C=i-n*65536;i=E+n+65535;n=Math.floor(i/65536);E=i-n*65536;a+=n-1+37*(n-1);n=1;i=a+n+65535;n=Math.floor(i/65536);a=i-n*65536;i=s+n+65535;n=Math.floor(i/65536);s=i-n*65536;i=o+n+65535;n=Math.floor(i/65536);o=i-n*65536;i=u+n+65535;n=Math.floor(i/65536);u=i-n*65536;i=f+n+65535;n=Math.floor(i/65536);f=i-n*65536;i=c+n+65535;n=Math.floor(i/65536);c=i-n*65536;i=l+n+65535;n=Math.floor(i/65536);l=i-n*65536;i=h+n+65535;n=Math.floor(i/65536);h=i-n*65536;i=p+n+65535;n=Math.floor(i/65536);p=i-n*65536;i=d+n+65535;n=Math.floor(i/65536);d=i-n*65536;i=y+n+65535;n=Math.floor(i/65536);y=i-n*65536;i=g+n+65535;n=Math.floor(i/65536);g=i-n*65536;i=v+n+65535;n=Math.floor(i/65536);v=i-n*65536;i=m+n+65535;n=Math.floor(i/65536);m=i-n*65536;i=C+n+65535;n=Math.floor(i/65536);C=i-n*65536;i=E+n+65535;n=Math.floor(i/65536);E=i-n*65536;a+=n-1+37*(n-1);e[0]=a;e[1]=s;e[2]=o;e[3]=u;e[4]=f;e[5]=c;e[6]=l;e[7]=h;e[8]=p;e[9]=d;e[10]=y;e[11]=g;e[12]=v;e[13]=m;e[14]=C;e[15]=E}},613:function(e,t,r){var i=r(936);r(907);r(457);r(621);var n="forge.task";var a=0;var s={};var o=0;i.debug.set(n,"tasks",s);var u={};i.debug.set(n,"queues",u);var f="?";var c=30;var l=20;var h="ready";var p="running";var d="blocked";var y="sleeping";var g="done";var v="error";var m="stop";var C="start";var E="block";var S="unblock";var T="sleep";var I="wakeup";var B="cancel";var A="fail";var _={};_[h]={};_[h][m]=h;_[h][C]=p;_[h][B]=g;_[h][A]=v;_[p]={};_[p][m]=h;_[p][C]=p;_[p][E]=d;_[p][S]=p;_[p][T]=y;_[p][I]=p;_[p][B]=g;_[p][A]=v;_[d]={};_[d][m]=d;_[d][C]=d;_[d][E]=d;_[d][S]=d;_[d][T]=d;_[d][I]=d;_[d][B]=g;_[d][A]=v;_[y]={};_[y][m]=y;_[y][C]=y;_[y][E]=y;_[y][S]=y;_[y][T]=y;_[y][I]=y;_[y][B]=g;_[y][A]=v;_[g]={};_[g][m]=g;_[g][C]=g;_[g][E]=g;_[g][S]=g;_[g][T]=g;_[g][I]=g;_[g][B]=g;_[g][A]=v;_[v]={};_[v][m]=v;_[v][C]=v;_[v][E]=v;_[v][S]=v;_[v][T]=v;_[v][I]=v;_[v][B]=v;_[v][A]=v;var b=function(e){this.id=-1;this.name=e.name||f;this.parent=e.parent||null;this.run=e.run;this.subtasks=[];this.error=false;this.state=h;this.blocks=0;this.timeoutId=null;this.swapTime=null;this.userData=null;this.id=o++;s[this.id]=this;if(a>=1){i.log.verbose(n,"[%s][%s] init",this.id,this.name,this)}};b.prototype.debug=function(e){e=e||"";i.log.debug(n,e,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",u)};b.prototype.next=function(e,t){if(typeof e==="function"){t=e;e=this.name}var r=new b({run:t,name:e,parent:this});r.state=p;r.type=this.type;r.successCallback=this.successCallback||null;r.failureCallback=this.failureCallback||null;this.subtasks.push(r);return this};b.prototype.parallel=function(e,t){if(i.util.isArray(e)){t=e;e=this.name}return this.next(e,function(r){var n=r;n.block(t.length);var a=function(e,r){i.task.start({type:e,run:function(e){t[r](e)},success:function(e){n.unblock()},failure:function(e){n.unblock()}})};for(var s=0;s<t.length;s++){var o=e+"__parallel-"+r.id+"-"+s;var u=s;a(o,u)}})};b.prototype.stop=function(){this.state=_[this.state][m]};b.prototype.start=function(){this.error=false;this.state=_[this.state][C];if(this.state===p){this.start=new Date;this.run(this);w(this,0)}};b.prototype.block=function(e){e=typeof e==="undefined"?1:e;this.blocks+=e;if(this.blocks>0){this.state=_[this.state][E]}};b.prototype.unblock=function(e){e=typeof e==="undefined"?1:e;this.blocks-=e;if(this.blocks===0&&this.state!==g){this.state=p;w(this,0)}return this.blocks};b.prototype.sleep=function(e){e=typeof e==="undefined"?0:e;this.state=_[this.state][T];var t=this;this.timeoutId=setTimeout(function(){t.timeoutId=null;t.state=p;w(t,0)},e)};b.prototype.wait=function(e){e.wait(this)};b.prototype.wakeup=function(){if(this.state===y){cancelTimeout(this.timeoutId);this.timeoutId=null;this.state=p;w(this,0)}};b.prototype.cancel=function(){this.state=_[this.state][B];this.permitsNeeded=0;if(this.timeoutId!==null){cancelTimeout(this.timeoutId);this.timeoutId=null}this.subtasks=[]};b.prototype.fail=function(e){this.error=true;R(this,true);if(e){e.error=this.error;e.swapTime=this.swapTime;e.userData=this.userData;w(e,0)}else{if(this.parent!==null){var t=this.parent;while(t.parent!==null){t.error=this.error;t.swapTime=this.swapTime;t.userData=this.userData;t=t.parent}R(t,true)}if(this.failureCallback){this.failureCallback(this)}}};var N=function(e){e.error=false;e.state=_[e.state][C];setTimeout(function(){if(e.state===p){e.swapTime=+new Date;e.run(e);w(e,0)}},0)};var w=function(e,t){var r=t>c||+new Date-e.swapTime>l;var i=function(t){t++;if(e.state===p){if(r){e.swapTime=+new Date}if(e.subtasks.length>0){var i=e.subtasks.shift();i.error=e.error;i.swapTime=e.swapTime;i.userData=e.userData;i.run(i);if(!i.error){w(i,t)}}else{R(e);if(!e.error){if(e.parent!==null){e.parent.error=e.error;e.parent.swapTime=e.swapTime;e.parent.userData=e.userData;w(e.parent,t)}}}}};if(r){setTimeout(i,0)}else{i(t)}};var R=function(e,t){e.state=g;delete s[e.id];if(a>=1){i.log.verbose(n,"[%s][%s] finish",e.id,e.name,e)}if(e.parent===null){if(!(e.type in u)){i.log.error(n,"[%s][%s] task queue missing [%s]",e.id,e.name,e.type)}else if(u[e.type].length===0){i.log.error(n,"[%s][%s] task queue empty [%s]",e.id,e.name,e.type)}else if(u[e.type][0]!==e){i.log.error(n,"[%s][%s] task not first in queue [%s]",e.id,e.name,e.type)}else{u[e.type].shift();if(u[e.type].length===0){if(a>=1){i.log.verbose(n,"[%s][%s] delete queue [%s]",e.id,e.name,e.type)}delete u[e.type]}else{if(a>=1){i.log.verbose(n,"[%s][%s] queue start next [%s] remain:%s",e.id,e.name,e.type,u[e.type].length)}u[e.type][0].start()}}if(!t){if(e.error&&e.failureCallback){e.failureCallback(e)}else if(!e.error&&e.successCallback){e.successCallback(e)}}}};e.exports=i.task=i.task||{};i.task.start=function(e){var t=new b({run:e.run,name:e.name||f});t.type=e.type;t.successCallback=e.success||null;t.failureCallback=e.failure||null;if(!(t.type in u)){if(a>=1){i.log.verbose(n,"[%s][%s] create queue [%s]",t.id,t.name,t.type)}u[t.type]=[t];N(t)}else{u[e.type].push(t)}};i.task.cancel=function(e){if(e in u){u[e]=[u[e][0]]}};i.task.createCondition=function(){var e={tasks:{}};e.wait=function(t){if(!(t.id in e.tasks)){t.block();e.tasks[t.id]=t}};e.notify=function(){var t=e.tasks;e.tasks={};for(var r in t){t[r].unblock()}};return e}},620:function(e,t,r){var i=r(936);r(960);r(465);r(621);e.exports=i.aes=i.aes||{};i.aes.startEncrypting=function(e,t,r,i){var n=_createCipher({key:e,output:r,decrypt:false,mode:i});n.start(t);return n};i.aes.createEncryptionCipher=function(e,t){return _createCipher({key:e,output:null,decrypt:false,mode:t})};i.aes.startDecrypting=function(e,t,r,i){var n=_createCipher({key:e,output:r,decrypt:true,mode:i});n.start(t);return n};i.aes.createDecryptionCipher=function(e,t){return _createCipher({key:e,output:null,decrypt:true,mode:t})};i.aes.Algorithm=function(e,t){if(!n){initialize()}var r=this;r.name=e;r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return _updateBlock(r._w,e,t,false)},decrypt:function(e,t){return _updateBlock(r._w,e,t,true)}}});r._init=false};i.aes.Algorithm.prototype.initialize=function(e){if(this._init){return}var t=e.key;var r;if(typeof t==="string"&&(t.length===16||t.length===24||t.length===32)){t=i.util.createBuffer(t)}else if(i.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t;t=i.util.createBuffer();for(var n=0;n<r.length;++n){t.putByte(r[n])}}if(!i.util.isArray(t)){r=t;t=[];var a=r.length();if(a===16||a===24||a===32){a=a>>>2;for(var n=0;n<a;++n){t.push(r.getInt32())}}}if(!i.util.isArray(t)||!(t.length===4||t.length===6||t.length===8)){throw new Error("Invalid key parameter.")}var s=this.mode.name;var o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=_expandKey(t,e.decrypt&&!o);this._init=true};i.aes._expandKey=function(e,t){if(!n){initialize()}return _expandKey(e,t)};i.aes._updateBlock=_updateBlock;registerAlgorithm("AES-ECB",i.cipher.modes.ecb);registerAlgorithm("AES-CBC",i.cipher.modes.cbc);registerAlgorithm("AES-CFB",i.cipher.modes.cfb);registerAlgorithm("AES-OFB",i.cipher.modes.ofb);registerAlgorithm("AES-CTR",i.cipher.modes.ctr);registerAlgorithm("AES-GCM",i.cipher.modes.gcm);function registerAlgorithm(e,t){var r=function(){return new i.aes.Algorithm(e,t)};i.cipher.registerAlgorithm(e,r)}var n=false;var a=4;var s;var o;var u;var f;var c;function initialize(){n=true;u=[0,1,2,4,8,16,32,64,128,27,54];var e=new Array(256);for(var t=0;t<128;++t){e[t]=t<<1;e[t+128]=t+128<<1^283}s=new Array(256);o=new Array(256);f=new Array(4);c=new Array(4);for(var t=0;t<4;++t){f[t]=new Array(256);c[t]=new Array(256)}var r=0,i=0,a,l,h,p,d,y,g;for(var t=0;t<256;++t){p=i^i<<1^i<<2^i<<3^i<<4;p=p>>8^p&255^99;s[r]=p;o[p]=r;d=e[p];a=e[r];l=e[a];h=e[l];y=d<<24^p<<16^p<<8^(p^d);g=(a^l^h)<<24^(r^h)<<16^(r^l^h)<<8^(r^a^h);for(var v=0;v<4;++v){f[v][r]=y;c[v][p]=g;y=y<<24|y>>>8;g=g<<24|g>>>8}if(r===0){r=i=1}else{r=a^e[e[e[a^h]]];i^=e[e[i]]}}}function _expandKey(e,t){var r=e.slice(0);var i,n=1;var o=r.length;var f=o+6+1;var l=a*f;for(var h=o;h<l;++h){i=r[h-1];if(h%o===0){i=s[i>>>16&255]<<24^s[i>>>8&255]<<16^s[i&255]<<8^s[i>>>24]^u[n]<<24;n++}else if(o>6&&h%o===4){i=s[i>>>24]<<24^s[i>>>16&255]<<16^s[i>>>8&255]<<8^s[i&255]}r[h]=r[h-o]^i}if(t){var p;var d=c[0];var y=c[1];var g=c[2];var v=c[3];var m=r.slice(0);l=r.length;for(var h=0,C=l-a;h<l;h+=a,C-=a){if(h===0||h===l-a){m[h]=r[C];m[h+1]=r[C+3];m[h+2]=r[C+2];m[h+3]=r[C+1]}else{for(var E=0;E<a;++E){p=r[C+E];m[h+(3&-E)]=d[s[p>>>24]]^y[s[p>>>16&255]]^g[s[p>>>8&255]]^v[s[p&255]]}}}r=m}return r}function _updateBlock(e,t,r,i){var n=e.length/4-1;var a,u,l,h,p;if(i){a=c[0];u=c[1];l=c[2];h=c[3];p=o}else{a=f[0];u=f[1];l=f[2];h=f[3];p=s}var d,y,g,v,m,C,E;d=t[0]^e[0];y=t[i?3:1]^e[1];g=t[2]^e[2];v=t[i?1:3]^e[3];var S=3;for(var T=1;T<n;++T){m=a[d>>>24]^u[y>>>16&255]^l[g>>>8&255]^h[v&255]^e[++S];C=a[y>>>24]^u[g>>>16&255]^l[v>>>8&255]^h[d&255]^e[++S];E=a[g>>>24]^u[v>>>16&255]^l[d>>>8&255]^h[y&255]^e[++S];v=a[v>>>24]^u[d>>>16&255]^l[y>>>8&255]^h[g&255]^e[++S];d=m;y=C;g=E}r[0]=p[d>>>24]<<24^p[y>>>16&255]<<16^p[g>>>8&255]<<8^p[v&255]^e[++S];r[i?3:1]=p[y>>>24]<<24^p[g>>>16&255]<<16^p[v>>>8&255]<<8^p[d&255]^e[++S];r[2]=p[g>>>24]<<24^p[v>>>16&255]<<16^p[d>>>8&255]<<8^p[y&255]^e[++S];r[i?1:3]=p[v>>>24]<<24^p[d>>>16&255]<<16^p[y>>>8&255]<<8^p[g&255]^e[++S]}function _createCipher(e){e=e||{};var t=(e.mode||"CBC").toUpperCase();var r="AES-"+t;var n;if(e.decrypt){n=i.cipher.createDecipher(r,e.key)}else{n=i.cipher.createCipher(r,e.key)}var a=n.start;n.start=function(e,t){var r=null;if(t instanceof i.util.ByteBuffer){r=t;t={}}t=t||{};t.output=r;t.iv=e;a.call(n,t)};return n}},621:function(e,t,r){var i=r(936);var n=r(749);var a=e.exports=i.util=i.util||{};(function(){if(typeof process!=="undefined"&&process.nextTick&&!process.browser){a.nextTick=process.nextTick;if(typeof setImmediate==="function"){a.setImmediate=setImmediate}else{a.setImmediate=a.nextTick}return}if(typeof setImmediate==="function"){a.setImmediate=function(){return setImmediate.apply(undefined,arguments)};a.nextTick=function(e){return setImmediate(e)};return}a.setImmediate=function(e){setTimeout(e,0)};if(typeof window!=="undefined"&&typeof window.postMessage==="function"){var e="forge.setImmediate";var t=[];a.setImmediate=function(r){t.push(r);if(t.length===1){window.postMessage(e,"*")}};function handler(r){if(r.source===window&&r.data===e){r.stopPropagation();var i=t.slice();t.length=0;i.forEach(function(e){e()})}}window.addEventListener("message",handler,true)}if(typeof MutationObserver!=="undefined"){var r=Date.now();var i=true;var n=document.createElement("div");var t=[];new MutationObserver(function(){var e=t.slice();t.length=0;e.forEach(function(e){e()})}).observe(n,{attributes:true});var s=a.setImmediate;a.setImmediate=function(e){if(Date.now()-r>15){r=Date.now();s(e)}else{t.push(e);if(t.length===1){n.setAttribute("a",i=!i)}}}}a.nextTick=a.setImmediate})();a.isNodejs=typeof process!=="undefined"&&process.versions&&process.versions.node;a.globalScope=function(){if(a.isNodejs){return global}return typeof self==="undefined"?window:self}();a.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};a.isArrayBuffer=function(e){return typeof ArrayBuffer!=="undefined"&&e instanceof ArrayBuffer};a.isArrayBufferView=function(e){return e&&a.isArrayBuffer(e.buffer)&&e.byteLength!==undefined};function _checkBitsParam(e){if(!(e===8||e===16||e===24||e===32)){throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}}a.ByteBuffer=ByteStringBuffer;function ByteStringBuffer(e){this.data="";this.read=0;if(typeof e==="string"){this.data=e}else if(a.isArrayBuffer(e)||a.isArrayBufferView(e)){if(typeof Buffer!=="undefined"&&e instanceof Buffer){this.data=e.toString("binary")}else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(e){for(var r=0;r<t.length;++r){this.putByte(t[r])}}}}else if(e instanceof ByteStringBuffer||typeof e==="object"&&typeof e.data==="string"&&typeof e.read==="number"){this.data=e.data;this.read=e.read}this._constructedStringLength=0}a.ByteStringBuffer=ByteStringBuffer;var s=4096;a.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e;if(this._constructedStringLength>s){this.data.substr(0,1);this._constructedStringLength=0}};a.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};a.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};a.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};a.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);var r=this.data;while(t>0){if(t&1){r+=e}t>>>=1;if(t>0){e+=e}}this.data=r;this._optimizeConstructedString(t);return this};a.ByteStringBuffer.prototype.putBytes=function(e){this.data+=e;this._optimizeConstructedString(e.length);return this};a.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(a.encodeUtf8(e))};a.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};a.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};a.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};a.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};a.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};a.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};a.ByteStringBuffer.prototype.putInt=function(e,t){_checkBitsParam(t);var r="";do{t-=8;r+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(r)};a.ByteStringBuffer.prototype.putSignedInt=function(e,t){if(e<0){e+=2<<t-1}return this.putInt(e,t)};a.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};a.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};a.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);this.read+=2;return e};a.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);this.read+=3;return e};a.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);this.read+=4;return e};a.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;this.read+=2;return e};a.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;this.read+=3;return e};a.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;this.read+=4;return e};a.ByteStringBuffer.prototype.getInt=function(e){_checkBitsParam(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++);e-=8}while(e>0);return t};a.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e);var r=2<<e-2;if(t>=r){t-=r<<1}return t};a.ByteStringBuffer.prototype.getBytes=function(e){var t;if(e){e=Math.min(this.length(),e);t=this.data.slice(this.read,this.read+e);this.read+=e}else if(e===0){t=""}else{t=this.read===0?this.data:this.data.slice(this.read);this.clear()}return t};a.ByteStringBuffer.prototype.bytes=function(e){return typeof e==="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};a.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};a.ByteStringBuffer.prototype.setAt=function(e,t){this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1);return this};a.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};a.ByteStringBuffer.prototype.copy=function(){var e=a.createBuffer(this.data);e.read=this.read;return e};a.ByteStringBuffer.prototype.compact=function(){if(this.read>0){this.data=this.data.slice(this.read);this.read=0}return this};a.ByteStringBuffer.prototype.clear=function(){this.data="";this.read=0;return this};a.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);this.data=this.data.substr(this.read,t);this.read=0;return this};a.ByteStringBuffer.prototype.toHex=function(){var e="";for(var t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);if(r<16){e+="0"}e+=r.toString(16)}return e};a.ByteStringBuffer.prototype.toString=function(){return a.decodeUtf8(this.bytes())};function DataBuffer(e,t){t=t||{};this.read=t.readOffset||0;this.growSize=t.growSize||1024;var r=a.isArrayBuffer(e);var i=a.isArrayBufferView(e);if(r||i){if(r){this.data=new DataView(e)}else{this.data=new DataView(e.buffer,e.byteOffset,e.byteLength)}this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0));this.write=0;if(e!==null&&e!==undefined){this.putBytes(e)}if("writeOffset"in t){this.write=t.writeOffset}}a.DataBuffer=DataBuffer;a.DataBuffer.prototype.length=function(){return this.write-this.read};a.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};a.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e){return this}t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);var i=new Uint8Array(this.length()+t);i.set(r);this.data=new DataView(i.buffer);return this};a.DataBuffer.prototype.putByte=function(e){this.accommodate(1);this.data.setUint8(this.write++,e);return this};a.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r){this.data.setUint8(e)}return this};a.DataBuffer.prototype.putBytes=function(e,t){if(a.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);var i=r.byteLength-r.byteOffset;this.accommodate(i);var n=new Uint8Array(this.data.buffer,this.write);n.set(r);this.write+=i;return this}if(a.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var n=new Uint8Array(this.data.buffer);n.set(r,this.write);this.write+=r.byteLength;return this}if(e instanceof a.DataBuffer||typeof e==="object"&&typeof e.read==="number"&&typeof e.write==="number"&&a.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var n=new Uint8Array(e.data.byteLength,this.write);n.set(r);this.write+=r.byteLength;return this}if(e instanceof a.ByteStringBuffer){e=e.data;t="binary"}t=t||"binary";if(typeof e==="string"){var s;if(t==="hex"){this.accommodate(Math.ceil(e.length/2));s=new Uint8Array(this.data.buffer,this.write);this.write+=a.binary.hex.decode(e,s,this.write);return this}if(t==="base64"){this.accommodate(Math.ceil(e.length/4)*3);s=new Uint8Array(this.data.buffer,this.write);this.write+=a.binary.base64.decode(e,s,this.write);return this}if(t==="utf8"){e=a.encodeUtf8(e);t="binary"}if(t==="binary"||t==="raw"){this.accommodate(e.length);s=new Uint8Array(this.data.buffer,this.write);this.write+=a.binary.raw.decode(s);return this}if(t==="utf16"){this.accommodate(e.length*2);s=new Uint16Array(this.data.buffer,this.write);this.write+=a.text.utf16.encode(s);return this}throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};a.DataBuffer.prototype.putBuffer=function(e){this.putBytes(e);e.clear();return this};a.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};a.DataBuffer.prototype.putInt16=function(e){this.accommodate(2);this.data.setInt16(this.write,e);this.write+=2;return this};a.DataBuffer.prototype.putInt24=function(e){this.accommodate(3);this.data.setInt16(this.write,e>>8&65535);this.data.setInt8(this.write,e>>16&255);this.write+=3;return this};a.DataBuffer.prototype.putInt32=function(e){this.accommodate(4);this.data.setInt32(this.write,e);this.write+=4;return this};a.DataBuffer.prototype.putInt16Le=function(e){this.accommodate(2);this.data.setInt16(this.write,e,true);this.write+=2;return this};a.DataBuffer.prototype.putInt24Le=function(e){this.accommodate(3);this.data.setInt8(this.write,e>>16&255);this.data.setInt16(this.write,e>>8&65535,true);this.write+=3;return this};a.DataBuffer.prototype.putInt32Le=function(e){this.accommodate(4);this.data.setInt32(this.write,e,true);this.write+=4;return this};a.DataBuffer.prototype.putInt=function(e,t){_checkBitsParam(t);this.accommodate(t/8);do{t-=8;this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this};a.DataBuffer.prototype.putSignedInt=function(e,t){_checkBitsParam(t);this.accommodate(t/8);if(e<0){e+=2<<t-1}return this.putInt(e,t)};a.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};a.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);this.read+=2;return e};a.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);this.read+=3;return e};a.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);this.read+=4;return e};a.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,true);this.read+=2;return e};a.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,true)<<8;this.read+=3;return e};a.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,true);this.read+=4;return e};a.DataBuffer.prototype.getInt=function(e){_checkBitsParam(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++);e-=8}while(e>0);return t};a.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e);var r=2<<e-2;if(t>=r){t-=r<<1}return t};a.DataBuffer.prototype.getBytes=function(e){var t;if(e){e=Math.min(this.length(),e);t=this.data.slice(this.read,this.read+e);this.read+=e}else if(e===0){t=""}else{t=this.read===0?this.data:this.data.slice(this.read);this.clear()}return t};a.DataBuffer.prototype.bytes=function(e){return typeof e==="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};a.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};a.DataBuffer.prototype.setAt=function(e,t){this.data.setUint8(e,t);return this};a.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};a.DataBuffer.prototype.copy=function(){return new a.DataBuffer(this)};a.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read);var t=new Uint8Array(e.byteLength);t.set(e);this.data=new DataView(t);this.write-=this.read;this.read=0}return this};a.DataBuffer.prototype.clear=function(){this.data=new DataView(new ArrayBuffer(0));this.read=this.write=0;return this};a.DataBuffer.prototype.truncate=function(e){this.write=Math.max(0,this.length()-e);this.read=Math.min(this.read,this.write);return this};a.DataBuffer.prototype.toHex=function(){var e="";for(var t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);if(r<16){e+="0"}e+=r.toString(16)}return e};a.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());e=e||"utf8";if(e==="binary"||e==="raw"){return a.binary.raw.encode(t)}if(e==="hex"){return a.binary.hex.encode(t)}if(e==="base64"){return a.binary.base64.encode(t)}if(e==="utf8"){return a.text.utf8.decode(t)}if(e==="utf16"){return a.text.utf16.decode(t)}throw new Error("Invalid encoding: "+e)};a.createBuffer=function(e,t){t=t||"raw";if(e!==undefined&&t==="utf8"){e=a.encodeUtf8(e)}return new a.ByteBuffer(e)};a.fillString=function(e,t){var r="";while(t>0){if(t&1){r+=e}t>>>=1;if(t>0){e+=e}}return r};a.xorBytes=function(e,t,r){var i="";var n="";var a="";var s=0;var o=0;for(;r>0;--r,++s){n=e.charCodeAt(s)^t.charCodeAt(s);if(o>=10){i+=a;a="";o=0}a+=String.fromCharCode(n);++o}i+=a;return i};a.hexToBytes=function(e){var t="";var r=0;if(e.length&1==1){r=1;t+=String.fromCharCode(parseInt(e[0],16))}for(;r<e.length;r+=2){t+=String.fromCharCode(parseInt(e.substr(r,2),16))}return t};a.bytesToHex=function(e){return a.createBuffer(e).toHex()};a.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var u=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];var f="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";a.encode64=function(e,t){var r="";var i="";var n,a,s;var u=0;while(u<e.length){n=e.charCodeAt(u++);a=e.charCodeAt(u++);s=e.charCodeAt(u++);r+=o.charAt(n>>2);r+=o.charAt((n&3)<<4|a>>4);if(isNaN(a)){r+="=="}else{r+=o.charAt((a&15)<<2|s>>6);r+=isNaN(s)?"=":o.charAt(s&63)}if(t&&r.length>t){i+=r.substr(0,t)+"\r\n";r=r.substr(t)}}i+=r;return i};a.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");var t="";var r,i,n,a;var s=0;while(s<e.length){r=u[e.charCodeAt(s++)-43];i=u[e.charCodeAt(s++)-43];n=u[e.charCodeAt(s++)-43];a=u[e.charCodeAt(s++)-43];t+=String.fromCharCode(r<<2|i>>4);if(n!==64){t+=String.fromCharCode((i&15)<<4|n>>2);if(a!==64){t+=String.fromCharCode((n&3)<<6|a)}}}return t};a.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};a.decodeUtf8=function(e){return decodeURIComponent(escape(e))};a.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:n.encode,decode:n.decode}};a.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};a.binary.raw.decode=function(e,t,r){var i=t;if(!i){i=new Uint8Array(e.length)}r=r||0;var n=r;for(var a=0;a<e.length;++a){i[n++]=e.charCodeAt(a)}return t?n-r:i};a.binary.hex.encode=a.bytesToHex;a.binary.hex.decode=function(e,t,r){var i=t;if(!i){i=new Uint8Array(Math.ceil(e.length/2))}r=r||0;var n=0,a=r;if(e.length&1){n=1;i[a++]=parseInt(e[0],16)}for(;n<e.length;n+=2){i[a++]=parseInt(e.substr(n,2),16)}return t?a-r:i};a.binary.base64.encode=function(e,t){var r="";var i="";var n,a,s;var u=0;while(u<e.byteLength){n=e[u++];a=e[u++];s=e[u++];r+=o.charAt(n>>2);r+=o.charAt((n&3)<<4|a>>4);if(isNaN(a)){r+="=="}else{r+=o.charAt((a&15)<<2|s>>6);r+=isNaN(s)?"=":o.charAt(s&63)}if(t&&r.length>t){i+=r.substr(0,t)+"\r\n";r=r.substr(t)}}i+=r;return i};a.binary.base64.decode=function(e,t,r){var i=t;if(!i){i=new Uint8Array(Math.ceil(e.length/4)*3)}e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");r=r||0;var n,a,s,o;var f=0,c=r;while(f<e.length){n=u[e.charCodeAt(f++)-43];a=u[e.charCodeAt(f++)-43];s=u[e.charCodeAt(f++)-43];o=u[e.charCodeAt(f++)-43];i[c++]=n<<2|a>>4;if(s!==64){i[c++]=(a&15)<<4|s>>2;if(o!==64){i[c++]=(s&3)<<6|o}}}return t?c-r:i.subarray(0,c)};a.binary.base58.encode=function(e,t){return a.binary.baseN.encode(e,f,t)};a.binary.base58.decode=function(e,t){return a.binary.baseN.decode(e,f,t)};a.text={utf8:{},utf16:{}};a.text.utf8.encode=function(e,t,r){e=a.encodeUtf8(e);var i=t;if(!i){i=new Uint8Array(e.length)}r=r||0;var n=r;for(var s=0;s<e.length;++s){i[n++]=e.charCodeAt(s)}return t?n-r:i};a.text.utf8.decode=function(e){return a.decodeUtf8(String.fromCharCode.apply(null,e))};a.text.utf16.encode=function(e,t,r){var i=t;if(!i){i=new Uint8Array(e.length*2)}var n=new Uint16Array(i.buffer);r=r||0;var a=r;var s=r;for(var o=0;o<e.length;++o){n[s++]=e.charCodeAt(o);a+=2}return t?a-r:i};a.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};a.deflate=function(e,t,r){t=a.decode64(e.deflate(a.encode64(t)).rval);if(r){var i=2;var n=t.charCodeAt(1);if(n&32){i=6}t=t.substring(i,t.length-4)}return t};a.inflate=function(e,t,r){var i=e.inflate(a.encode64(t)).rval;return i===null?null:a.decode64(i)};var c=function(e,t,r){if(!e){throw new Error("WebStorage not available.")}var i;if(r===null){i=e.removeItem(t)}else{r=a.encode64(JSON.stringify(r));i=e.setItem(t,r)}if(typeof i!=="undefined"&&i.rval!==true){var n=new Error(i.error.message);n.id=i.error.id;n.name=i.error.name;throw n}};var l=function(e,t){if(!e){throw new Error("WebStorage not available.")}var r=e.getItem(t);if(e.init){if(r.rval===null){if(r.error){var i=new Error(r.error.message);i.id=r.error.id;i.name=r.error.name;throw i}r=null}else{r=r.rval}}if(r!==null){r=JSON.parse(a.decode64(r))}return r};var h=function(e,t,r,i){var n=l(e,t);if(n===null){n={}}n[r]=i;c(e,t,n)};var p=function(e,t,r){var i=l(e,t);if(i!==null){i=r in i?i[r]:null}return i};var d=function(e,t,r){var i=l(e,t);if(i!==null&&r in i){delete i[r];var n=true;for(var a in i){n=false;break}if(n){i=null}c(e,t,i)}};var y=function(e,t){c(e,t,null)};var g=function(e,t,r){var i=null;if(typeof r==="undefined"){r=["web","flash"]}var n;var a=false;var s=null;for(var o in r){n=r[o];try{if(n==="flash"||n==="both"){if(t[0]===null){throw new Error("Flash local storage not available.")}i=e.apply(this,t);a=n==="flash"}if(n==="web"||n==="both"){t[0]=localStorage;i=e.apply(this,t);a=true}}catch(e){s=e}if(a){break}}if(!a){throw s}return i};a.setItem=function(e,t,r,i,n){g(h,arguments,n)};a.getItem=function(e,t,r,i){return g(p,arguments,i)};a.removeItem=function(e,t,r,i){g(d,arguments,i)};a.clearItems=function(e,t,r){g(y,arguments,r)};a.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var r=t.exec(e);var i=r===null?null:{full:e,scheme:r[1],host:r[2],port:r[3],path:r[4]};if(i){i.fullHost=i.host;if(i.port){if(i.port!==80&&i.scheme==="http"){i.fullHost+=":"+i.port}else if(i.port!==443&&i.scheme==="https"){i.fullHost+=":"+i.port}}else if(i.scheme==="http"){i.port=80}else if(i.scheme==="https"){i.port=443}i.full=i.scheme+"://"+i.fullHost}return i};var v=null;a.getQueryVariables=function(e){var t=function(e){var t={};var r=e.split("&");for(var i=0;i<r.length;i++){var n=r[i].indexOf("=");var a;var s;if(n>0){a=r[i].substring(0,n);s=r[i].substring(n+1)}else{a=r[i];s=null}if(!(a in t)){t[a]=[]}if(!(a in Object.prototype)&&s!==null){t[a].push(unescape(s))}}return t};var r;if(typeof e==="undefined"){if(v===null){if(typeof window!=="undefined"&&window.location&&window.location.search){v=t(window.location.search.substring(1))}else{v={}}}r=v}else{r=t(e)}return r};a.parseFragment=function(e){var t=e;var r="";var i=e.indexOf("?");if(i>0){t=e.substring(0,i);r=e.substring(i+1)}var n=t.split("/");if(n.length>0&&n[0]===""){n.shift()}var s=r===""?{}:a.getQueryVariables(r);return{pathString:t,queryString:r,path:n,query:s}};a.makeRequest=function(e){var t=a.parseFragment(e);var r={path:t.pathString,query:t.queryString,getPath:function(e){return typeof e==="undefined"?t.path:t.path[e]},getQuery:function(e,r){var i;if(typeof e==="undefined"){i=t.query}else{i=t.query[e];if(i&&typeof r!=="undefined"){i=i[r]}}return i},getQueryLast:function(e,t){var i;var n=r.getQuery(e);if(n){i=n[n.length-1]}else{i=t}return i}};return r};a.makeLink=function(e,t,r){e=jQuery.isArray(e)?e.join("/"):e;var i=jQuery.param(t||{});r=r||"";return e+(i.length>0?"?"+i:"")+(r.length>0?"#"+r:"")};a.setPath=function(e,t,r){if(typeof e==="object"&&e!==null){var i=0;var n=t.length;while(i<n){var a=t[i++];if(i==n){e[a]=r}else{var s=a in e;if(!s||s&&typeof e[a]!=="object"||s&&e[a]===null){e[a]={}}e=e[a]}}}};a.getPath=function(e,t,r){var i=0;var n=t.length;var a=true;while(a&&i<n&&typeof e==="object"&&e!==null){var s=t[i++];a=s in e;if(a){e=e[s]}}return a?e:r};a.deletePath=function(e,t){if(typeof e==="object"&&e!==null){var r=0;var i=t.length;while(r<i){var n=t[r++];if(r==i){delete e[n]}else{if(!(n in e)||typeof e[n]!=="object"||e[n]===null){break}e=e[n]}}}};a.isEmpty=function(e){for(var t in e){if(e.hasOwnProperty(t)){return false}}return true};a.format=function(e){var t=/%./g;var r;var i;var n=0;var a=[];var s=0;while(r=t.exec(e)){i=e.substring(s,t.lastIndex-2);if(i.length>0){a.push(i)}s=t.lastIndex;var o=r[0][1];switch(o){case"s":case"o":if(n<arguments.length){a.push(arguments[n+++1])}else{a.push("<?>")}break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}a.push(e.substring(s));return a.join("")};a.formatNumber=function(e,t,r,i){var n=e,a=isNaN(t=Math.abs(t))?2:t;var s=r===undefined?",":r;var o=i===undefined?".":i,u=n<0?"-":"";var f=parseInt(n=Math.abs(+n||0).toFixed(a),10)+"";var c=f.length>3?f.length%3:0;return u+(c?f.substr(0,c)+o:"")+f.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?s+Math.abs(n-f).toFixed(a).slice(2):"")};a.formatSize=function(e){if(e>=1073741824){e=a.formatNumber(e/1073741824,2,".","")+" GiB"}else if(e>=1048576){e=a.formatNumber(e/1048576,2,".","")+" MiB"}else if(e>=1024){e=a.formatNumber(e/1024,0)+" KiB"}else{e=a.formatNumber(e,0)+" bytes"}return e};a.bytesFromIP=function(e){if(e.indexOf(".")!==-1){return a.bytesFromIPv4(e)}if(e.indexOf(":")!==-1){return a.bytesFromIPv6(e)}return null};a.bytesFromIPv4=function(e){e=e.split(".");if(e.length!==4){return null}var t=a.createBuffer();for(var r=0;r<e.length;++r){var i=parseInt(e[r],10);if(isNaN(i)){return null}t.putByte(i)}return t.getBytes()};a.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(e){if(e.length===0)++t;return true});var r=(8-e.length+t)*2;var i=a.createBuffer();for(var n=0;n<8;++n){if(!e[n]||e[n].length===0){i.fillWithByte(0,r);r=0;continue}var s=a.hexToBytes(e[n]);if(s.length<2){i.putByte(0)}i.putBytes(s)}return i.getBytes()};a.bytesToIP=function(e){if(e.length===4){return a.bytesToIPv4(e)}if(e.length===16){return a.bytesToIPv6(e)}return null};a.bytesToIPv4=function(e){if(e.length!==4){return null}var t=[];for(var r=0;r<e.length;++r){t.push(e.charCodeAt(r))}return t.join(".")};a.bytesToIPv6=function(e){if(e.length!==16){return null}var t=[];var r=[];var i=0;for(var n=0;n<e.length;n+=2){var s=a.bytesToHex(e[n]+e[n+1]);while(s[0]==="0"&&s!=="0"){s=s.substr(1)}if(s==="0"){var o=r[r.length-1];var u=t.length;if(!o||u!==o.end+1){r.push({start:u,end:u})}else{o.end=u;if(o.end-o.start>r[i].end-r[i].start){i=r.length-1}}}t.push(s)}if(r.length>0){var f=r[i];if(f.end-f.start>0){t.splice(f.start,f.end-f.start+1,"");if(f.start===0){t.unshift("")}if(f.end===7){t.push("")}}}return t.join(":")};a.estimateCores=function(e,t){if(typeof e==="function"){t=e;e={}}e=e||{};if("cores"in a&&!e.update){return t(null,a.cores)}if(typeof navigator!=="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0){a.cores=navigator.hardwareConcurrency;return t(null,a.cores)}if(typeof Worker==="undefined"){a.cores=1;return t(null,a.cores)}if(typeof Blob==="undefined"){a.cores=2;return t(null,a.cores)}var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(e){var t=Date.now();var r=t+4;while(Date.now()<r);self.postMessage({st:t,et:r})})}.toString(),")()"],{type:"application/javascript"}));sample([],5,16);function sample(e,i,n){if(i===0){var s=Math.floor(e.reduce(function(e,t){return e+t},0)/e.length);a.cores=Math.max(1,s);URL.revokeObjectURL(r);return t(null,a.cores)}map(n,function(t,r){e.push(reduce(n,r));sample(e,i-1,n)})}function map(e,t){var i=[];var n=[];for(var a=0;a<e;++a){var s=new Worker(r);s.addEventListener("message",function(r){n.push(r.data);if(n.length===e){for(var a=0;a<e;++a){i[a].terminate()}t(null,n)}});i.push(s)}for(var a=0;a<e;++a){i[a].postMessage(a)}}function reduce(e,t){var r=[];for(var i=0;i<e;++i){var n=t[i];var a=r[i]=[];for(var s=0;s<e;++s){if(i===s){continue}var o=t[s];if(n.st>o.st&&n.st<o.et||o.st>n.st&&o.st<n.et){a.push(s)}}}return r.reduce(function(e,t){return Math.max(e,t.length)},0)}}},622:function(e){e.exports=require("path")},650:function(e,t,r){var i=r(936);r(620);r(661);var n=e.exports=i.tls;n.CipherSuites["TLS_RSA_WITH_AES_128_CBC_SHA"]={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=n.BulkCipherAlgorithm.aes;e.cipher_type=n.CipherType.block;e.enc_key_length=16;e.block_length=16;e.fixed_iv_length=16;e.record_iv_length=16;e.mac_algorithm=n.MACAlgorithm.hmac_sha1;e.mac_length=20;e.mac_key_length=20},initConnectionState:initConnectionState};n.CipherSuites["TLS_RSA_WITH_AES_256_CBC_SHA"]={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=n.BulkCipherAlgorithm.aes;e.cipher_type=n.CipherType.block;e.enc_key_length=32;e.block_length=16;e.fixed_iv_length=16;e.record_iv_length=16;e.mac_algorithm=n.MACAlgorithm.hmac_sha1;e.mac_length=20;e.mac_key_length=20},initConnectionState:initConnectionState};function initConnectionState(e,t,r){var a=t.entity===i.tls.ConnectionEnd.client;e.read.cipherState={init:false,cipher:i.cipher.createDecipher("AES-CBC",a?r.keys.server_write_key:r.keys.client_write_key),iv:a?r.keys.server_write_IV:r.keys.client_write_IV};e.write.cipherState={init:false,cipher:i.cipher.createCipher("AES-CBC",a?r.keys.client_write_key:r.keys.server_write_key),iv:a?r.keys.client_write_IV:r.keys.server_write_IV};e.read.cipherFunction=decrypt_aes_cbc_sha1;e.write.cipherFunction=encrypt_aes_cbc_sha1;e.read.macLength=e.write.macLength=r.mac_length;e.read.macFunction=e.write.macFunction=n.hmac_sha1}function encrypt_aes_cbc_sha1(e,t){var r=false;var a=t.macFunction(t.macKey,t.sequenceNumber,e);e.fragment.putBytes(a);t.updateSequenceNumber();var s;if(e.version.minor===n.Versions.TLS_1_0.minor){s=t.cipherState.init?null:t.cipherState.iv}else{s=i.random.getBytesSync(16)}t.cipherState.init=true;var o=t.cipherState.cipher;o.start({iv:s});if(e.version.minor>=n.Versions.TLS_1_1.minor){o.output.putBytes(s)}o.update(e.fragment);if(o.finish(encrypt_aes_cbc_sha1_padding)){e.fragment=o.output;e.length=e.fragment.length();r=true}return r}function encrypt_aes_cbc_sha1_padding(e,t,r){if(!r){var i=e-t.length()%e;t.fillWithByte(i-1,i)}return true}function decrypt_aes_cbc_sha1_padding(e,t,r){var i=true;if(r){var n=t.length();var a=t.last();for(var s=n-1-a;s<n-1;++s){i=i&&t.at(s)==a}if(i){t.truncate(a+1)}}return i}function decrypt_aes_cbc_sha1(e,t){var r=false;var a;if(e.version.minor===n.Versions.TLS_1_0.minor){a=t.cipherState.init?null:t.cipherState.iv}else{a=e.fragment.getBytes(16)}t.cipherState.init=true;var s=t.cipherState.cipher;s.start({iv:a});s.update(e.fragment);r=s.finish(decrypt_aes_cbc_sha1_padding);var o=t.macLength;var u=i.random.getBytesSync(o);var f=s.output.length();if(f>=o){e.fragment=s.output.getBytes(f-o);u=s.output.getBytes(o)}else{e.fragment=s.output.getBytes()}e.fragment=i.util.createBuffer(e.fragment);e.length=e.fragment.length();var c=t.macFunction(t.macKey,t.sequenceNumber,e);t.updateSequenceNumber();r=compareMacs(t.macKey,u,c)&&r;return r}function compareMacs(e,t,r){var n=i.hmac.create();n.start("SHA1",e);n.update(t);t=n.digest().getBytes();n.start(null,null);n.update(r);r=n.digest().getBytes();return t===r}},661:function(e,t,r){var i=r(936);r(511);r(120);r(103);r(5);r(515);r(104);r(334);r(621);var n=function(e,t,r,n){var a=i.util.createBuffer();var s=e.length>>1;var o=s+(e.length&1);var u=e.substr(0,o);var f=e.substr(s,o);var c=i.util.createBuffer();var l=i.hmac.create();r=t+r;var h=Math.ceil(n/16);var p=Math.ceil(n/20);l.start("MD5",u);var d=i.util.createBuffer();c.putBytes(r);for(var y=0;y<h;++y){l.start(null,null);l.update(c.getBytes());c.putBuffer(l.digest());l.start(null,null);l.update(c.bytes()+r);d.putBuffer(l.digest())}l.start("SHA1",f);var g=i.util.createBuffer();c.clear();c.putBytes(r);for(var y=0;y<p;++y){l.start(null,null);l.update(c.getBytes());c.putBuffer(l.digest());l.start(null,null);l.update(c.bytes()+r);g.putBuffer(l.digest())}a.putBytes(i.util.xorBytes(d.getBytes(),g.getBytes(),n));return a};var a=function(e,t,r,i){};var s=function(e,t,r){var n=i.hmac.create();n.start("SHA1",e);var a=i.util.createBuffer();a.putInt32(t[0]);a.putInt32(t[1]);a.putByte(r.type);a.putByte(r.version.major);a.putByte(r.version.minor);a.putInt16(r.length);a.putBytes(r.fragment.bytes());n.update(a.getBytes());return n.digest().getBytes()};var o=function(e,t,r){var n=false;try{var a=e.deflate(t.fragment.getBytes());t.fragment=i.util.createBuffer(a);t.length=a.length;n=true}catch(e){}return n};var u=function(e,t,r){var n=false;try{var a=e.inflate(t.fragment.getBytes());t.fragment=i.util.createBuffer(a);t.length=a.length;n=true}catch(e){}return n};var f=function(e,t){var r=0;switch(t){case 1:r=e.getByte();break;case 2:r=e.getInt16();break;case 3:r=e.getInt24();break;case 4:r=e.getInt32();break}return i.util.createBuffer(e.getBytes(r))};var c=function(e,t,r){e.putInt(r.length(),t<<3);e.putBuffer(r)};var l={};l.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};l.SupportedVersions=[l.Versions.TLS_1_1,l.Versions.TLS_1_0];l.Version=l.SupportedVersions[0];l.MaxFragment=16384-1024;l.ConnectionEnd={server:0,client:1};l.PRFAlgorithm={tls_prf_sha256:0};l.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};l.CipherType={stream:0,block:1,aead:2};l.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};l.CompressionMethod={none:0,deflate:1};l.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};l.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};l.Alert={};l.Alert.Level={warning:1,fatal:2};l.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};l.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};l.CipherSuites={};l.getCipherSuite=function(e){var t=null;for(var r in l.CipherSuites){var i=l.CipherSuites[r];if(i.id[0]===e.charCodeAt(0)&&i.id[1]===e.charCodeAt(1)){t=i;break}}return t};l.handleUnexpected=function(e,t){var r=!e.open&&e.entity===l.ConnectionEnd.client;if(!r){e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.unexpected_message}})}};l.handleHelloRequest=function(e,t,r){if(!e.handshaking&&e.handshakes>0){l.queue(e,l.createAlert(e,{level:l.Alert.Level.warning,description:l.Alert.Description.no_renegotiation}));l.flush(e)}e.process()};l.parseHelloMessage=function(e,t,r){var n=null;var a=e.entity===l.ConnectionEnd.client;if(r<38){e.error(e,{message:a?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.illegal_parameter}})}else{var s=t.fragment;var o=s.length();n={version:{major:s.getByte(),minor:s.getByte()},random:i.util.createBuffer(s.getBytes(32)),session_id:f(s,1),extensions:[]};if(a){n.cipher_suite=s.getBytes(2);n.compression_method=s.getByte()}else{n.cipher_suites=f(s,2);n.compression_methods=f(s,1)}o=r-(o-s.length());if(o>0){var u=f(s,2);while(u.length()>0){n.extensions.push({type:[u.getByte(),u.getByte()],data:f(u,2)})}if(!a){for(var c=0;c<n.extensions.length;++c){var h=n.extensions[c];if(h.type[0]===0&&h.type[1]===0){var p=f(h.data,2);while(p.length()>0){var d=p.getByte();if(d!==0){break}e.session.extensions.server_name.serverNameList.push(f(p,2).getBytes())}}}}}if(e.session.version){if(n.version.major!==e.session.version.major||n.version.minor!==e.session.version.minor){return e.error(e,{message:"TLS version change is disallowed during renegotiation.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.protocol_version}})}}if(a){e.session.cipherSuite=l.getCipherSuite(n.cipher_suite)}else{var y=i.util.createBuffer(n.cipher_suites.bytes());while(y.length()>0){e.session.cipherSuite=l.getCipherSuite(y.getBytes(2));if(e.session.cipherSuite!==null){break}}}if(e.session.cipherSuite===null){return e.error(e,{message:"No cipher suites in common.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.handshake_failure},cipherSuite:i.util.bytesToHex(n.cipher_suite)})}if(a){e.session.compressionMethod=n.compression_method}else{e.session.compressionMethod=l.CompressionMethod.none}}return n};l.createSecurityParameters=function(e,t){var r=e.entity===l.ConnectionEnd.client;var i=t.random.bytes();var n=r?e.session.sp.client_random:i;var a=r?i:l.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:l.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:n,server_random:a}};l.handleServerHello=function(e,t,r){var i=l.parseHelloMessage(e,t,r);if(e.fail){return}if(i.version.minor<=e.version.minor){e.version.minor=i.version.minor}else{return e.error(e,{message:"Incompatible TLS version.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.protocol_version}})}e.session.version=e.version;var n=i.session_id.bytes();if(n.length>0&&n===e.session.id){e.expect=v;e.session.resuming=true;e.session.sp.server_random=i.random.bytes()}else{e.expect=p;e.session.resuming=false;l.createSecurityParameters(e,i)}e.session.id=n;e.process()};l.handleClientHello=function(e,t,r){var n=l.parseHelloMessage(e,t,r);if(e.fail){return}var a=n.session_id.bytes();var s=null;if(e.sessionCache){s=e.sessionCache.getSession(a);if(s===null){a=""}else if(s.version.major!==n.version.major||s.version.minor>n.version.minor){s=null;a=""}}if(a.length===0){a=i.random.getBytes(32)}e.session.id=a;e.session.clientHelloVersion=n.version;e.session.sp={};if(s){e.version=e.session.version=s.version;e.session.sp=s.sp}else{var o;for(var u=1;u<l.SupportedVersions.length;++u){o=l.SupportedVersions[u];if(o.minor<=n.version.minor){break}}e.version={major:o.major,minor:o.minor};e.session.version=e.version}if(s!==null){e.expect=A;e.session.resuming=true;e.session.sp.client_random=n.random.bytes()}else{e.expect=e.verifyClient!==false?T:I;e.session.resuming=false;l.createSecurityParameters(e,n)}e.open=true;l.queue(e,l.createRecord(e,{type:l.ContentType.handshake,data:l.createServerHello(e)}));if(e.session.resuming){l.queue(e,l.createRecord(e,{type:l.ContentType.change_cipher_spec,data:l.createChangeCipherSpec()}));e.state.pending=l.createConnectionState(e);e.state.current.write=e.state.pending.write;l.queue(e,l.createRecord(e,{type:l.ContentType.handshake,data:l.createFinished(e)}))}else{l.queue(e,l.createRecord(e,{type:l.ContentType.handshake,data:l.createCertificate(e)}));if(!e.fail){l.queue(e,l.createRecord(e,{type:l.ContentType.handshake,data:l.createServerKeyExchange(e)}));if(e.verifyClient!==false){l.queue(e,l.createRecord(e,{type:l.ContentType.handshake,data:l.createCertificateRequest(e)}))}l.queue(e,l.createRecord(e,{type:l.ContentType.handshake,data:l.createServerHelloDone(e)}))}}l.flush(e);e.process()};l.handleCertificate=function(e,t,r){if(r<3){return e.error(e,{message:"Invalid Certificate message. Message too short.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.illegal_parameter}})}var n=t.fragment;var a={certificate_list:f(n,3)};var s,o;var u=[];try{while(a.certificate_list.length()>0){s=f(a.certificate_list,3);o=i.asn1.fromDer(s);s=i.pki.certificateFromAsn1(o,true);u.push(s)}}catch(t){return e.error(e,{message:"Could not parse certificate list.",cause:t,send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.bad_certificate}})}var c=e.entity===l.ConnectionEnd.client;if((c||e.verifyClient===true)&&u.length===0){e.error(e,{message:c?"No server certificate provided.":"No client certificate provided.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.illegal_parameter}})}else if(u.length===0){e.expect=c?d:I}else{if(c){e.session.serverCertificate=u[0]}else{e.session.clientCertificate=u[0]}if(l.verifyCertificateChain(e,u)){e.expect=c?d:I}}e.process()};l.handleServerKeyExchange=function(e,t,r){if(r>0){return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.unsupported_certificate}})}e.expect=y;e.process()};l.handleClientKeyExchange=function(e,t,r){if(r<48){return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.unsupported_certificate}})}var n=t.fragment;var a={enc_pre_master_secret:f(n,2).getBytes()};var s=null;if(e.getPrivateKey){try{s=e.getPrivateKey(e,e.session.serverCertificate);s=i.pki.privateKeyFromPem(s)}catch(t){e.error(e,{message:"Could not get private key.",cause:t,send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.internal_error}})}}if(s===null){return e.error(e,{message:"No private key set.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.internal_error}})}try{var o=e.session.sp;o.pre_master_secret=s.decrypt(a.enc_pre_master_secret);var u=e.session.clientHelloVersion;if(u.major!==o.pre_master_secret.charCodeAt(0)||u.minor!==o.pre_master_secret.charCodeAt(1)){throw new Error("TLS version rollback attack detected.")}}catch(e){o.pre_master_secret=i.random.getBytes(48)}e.expect=A;if(e.session.clientCertificate!==null){e.expect=B}e.process()};l.handleCertificateRequest=function(e,t,r){if(r<3){return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.illegal_parameter}})}var i=t.fragment;var n={certificate_types:f(i,1),certificate_authorities:f(i,2)};e.session.certificateRequest=n;e.expect=g;e.process()};l.handleCertificateVerify=function(e,t,r){if(r<2){return e.error(e,{message:"Invalid CertificateVerify. Message too short.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.illegal_parameter}})}var n=t.fragment;n.read-=4;var a=n.bytes();n.read+=4;var s={signature:f(n,2).getBytes()};var o=i.util.createBuffer();o.putBuffer(e.session.md5.digest());o.putBuffer(e.session.sha1.digest());o=o.getBytes();try{var u=e.session.clientCertificate;if(!u.publicKey.verify(o,s.signature,"NONE")){throw new Error("CertificateVerify signature does not match.")}e.session.md5.update(a);e.session.sha1.update(a)}catch(t){return e.error(e,{message:"Bad signature in CertificateVerify.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.handshake_failure}})}e.expect=A;e.process()};l.handleServerHelloDone=function(e,t,r){if(r>0){return e.error(e,{message:"Invalid ServerHelloDone message. Invalid length.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.record_overflow}})}if(e.serverCertificate===null){var n={message:"No server certificate provided. Not enough security.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.insufficient_security}};var a=0;var s=e.verify(e,n.alert.description,a,[]);if(s!==true){if(s||s===0){if(typeof s==="object"&&!i.util.isArray(s)){if(s.message){n.message=s.message}if(s.alert){n.alert.description=s.alert}}else if(typeof s==="number"){n.alert.description=s}}return e.error(e,n)}}if(e.session.certificateRequest!==null){t=l.createRecord(e,{type:l.ContentType.handshake,data:l.createCertificate(e)});l.queue(e,t)}t=l.createRecord(e,{type:l.ContentType.handshake,data:l.createClientKeyExchange(e)});l.queue(e,t);e.expect=E;var o=function(e,t){if(e.session.certificateRequest!==null&&e.session.clientCertificate!==null){l.queue(e,l.createRecord(e,{type:l.ContentType.handshake,data:l.createCertificateVerify(e,t)}))}l.queue(e,l.createRecord(e,{type:l.ContentType.change_cipher_spec,data:l.createChangeCipherSpec()}));e.state.pending=l.createConnectionState(e);e.state.current.write=e.state.pending.write;l.queue(e,l.createRecord(e,{type:l.ContentType.handshake,data:l.createFinished(e)}));e.expect=v;l.flush(e);e.process()};if(e.session.certificateRequest===null||e.session.clientCertificate===null){return o(e,null)}l.getClientSignature(e,o)};l.handleChangeCipherSpec=function(e,t){if(t.fragment.getByte()!==1){return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.illegal_parameter}})}var r=e.entity===l.ConnectionEnd.client;if(e.session.resuming&&r||!e.session.resuming&&!r){e.state.pending=l.createConnectionState(e)}e.state.current.read=e.state.pending.read;if(!e.session.resuming&&r||e.session.resuming&&!r){e.state.pending=null}e.expect=r?m:_;e.process()};l.handleFinished=function(e,t,r){var a=t.fragment;a.read-=4;var s=a.bytes();a.read+=4;var o=t.fragment.getBytes();a=i.util.createBuffer();a.putBuffer(e.session.md5.digest());a.putBuffer(e.session.sha1.digest());var u=e.entity===l.ConnectionEnd.client;var f=u?"server finished":"client finished";var c=e.session.sp;var h=12;var p=n;a=p(c.master_secret,f,a.getBytes(),h);if(a.getBytes()!==o){return e.error(e,{message:"Invalid verify_data in Finished message.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.decrypt_error}})}e.session.md5.update(s);e.session.sha1.update(s);if(e.session.resuming&&u||!e.session.resuming&&!u){l.queue(e,l.createRecord(e,{type:l.ContentType.change_cipher_spec,data:l.createChangeCipherSpec()}));e.state.current.write=e.state.pending.write;e.state.pending=null;l.queue(e,l.createRecord(e,{type:l.ContentType.handshake,data:l.createFinished(e)}))}e.expect=u?C:b;e.handshaking=false;++e.handshakes;e.peerCertificate=u?e.session.serverCertificate:e.session.clientCertificate;l.flush(e);e.isConnected=true;e.connected(e);e.process()};l.handleAlert=function(e,t){var r=t.fragment;var i={level:r.getByte(),description:r.getByte()};var n;switch(i.description){case l.Alert.Description.close_notify:n="Connection closed.";break;case l.Alert.Description.unexpected_message:n="Unexpected message.";break;case l.Alert.Description.bad_record_mac:n="Bad record MAC.";break;case l.Alert.Description.decryption_failed:n="Decryption failed.";break;case l.Alert.Description.record_overflow:n="Record overflow.";break;case l.Alert.Description.decompression_failure:n="Decompression failed.";break;case l.Alert.Description.handshake_failure:n="Handshake failure.";break;case l.Alert.Description.bad_certificate:n="Bad certificate.";break;case l.Alert.Description.unsupported_certificate:n="Unsupported certificate.";break;case l.Alert.Description.certificate_revoked:n="Certificate revoked.";break;case l.Alert.Description.certificate_expired:n="Certificate expired.";break;case l.Alert.Description.certificate_unknown:n="Certificate unknown.";break;case l.Alert.Description.illegal_parameter:n="Illegal parameter.";break;case l.Alert.Description.unknown_ca:n="Unknown certificate authority.";break;case l.Alert.Description.access_denied:n="Access denied.";break;case l.Alert.Description.decode_error:n="Decode error.";break;case l.Alert.Description.decrypt_error:n="Decrypt error.";break;case l.Alert.Description.export_restriction:n="Export restriction.";break;case l.Alert.Description.protocol_version:n="Unsupported protocol version.";break;case l.Alert.Description.insufficient_security:n="Insufficient security.";break;case l.Alert.Description.internal_error:n="Internal error.";break;case l.Alert.Description.user_canceled:n="User canceled.";break;case l.Alert.Description.no_renegotiation:n="Renegotiation not supported.";break;default:n="Unknown error.";break}if(i.description===l.Alert.Description.close_notify){return e.close()}e.error(e,{message:n,send:false,origin:e.entity===l.ConnectionEnd.client?"server":"client",alert:i});e.process()};l.handleHandshake=function(e,t){var r=t.fragment;var n=r.getByte();var a=r.getInt24();if(a>r.length()){e.fragmented=t;t.fragment=i.util.createBuffer();r.read-=4;return e.process()}e.fragmented=null;r.read-=4;var s=r.bytes(a+4);r.read+=4;if(n in G[e.entity][e.expect]){if(e.entity===l.ConnectionEnd.server&&!e.open&&!e.fail){e.handshaking=true;e.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:i.md.md5.create(),sha1:i.md.sha1.create()}}if(n!==l.HandshakeType.hello_request&&n!==l.HandshakeType.certificate_verify&&n!==l.HandshakeType.finished){e.session.md5.update(s);e.session.sha1.update(s)}G[e.entity][e.expect][n](e,t,a)}else{l.handleUnexpected(e,t)}};l.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment);e.dataReady(e);e.process()};l.handleHeartbeat=function(e,t){var r=t.fragment;var n=r.getByte();var a=r.getInt16();var s=r.getBytes(a);if(n===l.HeartbeatMessageType.heartbeat_request){if(e.handshaking||a>s.length){return e.process()}l.queue(e,l.createRecord(e,{type:l.ContentType.heartbeat,data:l.createHeartbeat(l.HeartbeatMessageType.heartbeat_response,s)}));l.flush(e)}else if(n===l.HeartbeatMessageType.heartbeat_response){if(s!==e.expectedHeartbeatPayload){return e.process()}if(e.heartbeatReceived){e.heartbeatReceived(e,i.util.createBuffer(s))}}e.process()};var h=0;var p=1;var d=2;var y=3;var g=4;var v=5;var m=6;var C=7;var E=8;var S=0;var T=1;var I=2;var B=3;var A=4;var _=5;var b=6;var N=7;var w=l.handleUnexpected;var R=l.handleChangeCipherSpec;var L=l.handleAlert;var U=l.handleHandshake;var D=l.handleApplicationData;var k=l.handleHeartbeat;var P=[];P[l.ConnectionEnd.client]=[[w,L,U,w,k],[w,L,U,w,k],[w,L,U,w,k],[w,L,U,w,k],[w,L,U,w,k],[R,L,w,w,k],[w,L,U,w,k],[w,L,U,D,k],[w,L,U,w,k]];P[l.ConnectionEnd.server]=[[w,L,U,w,k],[w,L,U,w,k],[w,L,U,w,k],[w,L,U,w,k],[R,L,w,w,k],[w,L,U,w,k],[w,L,U,D,k],[w,L,U,w,k]];var V=l.handleHelloRequest;var O=l.handleServerHello;var M=l.handleCertificate;var K=l.handleServerKeyExchange;var x=l.handleCertificateRequest;var F=l.handleServerHelloDone;var q=l.handleFinished;var G=[];G[l.ConnectionEnd.client]=[[w,w,O,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w],[V,w,w,w,w,w,w,w,w,w,w,M,K,x,F,w,w,w,w,w,w],[V,w,w,w,w,w,w,w,w,w,w,w,K,x,F,w,w,w,w,w,w],[V,w,w,w,w,w,w,w,w,w,w,w,w,x,F,w,w,w,w,w,w],[V,w,w,w,w,w,w,w,w,w,w,w,w,w,F,w,w,w,w,w,w],[V,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w],[V,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,q],[V,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w],[V,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w]];var H=l.handleClientHello;var Q=l.handleClientKeyExchange;var z=l.handleCertificateVerify;G[l.ConnectionEnd.server]=[[w,H,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w],[w,w,w,w,w,w,w,w,w,w,w,M,w,w,w,w,w,w,w,w,w],[w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,Q,w,w,w,w],[w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,z,w,w,w,w,w],[w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w],[w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,q],[w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w],[w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w]];l.generateKeys=function(e,t){var r=n;var i=t.client_random+t.server_random;if(!e.session.resuming){t.master_secret=r(t.pre_master_secret,"master secret",i,48).bytes();t.pre_master_secret=null}i=t.server_random+t.client_random;var a=2*t.mac_key_length+2*t.enc_key_length;var s=e.version.major===l.Versions.TLS_1_0.major&&e.version.minor===l.Versions.TLS_1_0.minor;if(s){a+=2*t.fixed_iv_length}var o=r(t.master_secret,"key expansion",i,a);var u={client_write_MAC_key:o.getBytes(t.mac_key_length),server_write_MAC_key:o.getBytes(t.mac_key_length),client_write_key:o.getBytes(t.enc_key_length),server_write_key:o.getBytes(t.enc_key_length)};if(s){u.client_write_IV=o.getBytes(t.fixed_iv_length);u.server_write_IV=o.getBytes(t.fixed_iv_length)}return u};l.createConnectionState=function(e){var t=e.entity===l.ConnectionEnd.client;var r=function(){var e={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(e){return true},compressionState:null,compressFunction:function(e){return true},updateSequenceNumber:function(){if(e.sequenceNumber[1]===4294967295){e.sequenceNumber[1]=0;++e.sequenceNumber[0]}else{++e.sequenceNumber[1]}}};return e};var i={read:r(),write:r()};i.read.update=function(e,t){if(!i.read.cipherFunction(t,i.read)){e.error(e,{message:"Could not decrypt record or bad MAC.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.bad_record_mac}})}else if(!i.read.compressFunction(e,t,i.read)){e.error(e,{message:"Could not decompress record.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.decompression_failure}})}return!e.fail};i.write.update=function(e,t){if(!i.write.compressFunction(e,t,i.write)){e.error(e,{message:"Could not compress record.",send:false,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.internal_error}})}else if(!i.write.cipherFunction(t,i.write)){e.error(e,{message:"Could not encrypt record.",send:false,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.internal_error}})}return!e.fail};if(e.session){var n=e.session.sp;e.session.cipherSuite.initSecurityParameters(n);n.keys=l.generateKeys(e,n);i.read.macKey=t?n.keys.server_write_MAC_key:n.keys.client_write_MAC_key;i.write.macKey=t?n.keys.client_write_MAC_key:n.keys.server_write_MAC_key;e.session.cipherSuite.initConnectionState(i,e,n);switch(n.compression_algorithm){case l.CompressionMethod.none:break;case l.CompressionMethod.deflate:i.read.compressFunction=u;i.write.compressFunction=o;break;default:throw new Error("Unsupported compression algorithm.")}}return i};l.createRandom=function(){var e=new Date;var t=+e+e.getTimezoneOffset()*6e4;var r=i.util.createBuffer();r.putInt32(t);r.putBytes(i.random.getBytes(28));return r};l.createRecord=function(e,t){if(!t.data){return null}var r={type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data};return r};l.createAlert=function(e,t){var r=i.util.createBuffer();r.putByte(t.level);r.putByte(t.description);return l.createRecord(e,{type:l.ContentType.alert,data:r})};l.createClientHello=function(e){e.session.clientHelloVersion={major:e.version.major,minor:e.version.minor};var t=i.util.createBuffer();for(var r=0;r<e.cipherSuites.length;++r){var n=e.cipherSuites[r];t.putByte(n.id[0]);t.putByte(n.id[1])}var a=t.length();var s=i.util.createBuffer();s.putByte(l.CompressionMethod.none);var o=s.length();var u=i.util.createBuffer();if(e.virtualHost){var f=i.util.createBuffer();f.putByte(0);f.putByte(0);var h=i.util.createBuffer();h.putByte(0);c(h,2,i.util.createBuffer(e.virtualHost));var p=i.util.createBuffer();c(p,2,h);c(f,2,p);u.putBuffer(f)}var d=u.length();if(d>0){d+=2}var y=e.session.id;var g=y.length+1+2+4+28+2+a+1+o+d;var v=i.util.createBuffer();v.putByte(l.HandshakeType.client_hello);v.putInt24(g);v.putByte(e.version.major);v.putByte(e.version.minor);v.putBytes(e.session.sp.client_random);c(v,1,i.util.createBuffer(y));c(v,2,t);c(v,1,s);if(d>0){c(v,2,u)}return v};l.createServerHello=function(e){var t=e.session.id;var r=t.length+1+2+4+28+2+1;var n=i.util.createBuffer();n.putByte(l.HandshakeType.server_hello);n.putInt24(r);n.putByte(e.version.major);n.putByte(e.version.minor);n.putBytes(e.session.sp.server_random);c(n,1,i.util.createBuffer(t));n.putByte(e.session.cipherSuite.id[0]);n.putByte(e.session.cipherSuite.id[1]);n.putByte(e.session.compressionMethod);return n};l.createCertificate=function(e){var t=e.entity===l.ConnectionEnd.client;var r=null;if(e.getCertificate){var n;if(t){n=e.session.certificateRequest}else{n=e.session.extensions.server_name.serverNameList}r=e.getCertificate(e,n)}var a=i.util.createBuffer();if(r!==null){try{if(!i.util.isArray(r)){r=[r]}var s=null;for(var o=0;o<r.length;++o){var u=i.pem.decode(r[o])[0];if(u.type!=="CERTIFICATE"&&u.type!=="X509 CERTIFICATE"&&u.type!=="TRUSTED CERTIFICATE"){var f=new Error("Could not convert certificate from PEM; PEM "+'header type is not "CERTIFICATE", "X509 CERTIFICATE", or '+'"TRUSTED CERTIFICATE".');f.headerType=u.type;throw f}if(u.procType&&u.procType.type==="ENCRYPTED"){throw new Error("Could not convert certificate from PEM; PEM is encrypted.")}var h=i.util.createBuffer(u.body);if(s===null){s=i.asn1.fromDer(h.bytes(),false)}var p=i.util.createBuffer();c(p,3,h);a.putBuffer(p)}r=i.pki.certificateFromAsn1(s);if(t){e.session.clientCertificate=r}else{e.session.serverCertificate=r}}catch(t){return e.error(e,{message:"Could not send certificate list.",cause:t,send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.bad_certificate}})}}var d=3+a.length();var y=i.util.createBuffer();y.putByte(l.HandshakeType.certificate);y.putInt24(d);c(y,3,a);return y};l.createClientKeyExchange=function(e){var t=i.util.createBuffer();t.putByte(e.session.clientHelloVersion.major);t.putByte(e.session.clientHelloVersion.minor);t.putBytes(i.random.getBytes(46));var r=e.session.sp;r.pre_master_secret=t.getBytes();var n=e.session.serverCertificate.publicKey;t=n.encrypt(r.pre_master_secret);var a=t.length+2;var s=i.util.createBuffer();s.putByte(l.HandshakeType.client_key_exchange);s.putInt24(a);s.putInt16(t.length);s.putBytes(t);return s};l.createServerKeyExchange=function(e){var t=0;var r=i.util.createBuffer();if(t>0){r.putByte(l.HandshakeType.server_key_exchange);r.putInt24(t)}return r};l.getClientSignature=function(e,t){var r=i.util.createBuffer();r.putBuffer(e.session.md5.digest());r.putBuffer(e.session.sha1.digest());r=r.getBytes();e.getSignature=e.getSignature||function(e,t,r){var n=null;if(e.getPrivateKey){try{n=e.getPrivateKey(e,e.session.clientCertificate);n=i.pki.privateKeyFromPem(n)}catch(t){e.error(e,{message:"Could not get private key.",cause:t,send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.internal_error}})}}if(n===null){e.error(e,{message:"No private key set.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.internal_error}})}else{t=n.sign(t,null)}r(e,t)};e.getSignature(e,r,t)};l.createCertificateVerify=function(e,t){var r=t.length+2;var n=i.util.createBuffer();n.putByte(l.HandshakeType.certificate_verify);n.putInt24(r);n.putInt16(t.length);n.putBytes(t);return n};l.createCertificateRequest=function(e){var t=i.util.createBuffer();t.putByte(1);var r=i.util.createBuffer();for(var n in e.caStore.certs){var a=e.caStore.certs[n];var s=i.pki.distinguishedNameToAsn1(a.subject);var o=i.asn1.toDer(s);r.putInt16(o.length());r.putBuffer(o)}var u=1+t.length()+2+r.length();var f=i.util.createBuffer();f.putByte(l.HandshakeType.certificate_request);f.putInt24(u);c(f,1,t);c(f,2,r);return f};l.createServerHelloDone=function(e){var t=i.util.createBuffer();t.putByte(l.HandshakeType.server_hello_done);t.putInt24(0);return t};l.createChangeCipherSpec=function(){var e=i.util.createBuffer();e.putByte(1);return e};l.createFinished=function(e){var t=i.util.createBuffer();t.putBuffer(e.session.md5.digest());t.putBuffer(e.session.sha1.digest());var r=e.entity===l.ConnectionEnd.client;var a=e.session.sp;var s=12;var o=n;var u=r?"client finished":"server finished";t=o(a.master_secret,u,t.getBytes(),s);var f=i.util.createBuffer();f.putByte(l.HandshakeType.finished);f.putInt24(t.length());f.putBuffer(t);return f};l.createHeartbeat=function(e,t,r){if(typeof r==="undefined"){r=t.length}var n=i.util.createBuffer();n.putByte(e);n.putInt16(r);n.putBytes(t);var a=n.length();var s=Math.max(16,a-r-3);n.putBytes(i.random.getBytes(s));return n};l.queue=function(e,t){if(!t){return}if(t.fragment.length()===0){if(t.type===l.ContentType.handshake||t.type===l.ContentType.alert||t.type===l.ContentType.change_cipher_spec){return}}if(t.type===l.ContentType.handshake){var r=t.fragment.bytes();e.session.md5.update(r);e.session.sha1.update(r);r=null}var n;if(t.fragment.length()<=l.MaxFragment){n=[t]}else{n=[];var a=t.fragment.bytes();while(a.length>l.MaxFragment){n.push(l.createRecord(e,{type:t.type,data:i.util.createBuffer(a.slice(0,l.MaxFragment))}));a=a.slice(l.MaxFragment)}if(a.length>0){n.push(l.createRecord(e,{type:t.type,data:i.util.createBuffer(a)}))}}for(var s=0;s<n.length&&!e.fail;++s){var o=n[s];var u=e.state.current.write;if(u.update(e,o)){e.records.push(o)}}};l.flush=function(e){for(var t=0;t<e.records.length;++t){var r=e.records[t];e.tlsData.putByte(r.type);e.tlsData.putByte(r.version.major);e.tlsData.putByte(r.version.minor);e.tlsData.putInt16(r.fragment.length());e.tlsData.putBuffer(e.records[t].fragment)}e.records=[];return e.tlsDataReady(e)};var W=function(e){switch(e){case true:return true;case i.pki.certificateError.bad_certificate:return l.Alert.Description.bad_certificate;case i.pki.certificateError.unsupported_certificate:return l.Alert.Description.unsupported_certificate;case i.pki.certificateError.certificate_revoked:return l.Alert.Description.certificate_revoked;case i.pki.certificateError.certificate_expired:return l.Alert.Description.certificate_expired;case i.pki.certificateError.certificate_unknown:return l.Alert.Description.certificate_unknown;case i.pki.certificateError.unknown_ca:return l.Alert.Description.unknown_ca;default:return l.Alert.Description.bad_certificate}};var X=function(e){switch(e){case true:return true;case l.Alert.Description.bad_certificate:return i.pki.certificateError.bad_certificate;case l.Alert.Description.unsupported_certificate:return i.pki.certificateError.unsupported_certificate;case l.Alert.Description.certificate_revoked:return i.pki.certificateError.certificate_revoked;case l.Alert.Description.certificate_expired:return i.pki.certificateError.certificate_expired;case l.Alert.Description.certificate_unknown:return i.pki.certificateError.certificate_unknown;case l.Alert.Description.unknown_ca:return i.pki.certificateError.unknown_ca;default:return i.pki.certificateError.bad_certificate}};l.verifyCertificateChain=function(e,t){try{var r={};for(var n in e.verifyOptions){r[n]=e.verifyOptions[n]}r.verify=function(t,r,n){var a=W(t);var s=e.verify(e,t,r,n);if(s!==true){if(typeof s==="object"&&!i.util.isArray(s)){var o=new Error("The application rejected the certificate.");o.send=true;o.alert={level:l.Alert.Level.fatal,description:l.Alert.Description.bad_certificate};if(s.message){o.message=s.message}if(s.alert){o.alert.description=s.alert}throw o}if(s!==t){s=X(s)}}return s};i.pki.verifyCertificateChain(e.caStore,t,r)}catch(t){var a=t;if(typeof a!=="object"||i.util.isArray(a)){a={send:true,alert:{level:l.Alert.Level.fatal,description:W(t)}}}if(!("send"in a)){a.send=true}if(!("alert"in a)){a.alert={level:l.Alert.Level.fatal,description:W(a.error)}}e.error(e,a)}return!e.fail};l.createSessionCache=function(e,t){var r=null;if(e&&e.getSession&&e.setSession&&e.order){r=e}else{r={};r.cache=e||{};r.capacity=Math.max(t||100,1);r.order=[];for(var n in e){if(r.order.length<=t){r.order.push(n)}else{delete e[n]}}r.getSession=function(e){var t=null;var n=null;if(e){n=i.util.bytesToHex(e)}else if(r.order.length>0){n=r.order[0]}if(n!==null&&n in r.cache){t=r.cache[n];delete r.cache[n];for(var a in r.order){if(r.order[a]===n){r.order.splice(a,1);break}}}return t};r.setSession=function(e,t){if(r.order.length===r.capacity){var n=r.order.shift();delete r.cache[n]}var n=i.util.bytesToHex(e);r.order.push(n);r.cache[n]=t}}return r};l.createConnection=function(e){var t=null;if(e.caStore){if(i.util.isArray(e.caStore)){t=i.pki.createCaStore(e.caStore)}else{t=e.caStore}}else{t=i.pki.createCaStore()}var r=e.cipherSuites||null;if(r===null){r=[];for(var n in l.CipherSuites){r.push(l.CipherSuites[n])}}var a=e.server||false?l.ConnectionEnd.server:l.ConnectionEnd.client;var s=e.sessionCache?l.createSessionCache(e.sessionCache):null;var o={version:{major:l.Version.major,minor:l.Version.minor},entity:a,sessionId:e.sessionId,caStore:t,sessionCache:s,cipherSuites:r,connected:e.connected,virtualHost:e.virtualHost||null,verifyClient:e.verifyClient||false,verify:e.verify||function(e,t,r,i){return t},verifyOptions:e.verifyOptions||{},getCertificate:e.getCertificate||null,getPrivateKey:e.getPrivateKey||null,getSignature:e.getSignature||null,input:i.util.createBuffer(),tlsData:i.util.createBuffer(),data:i.util.createBuffer(),tlsDataReady:e.tlsDataReady,dataReady:e.dataReady,heartbeatReceived:e.heartbeatReceived,closed:e.closed,error:function(t,r){r.origin=r.origin||(t.entity===l.ConnectionEnd.client?"client":"server");if(r.send){l.queue(t,l.createAlert(t,r.alert));l.flush(t)}var i=r.fatal!==false;if(i){t.fail=true}e.error(t,r);if(i){t.close(false)}},deflate:e.deflate||null,inflate:e.inflate||null};o.reset=function(e){o.version={major:l.Version.major,minor:l.Version.minor};o.record=null;o.session=null;o.peerCertificate=null;o.state={pending:null,current:null};o.expect=o.entity===l.ConnectionEnd.client?h:S;o.fragmented=null;o.records=[];o.open=false;o.handshakes=0;o.handshaking=false;o.isConnected=false;o.fail=!(e||typeof e==="undefined");o.input.clear();o.tlsData.clear();o.data.clear();o.state.current=l.createConnectionState(o)};o.reset();var u=function(e,t){var r=t.type-l.ContentType.change_cipher_spec;var i=P[e.entity][e.expect];if(r in i){i[r](e,t)}else{l.handleUnexpected(e,t)}};var f=function(e){var t=0;var r=e.input;var n=r.length();if(n<5){t=5-n}else{e.record={type:r.getByte(),version:{major:r.getByte(),minor:r.getByte()},length:r.getInt16(),fragment:i.util.createBuffer(),ready:false};var a=e.record.version.major===e.version.major;if(a&&e.session&&e.session.version){a=e.record.version.minor===e.version.minor}if(!a){e.error(e,{message:"Incompatible TLS version.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.protocol_version}})}}return t};var c=function(e){var t=0;var r=e.input;var i=r.length();if(i<e.record.length){t=e.record.length-i}else{e.record.fragment.putBytes(r.getBytes(e.record.length));r.compact();var n=e.state.current.read;if(n.update(e,e.record)){if(e.fragmented!==null){if(e.fragmented.type===e.record.type){e.fragmented.fragment.putBuffer(e.record.fragment);e.record=e.fragmented}else{e.error(e,{message:"Invalid fragmented record.",send:true,alert:{level:l.Alert.Level.fatal,description:l.Alert.Description.unexpected_message}})}}e.record.ready=true}}return t};o.handshake=function(e){if(o.entity!==l.ConnectionEnd.client){o.error(o,{message:"Cannot initiate handshake as a server.",fatal:false})}else if(o.handshaking){o.error(o,{message:"Handshake already in progress.",fatal:false})}else{if(o.fail&&!o.open&&o.handshakes===0){o.fail=false}o.handshaking=true;e=e||"";var t=null;if(e.length>0){if(o.sessionCache){t=o.sessionCache.getSession(e)}if(t===null){e=""}}if(e.length===0&&o.sessionCache){t=o.sessionCache.getSession();if(t!==null){e=t.id}}o.session={id:e,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:i.md.md5.create(),sha1:i.md.sha1.create()};if(t){o.version=t.version;o.session.sp=t.sp}o.session.sp.client_random=l.createRandom().getBytes();o.open=true;l.queue(o,l.createRecord(o,{type:l.ContentType.handshake,data:l.createClientHello(o)}));l.flush(o)}};o.process=function(e){var t=0;if(e){o.input.putBytes(e)}if(!o.fail){if(o.record!==null&&o.record.ready&&o.record.fragment.isEmpty()){o.record=null}if(o.record===null){t=f(o)}if(!o.fail&&o.record!==null&&!o.record.ready){t=c(o)}if(!o.fail&&o.record!==null&&o.record.ready){u(o,o.record)}}return t};o.prepare=function(e){l.queue(o,l.createRecord(o,{type:l.ContentType.application_data,data:i.util.createBuffer(e)}));return l.flush(o)};o.prepareHeartbeatRequest=function(e,t){if(e instanceof i.util.ByteBuffer){e=e.bytes()}if(typeof t==="undefined"){t=e.length}o.expectedHeartbeatPayload=e;l.queue(o,l.createRecord(o,{type:l.ContentType.heartbeat,data:l.createHeartbeat(l.HeartbeatMessageType.heartbeat_request,e,t)}));return l.flush(o)};o.close=function(e){if(!o.fail&&o.sessionCache&&o.session){var t={id:o.session.id,version:o.session.version,sp:o.session.sp};t.sp.keys=null;o.sessionCache.setSession(t.id,t)}if(o.open){o.open=false;o.input.clear();if(o.isConnected||o.handshaking){o.isConnected=o.handshaking=false;l.queue(o,l.createAlert(o,{level:l.Alert.Level.warning,description:l.Alert.Description.close_notify}));l.flush(o)}o.closed(o)}o.reset(e)};return o};e.exports=i.tls=i.tls||{};for(var Y in l){if(typeof l[Y]!=="function"){i.tls[Y]=l[Y]}}i.tls.prf_tls1=n;i.tls.hmac_sha1=s;i.tls.createSessionCache=l.createSessionCache;i.tls.createConnection=l.createConnection},722:function(e,t,r){var i=r(936);e.exports=i.jsbn=i.jsbn||{};var n;var a=0xdeadbeefcafe;var s=(a&16777215)==15715070;function BigInteger(e,t,r){this.data=[];if(e!=null)if("number"==typeof e)this.fromNumber(e,t,r);else if(t==null&&"string"!=typeof e)this.fromString(e,256);else this.fromString(e,t)}i.jsbn.BigInteger=BigInteger;function nbi(){return new BigInteger(null)}function am1(e,t,r,i,n,a){while(--a>=0){var s=t*this.data[e++]+r.data[i]+n;n=Math.floor(s/67108864);r.data[i++]=s&67108863}return n}function am2(e,t,r,i,n,a){var s=t&32767,o=t>>15;while(--a>=0){var u=this.data[e]&32767;var f=this.data[e++]>>15;var c=o*u+f*s;u=s*u+((c&32767)<<15)+r.data[i]+(n&1073741823);n=(u>>>30)+(c>>>15)+o*f+(n>>>30);r.data[i++]=u&1073741823}return n}function am3(e,t,r,i,n,a){var s=t&16383,o=t>>14;while(--a>=0){var u=this.data[e]&16383;var f=this.data[e++]>>14;var c=o*u+f*s;u=s*u+((c&16383)<<14)+r.data[i]+n;n=(u>>28)+(c>>14)+o*f;r.data[i++]=u&268435455}return n}if(typeof navigator==="undefined"){BigInteger.prototype.am=am3;n=28}else if(s&&navigator.appName=="Microsoft Internet Explorer"){BigInteger.prototype.am=am2;n=30}else if(s&&navigator.appName!="Netscape"){BigInteger.prototype.am=am1;n=26}else{BigInteger.prototype.am=am3;n=28}BigInteger.prototype.DB=n;BigInteger.prototype.DM=(1<<n)-1;BigInteger.prototype.DV=1<<n;var o=52;BigInteger.prototype.FV=Math.pow(2,o);BigInteger.prototype.F1=o-n;BigInteger.prototype.F2=2*n-o;var u="0123456789abcdefghijklmnopqrstuvwxyz";var f=new Array;var c,l;c="0".charCodeAt(0);for(l=0;l<=9;++l)f[c++]=l;c="a".charCodeAt(0);for(l=10;l<36;++l)f[c++]=l;c="A".charCodeAt(0);for(l=10;l<36;++l)f[c++]=l;function int2char(e){return u.charAt(e)}function intAt(e,t){var r=f[e.charCodeAt(t)];return r==null?-1:r}function bnpCopyTo(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t;e.s=this.s}function bnpFromInt(e){this.t=1;this.s=e<0?-1:0;if(e>0)this.data[0]=e;else if(e<-1)this.data[0]=e+this.DV;else this.t=0}function nbv(e){var t=nbi();t.fromInt(e);return t}function bnpFromString(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0;this.s=0;var i=e.length,n=false,a=0;while(--i>=0){var s=r==8?e[i]&255:intAt(e,i);if(s<0){if(e.charAt(i)=="-")n=true;continue}n=false;if(a==0)this.data[this.t++]=s;else if(a+r>this.DB){this.data[this.t-1]|=(s&(1<<this.DB-a)-1)<<a;this.data[this.t++]=s>>this.DB-a}else this.data[this.t-1]|=s<<a;a+=r;if(a>=this.DB)a-=this.DB}if(r==8&&(e[0]&128)!=0){this.s=-1;if(a>0)this.data[this.t-1]|=(1<<this.DB-a)-1<<a}this.clamp();if(n)BigInteger.ZERO.subTo(this,this)}function bnpClamp(){var e=this.s&this.DM;while(this.t>0&&this.data[this.t-1]==e)--this.t}function bnToString(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,i,n=false,a="",s=this.t;var o=this.DB-s*this.DB%t;if(s-- >0){if(o<this.DB&&(i=this.data[s]>>o)>0){n=true;a=int2char(i)}while(s>=0){if(o<t){i=(this.data[s]&(1<<o)-1)<<t-o;i|=this.data[--s]>>(o+=this.DB-t)}else{i=this.data[s]>>(o-=t)&r;if(o<=0){o+=this.DB;--s}}if(i>0)n=true;if(n)a+=int2char(i)}}return n?a:"0"}function bnNegate(){var e=nbi();BigInteger.ZERO.subTo(this,e);return e}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;t=r-e.t;if(t!=0)return this.s<0?-t:t;while(--r>=0)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function nbits(e){var t=1,r;if((r=e>>>16)!=0){e=r;t+=16}if((r=e>>8)!=0){e=r;t+=8}if((r=e>>4)!=0){e=r;t+=4}if((r=e>>2)!=0){e=r;t+=2}if((r=e>>1)!=0){e=r;t+=1}return t}function bnBitLength(){if(this.t<=0)return 0;return this.DB*(this.t-1)+nbits(this.data[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e;t.s=this.s}function bnpDRShiftTo(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0);t.s=this.s}function bnpLShiftTo(e,t){var r=e%this.DB;var i=this.DB-r;var n=(1<<i)-1;var a=Math.floor(e/this.DB),s=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o){t.data[o+a+1]=this.data[o]>>i|s;s=(this.data[o]&n)<<r}for(o=a-1;o>=0;--o)t.data[o]=0;t.data[a]=s;t.t=this.t+a+1;t.s=this.s;t.clamp()}function bnpRShiftTo(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var i=e%this.DB;var n=this.DB-i;var a=(1<<i)-1;t.data[0]=this.data[r]>>i;for(var s=r+1;s<this.t;++s){t.data[s-r-1]|=(this.data[s]&a)<<n;t.data[s-r]=this.data[s]>>i}if(i>0)t.data[this.t-r-1]|=(this.s&a)<<n;t.t=this.t-r;t.clamp()}function bnpSubTo(e,t){var r=0,i=0,n=Math.min(e.t,this.t);while(r<n){i+=this.data[r]-e.data[r];t.data[r++]=i&this.DM;i>>=this.DB}if(e.t<this.t){i-=e.s;while(r<this.t){i+=this.data[r];t.data[r++]=i&this.DM;i>>=this.DB}i+=this.s}else{i+=this.s;while(r<e.t){i-=e.data[r];t.data[r++]=i&this.DM;i>>=this.DB}i-=e.s}t.s=i<0?-1:0;if(i<-1)t.data[r++]=this.DV+i;else if(i>0)t.data[r++]=i;t.t=r;t.clamp()}function bnpMultiplyTo(e,t){var r=this.abs(),i=e.abs();var n=r.t;t.t=n+i.t;while(--n>=0)t.data[n]=0;for(n=0;n<i.t;++n)t.data[n+r.t]=r.am(0,i.data[n],t,n,0,r.t);t.s=0;t.clamp();if(this.s!=e.s)BigInteger.ZERO.subTo(t,t)}function bnpSquareTo(e){var t=this.abs();var r=e.t=2*t.t;while(--r>=0)e.data[r]=0;for(r=0;r<t.t-1;++r){var i=t.am(r,t.data[r],e,2*r,0,1);if((e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,i,t.t-r-1))>=t.DV){e.data[r+t.t]-=t.DV;e.data[r+t.t+1]=1}}if(e.t>0)e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1);e.s=0;e.clamp()}function bnpDivRemTo(e,t,r){var i=e.abs();if(i.t<=0)return;var n=this.abs();if(n.t<i.t){if(t!=null)t.fromInt(0);if(r!=null)this.copyTo(r);return}if(r==null)r=nbi();var a=nbi(),s=this.s,o=e.s;var u=this.DB-nbits(i.data[i.t-1]);if(u>0){i.lShiftTo(u,a);n.lShiftTo(u,r)}else{i.copyTo(a);n.copyTo(r)}var f=a.t;var c=a.data[f-1];if(c==0)return;var l=c*(1<<this.F1)+(f>1?a.data[f-2]>>this.F2:0);var h=this.FV/l,p=(1<<this.F1)/l,d=1<<this.F2;var y=r.t,g=y-f,v=t==null?nbi():t;a.dlShiftTo(g,v);if(r.compareTo(v)>=0){r.data[r.t++]=1;r.subTo(v,r)}BigInteger.ONE.dlShiftTo(f,v);v.subTo(a,a);while(a.t<f)a.data[a.t++]=0;while(--g>=0){var m=r.data[--y]==c?this.DM:Math.floor(r.data[y]*h+(r.data[y-1]+d)*p);if((r.data[y]+=a.am(0,m,r,g,0,f))<m){a.dlShiftTo(g,v);r.subTo(v,r);while(r.data[y]<--m)r.subTo(v,r)}}if(t!=null){r.drShiftTo(f,t);if(s!=o)BigInteger.ZERO.subTo(t,t)}r.t=f;r.clamp();if(u>0)r.rShiftTo(u,r);if(s<0)BigInteger.ZERO.subTo(r,r)}function bnMod(e){var t=nbi();this.abs().divRemTo(e,null,t);if(this.s<0&&t.compareTo(BigInteger.ZERO)>0)e.subTo(t,t);return t}function Classic(e){this.m=e}function cConvert(e){if(e.s<0||e.compareTo(this.m)>=0)return e.mod(this.m);else return e}function cRevert(e){return e}function cReduce(e){e.divRemTo(this.m,null,e)}function cMulTo(e,t,r){e.multiplyTo(t,r);this.reduce(r)}function cSqrTo(e,t){e.squareTo(t);this.reduce(t)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1)return 0;var e=this.data[0];if((e&1)==0)return 0;var t=e&3;t=t*(2-(e&15)*t)&15;t=t*(2-(e&255)*t)&255;t=t*(2-((e&65535)*t&65535))&65535;t=t*(2-e*t%this.DV)%this.DV;return t>0?this.DV-t:-t}function Montgomery(e){this.m=e;this.mp=e.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<e.DB-15)-1;this.mt2=2*e.t}function montConvert(e){var t=nbi();e.abs().dlShiftTo(this.m.t,t);t.divRemTo(this.m,null,t);if(e.s<0&&t.compareTo(BigInteger.ZERO)>0)this.m.subTo(t,t);return t}function montRevert(e){var t=nbi();e.copyTo(t);this.reduce(t);return t}function montReduce(e){while(e.t<=this.mt2)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767;var i=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;r=t+this.m.t;e.data[r]+=this.m.am(0,i,e,t,0,this.m.t);while(e.data[r]>=e.DV){e.data[r]-=e.DV;e.data[++r]++}}e.clamp();e.drShiftTo(this.m.t,e);if(e.compareTo(this.m)>=0)e.subTo(this.m,e)}function montSqrTo(e,t){e.squareTo(t);this.reduce(t)}function montMulTo(e,t,r){e.multiplyTo(t,r);this.reduce(r)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return(this.t>0?this.data[0]&1:this.s)==0}function bnpExp(e,t){if(e>4294967295||e<1)return BigInteger.ONE;var r=nbi(),i=nbi(),n=t.convert(this),a=nbits(e)-1;n.copyTo(r);while(--a>=0){t.sqrTo(r,i);if((e&1<<a)>0)t.mulTo(i,n,r);else{var s=r;r=i;i=s}}return t.revert(r)}function bnModPowInt(e,t){var r;if(e<256||t.isEven())r=new Classic(t);else r=new Montgomery(t);return this.exp(e,r)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnClone(){var e=nbi();this.copyTo(e);return e}function bnIntValue(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;else if(this.t==0)return-1}else if(this.t==1)return this.data[0];else if(this.t==0)return 0;return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function bnByteValue(){return this.t==0?this.s:this.data[0]<<24>>24}function bnShortValue(){return this.t==0?this.s:this.data[0]<<16>>16}function bnpChunkSize(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function bnSigNum(){if(this.s<0)return-1;else if(this.t<=0||this.t==1&&this.data[0]<=0)return 0;else return 1}function bnpToRadix(e){if(e==null)e=10;if(this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e);var r=Math.pow(e,t);var i=nbv(r),n=nbi(),a=nbi(),s="";this.divRemTo(i,n,a);while(n.signum()>0){s=(r+a.intValue()).toString(e).substr(1)+s;n.divRemTo(i,n,a)}return a.intValue().toString(e)+s}function bnpFromRadix(e,t){this.fromInt(0);if(t==null)t=10;var r=this.chunkSize(t);var i=Math.pow(t,r),n=false,a=0,s=0;for(var o=0;o<e.length;++o){var u=intAt(e,o);if(u<0){if(e.charAt(o)=="-"&&this.signum()==0)n=true;continue}s=t*s+u;if(++a>=r){this.dMultiply(i);this.dAddOffset(s,0);a=0;s=0}}if(a>0){this.dMultiply(Math.pow(t,a));this.dAddOffset(s,0)}if(n)BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(e,t,r){if("number"==typeof t){if(e<2)this.fromInt(1);else{this.fromNumber(e,r);if(!this.testBit(e-1))this.bitwiseTo(BigInteger.ONE.shiftLeft(e-1),op_or,this);if(this.isEven())this.dAddOffset(1,0);while(!this.isProbablePrime(t)){this.dAddOffset(2,0);if(this.bitLength()>e)this.subTo(BigInteger.ONE.shiftLeft(e-1),this)}}}else{var i=new Array,n=e&7;i.length=(e>>3)+1;t.nextBytes(i);if(n>0)i[0]&=(1<<n)-1;else i[0]=0;this.fromString(i,256)}}function bnToByteArray(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,i,n=0;if(e-- >0){if(r<this.DB&&(i=this.data[e]>>r)!=(this.s&this.DM)>>r)t[n++]=i|this.s<<this.DB-r;while(e>=0){if(r<8){i=(this.data[e]&(1<<r)-1)<<8-r;i|=this.data[--e]>>(r+=this.DB-8)}else{i=this.data[e]>>(r-=8)&255;if(r<=0){r+=this.DB;--e}}if((i&128)!=0)i|=-256;if(n==0&&(this.s&128)!=(i&128))++n;if(n>0||i!=this.s)t[n++]=i}}return t}function bnEquals(e){return this.compareTo(e)==0}function bnMin(e){return this.compareTo(e)<0?this:e}function bnMax(e){return this.compareTo(e)>0?this:e}function bnpBitwiseTo(e,t,r){var i,n,a=Math.min(e.t,this.t);for(i=0;i<a;++i)r.data[i]=t(this.data[i],e.data[i]);if(e.t<this.t){n=e.s&this.DM;for(i=a;i<this.t;++i)r.data[i]=t(this.data[i],n);r.t=this.t}else{n=this.s&this.DM;for(i=a;i<e.t;++i)r.data[i]=t(n,e.data[i]);r.t=e.t}r.s=t(this.s,e.s);r.clamp()}function op_and(e,t){return e&t}function bnAnd(e){var t=nbi();this.bitwiseTo(e,op_and,t);return t}function op_or(e,t){return e|t}function bnOr(e){var t=nbi();this.bitwiseTo(e,op_or,t);return t}function op_xor(e,t){return e^t}function bnXor(e){var t=nbi();this.bitwiseTo(e,op_xor,t);return t}function op_andnot(e,t){return e&~t}function bnAndNot(e){var t=nbi();this.bitwiseTo(e,op_andnot,t);return t}function bnNot(){var e=nbi();for(var t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];e.t=this.t;e.s=~this.s;return e}function bnShiftLeft(e){var t=nbi();if(e<0)this.rShiftTo(-e,t);else this.lShiftTo(e,t);return t}function bnShiftRight(e){var t=nbi();if(e<0)this.lShiftTo(-e,t);else this.rShiftTo(e,t);return t}function lbit(e){if(e==0)return-1;var t=0;if((e&65535)==0){e>>=16;t+=16}if((e&255)==0){e>>=8;t+=8}if((e&15)==0){e>>=4;t+=4}if((e&3)==0){e>>=2;t+=2}if((e&1)==0)++t;return t}function bnGetLowestSetBit(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+lbit(this.data[e]);if(this.s<0)return this.t*this.DB;return-1}function cbit(e){var t=0;while(e!=0){e&=e-1;++t}return t}function bnBitCount(){var e=0,t=this.s&this.DM;for(var r=0;r<this.t;++r)e+=cbit(this.data[r]^t);return e}function bnTestBit(e){var t=Math.floor(e/this.DB);if(t>=this.t)return this.s!=0;return(this.data[t]&1<<e%this.DB)!=0}function bnpChangeBit(e,t){var r=BigInteger.ONE.shiftLeft(e);this.bitwiseTo(r,t,r);return r}function bnSetBit(e){return this.changeBit(e,op_or)}function bnClearBit(e){return this.changeBit(e,op_andnot)}function bnFlipBit(e){return this.changeBit(e,op_xor)}function bnpAddTo(e,t){var r=0,i=0,n=Math.min(e.t,this.t);while(r<n){i+=this.data[r]+e.data[r];t.data[r++]=i&this.DM;i>>=this.DB}if(e.t<this.t){i+=e.s;while(r<this.t){i+=this.data[r];t.data[r++]=i&this.DM;i>>=this.DB}i+=this.s}else{i+=this.s;while(r<e.t){i+=e.data[r];t.data[r++]=i&this.DM;i>>=this.DB}i+=e.s}t.s=i<0?-1:0;if(i>0)t.data[r++]=i;else if(i<-1)t.data[r++]=this.DV+i;t.t=r;t.clamp()}function bnAdd(e){var t=nbi();this.addTo(e,t);return t}function bnSubtract(e){var t=nbi();this.subTo(e,t);return t}function bnMultiply(e){var t=nbi();this.multiplyTo(e,t);return t}function bnDivide(e){var t=nbi();this.divRemTo(e,t,null);return t}function bnRemainder(e){var t=nbi();this.divRemTo(e,null,t);return t}function bnDivideAndRemainder(e){var t=nbi(),r=nbi();this.divRemTo(e,t,r);return new Array(t,r)}function bnpDMultiply(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(e,t){if(e==0)return;while(this.t<=t)this.data[this.t++]=0;this.data[t]+=e;while(this.data[t]>=this.DV){this.data[t]-=this.DV;if(++t>=this.t)this.data[this.t++]=0;++this.data[t]}}function NullExp(){}function nNop(e){return e}function nMulTo(e,t,r){e.multiplyTo(t,r)}function nSqrTo(e,t){e.squareTo(t)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(e){return this.exp(e,new NullExp)}function bnpMultiplyLowerTo(e,t,r){var i=Math.min(this.t+e.t,t);r.s=0;r.t=i;while(i>0)r.data[--i]=0;var n;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,e.data[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e.data[i],r,i,0,t-i);r.clamp()}function bnpMultiplyUpperTo(e,t,r){--t;var i=r.t=this.t+e.t-t;r.s=0;while(--i>=0)r.data[i]=0;for(i=Math.max(t-this.t,0);i<e.t;++i)r.data[this.t+i-t]=this.am(t-i,e.data[i],r,0,0,this.t+i-t);r.clamp();r.drShiftTo(1,r)}function Barrett(e){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*e.t,this.r2);this.mu=this.r2.divide(e);this.m=e}function barrettConvert(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);else if(e.compareTo(this.m)<0)return e;else{var t=nbi();e.copyTo(t);this.reduce(t);return t}}function barrettRevert(e){return e}function barrettReduce(e){e.drShiftTo(this.m.t-1,this.r2);if(e.t>this.m.t+1){e.t=this.m.t+1;e.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(e.compareTo(this.r2)<0)e.dAddOffset(1,this.m.t+1);e.subTo(this.r2,e);while(e.compareTo(this.m)>=0)e.subTo(this.m,e)}function barrettSqrTo(e,t){e.squareTo(t);this.reduce(t)}function barrettMulTo(e,t,r){e.multiplyTo(t,r);this.reduce(r)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(e,t){var r=e.bitLength(),i,n=nbv(1),a;if(r<=0)return n;else if(r<18)i=1;else if(r<48)i=3;else if(r<144)i=4;else if(r<768)i=5;else i=6;if(r<8)a=new Classic(t);else if(t.isEven())a=new Barrett(t);else a=new Montgomery(t);var s=new Array,o=3,u=i-1,f=(1<<i)-1;s[1]=a.convert(this);if(i>1){var c=nbi();a.sqrTo(s[1],c);while(o<=f){s[o]=nbi();a.mulTo(c,s[o-2],s[o]);o+=2}}var l=e.t-1,h,p=true,d=nbi(),y;r=nbits(e.data[l])-1;while(l>=0){if(r>=u)h=e.data[l]>>r-u&f;else{h=(e.data[l]&(1<<r+1)-1)<<u-r;if(l>0)h|=e.data[l-1]>>this.DB+r-u}o=i;while((h&1)==0){h>>=1;--o}if((r-=o)<0){r+=this.DB;--l}if(p){s[h].copyTo(n);p=false}else{while(o>1){a.sqrTo(n,d);a.sqrTo(d,n);o-=2}if(o>0)a.sqrTo(n,d);else{y=n;n=d;d=y}a.mulTo(d,s[h],n)}while(l>=0&&(e.data[l]&1<<r)==0){a.sqrTo(n,d);y=n;n=d;d=y;if(--r<0){r=this.DB-1;--l}}}return a.revert(n)}function bnGCD(e){var t=this.s<0?this.negate():this.clone();var r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var i=t;t=r;r=i}var n=t.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return t;if(n<a)a=n;if(a>0){t.rShiftTo(a,t);r.rShiftTo(a,r)}while(t.signum()>0){if((n=t.getLowestSetBit())>0)t.rShiftTo(n,t);if((n=r.getLowestSetBit())>0)r.rShiftTo(n,r);if(t.compareTo(r)>=0){t.subTo(r,t);t.rShiftTo(1,t)}else{r.subTo(t,r);r.rShiftTo(1,r)}}if(a>0)r.lShiftTo(a,r);return r}function bnpModInt(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var i=this.t-1;i>=0;--i)r=(t*r+this.data[i])%e;return r}function bnModInverse(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return BigInteger.ZERO;var r=e.clone(),i=this.clone();var n=nbv(1),a=nbv(0),s=nbv(0),o=nbv(1);while(r.signum()!=0){while(r.isEven()){r.rShiftTo(1,r);if(t){if(!n.isEven()||!a.isEven()){n.addTo(this,n);a.subTo(e,a)}n.rShiftTo(1,n)}else if(!a.isEven())a.subTo(e,a);a.rShiftTo(1,a)}while(i.isEven()){i.rShiftTo(1,i);if(t){if(!s.isEven()||!o.isEven()){s.addTo(this,s);o.subTo(e,o)}s.rShiftTo(1,s)}else if(!o.isEven())o.subTo(e,o);o.rShiftTo(1,o)}if(r.compareTo(i)>=0){r.subTo(i,r);if(t)n.subTo(s,n);a.subTo(o,a)}else{i.subTo(r,i);if(t)s.subTo(n,s);o.subTo(a,o)}}if(i.compareTo(BigInteger.ONE)!=0)return BigInteger.ZERO;if(o.compareTo(e)>=0)return o.subtract(e);if(o.signum()<0)o.addTo(e,o);else return o;if(o.signum()<0)return o.add(e);else return o}var h=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];var p=(1<<26)/h[h.length-1];function bnIsProbablePrime(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=h[h.length-1]){for(t=0;t<h.length;++t)if(r.data[0]==h[t])return true;return false}if(r.isEven())return false;t=1;while(t<h.length){var i=h[t],n=t+1;while(n<h.length&&i<p)i*=h[n++];i=r.modInt(i);while(t<n)if(i%h[t++]==0)return false}return r.millerRabin(e)}function bnpMillerRabin(e){var t=this.subtract(BigInteger.ONE);var r=t.getLowestSetBit();if(r<=0)return false;var i=t.shiftRight(r);var n=bnGetPrng();var a;for(var s=0;s<e;++s){do{a=new BigInteger(this.bitLength(),n)}while(a.compareTo(BigInteger.ONE)<=0||a.compareTo(t)>=0);var o=a.modPow(i,this);if(o.compareTo(BigInteger.ONE)!=0&&o.compareTo(t)!=0){var u=1;while(u++<r&&o.compareTo(t)!=0){o=o.modPowInt(2,this);if(o.compareTo(BigInteger.ONE)==0)return false}if(o.compareTo(t)!=0)return false}}return true}function bnGetPrng(){return{nextBytes:function(e){for(var t=0;t<e.length;++t){e[t]=Math.floor(Math.random()*256)}}}}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime},747:function(e){e.exports=require("fs")},749:function(e){var t={};e.exports=t;var r={};t.encode=function(e,t,r){if(typeof t!=="string"){throw new TypeError('"alphabet" must be a string.')}if(r!==undefined&&typeof r!=="number"){throw new TypeError('"maxline" must be a number.')}var i="";if(!(e instanceof Uint8Array)){i=_encodeWithByteBuffer(e,t)}else{var n=0;var a=t.length;var s=t.charAt(0);var o=[0];for(n=0;n<e.length;++n){for(var u=0,f=e[n];u<o.length;++u){f+=o[u]<<8;o[u]=f%a;f=f/a|0}while(f>0){o.push(f%a);f=f/a|0}}for(n=0;e[n]===0&&n<e.length-1;++n){i+=s}for(n=o.length-1;n>=0;--n){i+=t[o[n]]}}if(r){var c=new RegExp(".{1,"+r+"}","g");i=i.match(c).join("\r\n")}return i};t.decode=function(e,t){if(typeof e!=="string"){throw new TypeError('"input" must be a string.')}if(typeof t!=="string"){throw new TypeError('"alphabet" must be a string.')}var i=r[t];if(!i){i=r[t]=[];for(var n=0;n<t.length;++n){i[t.charCodeAt(n)]=n}}e=e.replace(/\s/g,"");var a=t.length;var s=t.charAt(0);var o=[0];for(var n=0;n<e.length;n++){var u=i[e.charCodeAt(n)];if(u===undefined){return}for(var f=0,c=u;f<o.length;++f){c+=o[f]*a;o[f]=c&255;c>>=8}while(c>0){o.push(c&255);c>>=8}}for(var l=0;e[l]===s&&l<e.length-1;++l){o.push(0)}if(typeof Buffer!=="undefined"){return Buffer.from(o.reverse())}return new Uint8Array(o.reverse())};function _encodeWithByteBuffer(e,t){var r=0;var i=t.length;var n=t.charAt(0);var a=[0];for(r=0;r<e.length();++r){for(var s=0,o=e.at(r);s<a.length;++s){o+=a[s]<<8;a[s]=o%i;o=o/i|0}while(o>0){a.push(o%i);o=o/i|0}}var u="";for(r=0;e.at(r)===0&&r<e.length()-1;++r){u+=n}for(r=a.length-1;r>=0;--r){u+=t[a[r]]}return u}},783:function(e,t,r){var i=r(936);r(607);r(621);var n=e.exports=i.sha512=i.sha512||{};i.md.sha512=i.md.algorithms.sha512=n;var a=i.sha384=i.sha512.sha384=i.sha512.sha384||{};a.create=function(){return n.create("SHA-384")};i.md.sha384=i.md.algorithms.sha384=a;i.sha512.sha256=i.sha512.sha256||{create:function(){return n.create("SHA-512/256")}};i.md["sha512/256"]=i.md.algorithms["sha512/256"]=i.sha512.sha256;i.sha512.sha224=i.sha512.sha224||{create:function(){return n.create("SHA-512/224")}};i.md["sha512/224"]=i.md.algorithms["sha512/224"]=i.sha512.sha224;n.create=function(e){if(!o){_init()}if(typeof e==="undefined"){e="SHA-512"}if(!(e in f)){throw new Error("Invalid SHA-512 algorithm: "+e)}var t=f[e];var r=null;var n=i.util.createBuffer();var a=new Array(80);for(var u=0;u<80;++u){a[u]=new Array(2)}var c=64;switch(e){case"SHA-384":c=48;break;case"SHA-512/256":c=32;break;case"SHA-512/224":c=28;break}var l={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:c,messageLength:0,fullMessageLength:null,messageLengthSize:16};l.start=function(){l.messageLength=0;l.fullMessageLength=l.messageLength128=[];var e=l.messageLengthSize/4;for(var a=0;a<e;++a){l.fullMessageLength.push(0)}n=i.util.createBuffer();r=new Array(t.length);for(var a=0;a<t.length;++a){r[a]=t[a].slice(0)}return l};l.start();l.update=function(e,t){if(t==="utf8"){e=i.util.encodeUtf8(e)}var s=e.length;l.messageLength+=s;s=[s/4294967296>>>0,s>>>0];for(var o=l.fullMessageLength.length-1;o>=0;--o){l.fullMessageLength[o]+=s[1];s[1]=s[0]+(l.fullMessageLength[o]/4294967296>>>0);l.fullMessageLength[o]=l.fullMessageLength[o]>>>0;s[0]=s[1]/4294967296>>>0}n.putBytes(e);_update(r,a,n);if(n.read>2048||n.length()===0){n.compact()}return l};l.digest=function(){var t=i.util.createBuffer();t.putBytes(n.bytes());var o=l.fullMessageLength[l.fullMessageLength.length-1]+l.messageLengthSize;var u=o&l.blockLength-1;t.putBytes(s.substr(0,l.blockLength-u));var f,c;var h=l.fullMessageLength[0]*8;for(var p=0;p<l.fullMessageLength.length-1;++p){f=l.fullMessageLength[p+1]*8;c=f/4294967296>>>0;h+=c;t.putInt32(h>>>0);h=f>>>0}t.putInt32(h);var d=new Array(r.length);for(var p=0;p<r.length;++p){d[p]=r[p].slice(0)}_update(d,a,t);var y=i.util.createBuffer();var g;if(e==="SHA-512"){g=d.length}else if(e==="SHA-384"){g=d.length-2}else{g=d.length-4}for(var p=0;p<g;++p){y.putInt32(d[p][0]);if(p!==g-1||e!=="SHA-512/224"){y.putInt32(d[p][1])}}return y};return l};var s=null;var o=false;var u=null;var f=null;function _init(){s=String.fromCharCode(128);s+=i.util.fillString(String.fromCharCode(0),128);u=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]];f={};f["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]];f["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]];f["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]];f["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]];o=true}function _update(e,t,r){var i,n;var a,s;var o,f;var c,l;var h,p;var d,y;var g,v;var m,C;var E,S;var T,I;var B,A;var _,b;var N,w;var R,L;var U,D,k,P,V,O,M;var K=r.length();while(K>=128){for(U=0;U<16;++U){t[U][0]=r.getInt32()>>>0;t[U][1]=r.getInt32()>>>0}for(;U<80;++U){P=t[U-2];D=P[0];k=P[1];i=((D>>>19|k<<13)^(k>>>29|D<<3)^D>>>6)>>>0;n=((D<<13|k>>>19)^(k<<3|D>>>29)^(D<<26|k>>>6))>>>0;O=t[U-15];D=O[0];k=O[1];a=((D>>>1|k<<31)^(D>>>8|k<<24)^D>>>7)>>>0;s=((D<<31|k>>>1)^(D<<24|k>>>8)^(D<<25|k>>>7))>>>0;V=t[U-7];M=t[U-16];k=n+V[1]+s+M[1];t[U][0]=i+V[0]+a+M[0]+(k/4294967296>>>0)>>>0;t[U][1]=k>>>0}g=e[0][0];v=e[0][1];m=e[1][0];C=e[1][1];E=e[2][0];S=e[2][1];T=e[3][0];I=e[3][1];B=e[4][0];A=e[4][1];_=e[5][0];b=e[5][1];N=e[6][0];w=e[6][1];R=e[7][0];L=e[7][1];for(U=0;U<80;++U){c=((B>>>14|A<<18)^(B>>>18|A<<14)^(A>>>9|B<<23))>>>0;l=((B<<18|A>>>14)^(B<<14|A>>>18)^(A<<23|B>>>9))>>>0;h=(N^B&(_^N))>>>0;p=(w^A&(b^w))>>>0;o=((g>>>28|v<<4)^(v>>>2|g<<30)^(v>>>7|g<<25))>>>0;f=((g<<4|v>>>28)^(v<<30|g>>>2)^(v<<25|g>>>7))>>>0;d=(g&m|E&(g^m))>>>0;y=(v&C|S&(v^C))>>>0;k=L+l+p+u[U][1]+t[U][1];i=R+c+h+u[U][0]+t[U][0]+(k/4294967296>>>0)>>>0;n=k>>>0;k=f+y;a=o+d+(k/4294967296>>>0)>>>0;s=k>>>0;R=N;L=w;N=_;w=b;_=B;b=A;k=I+n;B=T+i+(k/4294967296>>>0)>>>0;A=k>>>0;T=E;I=S;E=m;S=C;m=g;C=v;k=n+s;g=i+a+(k/4294967296>>>0)>>>0;v=k>>>0}k=e[0][1]+v;e[0][0]=e[0][0]+g+(k/4294967296>>>0)>>>0;e[0][1]=k>>>0;k=e[1][1]+C;e[1][0]=e[1][0]+m+(k/4294967296>>>0)>>>0;e[1][1]=k>>>0;k=e[2][1]+S;e[2][0]=e[2][0]+E+(k/4294967296>>>0)>>>0;e[2][1]=k>>>0;k=e[3][1]+I;e[3][0]=e[3][0]+T+(k/4294967296>>>0)>>>0;e[3][1]=k>>>0;k=e[4][1]+A;e[4][0]=e[4][0]+B+(k/4294967296>>>0)>>>0;e[4][1]=k>>>0;k=e[5][1]+b;e[5][0]=e[5][0]+_+(k/4294967296>>>0)>>>0;e[5][1]=k>>>0;k=e[6][1]+w;e[6][0]=e[6][0]+N+(k/4294967296>>>0)>>>0;e[6][1]=k>>>0;k=e[7][1]+L;e[7][0]=e[7][0]+R+(k/4294967296>>>0)>>>0;e[7][1]=k>>>0;K-=128}}},789:function(e,t,r){var i=r(936);r(511);r(722);r(400);r(88);r(183);r(104);r(621);if(typeof n==="undefined"){var n=i.jsbn.BigInteger}var a=i.util.isNodejs?r(417):null;var s=i.asn1;var o=i.util;i.pki=i.pki||{};e.exports=i.pki.rsa=i.rsa=i.rsa||{};var u=i.pki;var f=[6,4,2,4,2,4,6,2];var c={name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"PrivateKeyInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:false,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:false,capture:"privateKey"}]};var l={name:"RSAPrivateKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"RSAPrivateKey.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyCoefficient"}]};var h={name:"RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"RSAPublicKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"publicKeyExponent"}]};var p=i.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:false,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:false,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,optional:true,captureAsn1:"rsaPublicKey"}]}]};var d=function(e){var t;if(e.algorithm in u.oids){t=u.oids[e.algorithm]}else{var r=new Error("Unknown message digest algorithm.");r.algorithm=e.algorithm;throw r}var i=s.oidToDer(t).getBytes();var n=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[]);var a=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[]);a.value.push(s.create(s.Class.UNIVERSAL,s.Type.OID,false,i));a.value.push(s.create(s.Class.UNIVERSAL,s.Type.NULL,false,""));var o=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,false,e.digest().getBytes());n.value.push(a);n.value.push(o);return s.toDer(n).getBytes()};var y=function(e,t,r){if(r){return e.modPow(t.e,t.n)}if(!t.p||!t.q){return e.modPow(t.d,t.n)}if(!t.dP){t.dP=t.d.mod(t.p.subtract(n.ONE))}if(!t.dQ){t.dQ=t.d.mod(t.q.subtract(n.ONE))}if(!t.qInv){t.qInv=t.q.modInverse(t.p)}var a;do{a=new n(i.util.bytesToHex(i.random.getBytes(t.n.bitLength()/8)),16)}while(a.compareTo(t.n)>=0||!a.gcd(t.n).equals(n.ONE));e=e.multiply(a.modPow(t.e,t.n)).mod(t.n);var s=e.mod(t.p).modPow(t.dP,t.p);var o=e.mod(t.q).modPow(t.dQ,t.q);while(s.compareTo(o)<0){s=s.add(t.p)}var u=s.subtract(o).multiply(t.qInv).mod(t.p).multiply(t.q).add(o);u=u.multiply(a.modInverse(t.n)).mod(t.n);return u};u.rsa.encrypt=function(e,t,r){var a=r;var s;var o=Math.ceil(t.n.bitLength()/8);if(r!==false&&r!==true){a=r===2;s=_encodePkcs1_v1_5(e,t,r)}else{s=i.util.createBuffer();s.putBytes(e)}var u=new n(s.toHex(),16);var f=y(u,t,a);var c=f.toString(16);var l=i.util.createBuffer();var h=o-Math.ceil(c.length/2);while(h>0){l.putByte(0);--h}l.putBytes(i.util.hexToBytes(c));return l.getBytes()};u.rsa.decrypt=function(e,t,r,a){var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var o=new Error("Encrypted message length is invalid.");o.length=e.length;o.expected=s;throw o}var u=new n(i.util.createBuffer(e).toHex(),16);if(u.compareTo(t.n)>=0){throw new Error("Encrypted message is invalid.")}var f=y(u,t,r);var c=f.toString(16);var l=i.util.createBuffer();var h=s-Math.ceil(c.length/2);while(h>0){l.putByte(0);--h}l.putBytes(i.util.hexToBytes(c));if(a!==false){return _decodePkcs1_v1_5(l.getBytes(),t,r)}return l.getBytes()};u.rsa.createKeyPairGenerationState=function(e,t,r){if(typeof e==="string"){e=parseInt(e,10)}e=e||2048;r=r||{};var a=r.prng||i.random;var s={nextBytes:function(e){var t=a.getBytesSync(e.length);for(var r=0;r<e.length;++r){e[r]=t.charCodeAt(r)}}};var o=r.algorithm||"PRIMEINC";var u;if(o==="PRIMEINC"){u={algorithm:o,state:0,bits:e,rng:s,eInt:t||65537,e:new n(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null};u.e.fromInt(u.eInt)}else{throw new Error("Invalid key generation algorithm: "+o)}return u};u.rsa.stepKeyPairGenerationState=function(e,t){if(!("algorithm"in e)){e.algorithm="PRIMEINC"}var r=new n(null);r.fromInt(30);var i=0;var a=function(e,t){return e|t};var s=+new Date;var o;var c=0;while(e.keys===null&&(t<=0||c<t)){if(e.state===0){var l=e.p===null?e.pBits:e.qBits;var h=l-1;if(e.pqState===0){e.num=new n(l,e.rng);if(!e.num.testBit(h)){e.num.bitwiseTo(n.ONE.shiftLeft(h),a,e.num)}e.num.dAddOffset(31-e.num.mod(r).byteValue(),0);i=0;++e.pqState}else if(e.pqState===1){if(e.num.bitLength()>l){e.pqState=0}else if(e.num.isProbablePrime(_getMillerRabinTests(e.num.bitLength()))){++e.pqState}else{e.num.dAddOffset(f[i++%8],0)}}else if(e.pqState===2){e.pqState=e.num.subtract(n.ONE).gcd(e.e).compareTo(n.ONE)===0?3:0}else if(e.pqState===3){e.pqState=0;if(e.p===null){e.p=e.num}else{e.q=e.num}if(e.p!==null&&e.q!==null){++e.state}e.num=null}}else if(e.state===1){if(e.p.compareTo(e.q)<0){e.num=e.p;e.p=e.q;e.q=e.num}++e.state}else if(e.state===2){e.p1=e.p.subtract(n.ONE);e.q1=e.q.subtract(n.ONE);e.phi=e.p1.multiply(e.q1);++e.state}else if(e.state===3){if(e.phi.gcd(e.e).compareTo(n.ONE)===0){++e.state}else{e.p=null;e.q=null;e.state=0}}else if(e.state===4){e.n=e.p.multiply(e.q);if(e.n.bitLength()===e.bits){++e.state}else{e.q=null;e.state=0}}else if(e.state===5){var p=e.e.modInverse(e.phi);e.keys={privateKey:u.rsa.setPrivateKey(e.n,e.e,p,e.p,e.q,p.mod(e.p1),p.mod(e.q1),e.q.modInverse(e.p)),publicKey:u.rsa.setPublicKey(e.n,e.e)}}o=+new Date;c+=o-s;s=o}return e.keys!==null};u.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1){if(typeof e==="object"){r=e;e=undefined}else if(typeof e==="function"){n=e;e=undefined}}else if(arguments.length===2){if(typeof e==="number"){if(typeof t==="function"){n=t;t=undefined}else if(typeof t!=="number"){r=t;t=undefined}}else{r=e;n=t;e=undefined;t=undefined}}else if(arguments.length===3){if(typeof t==="number"){if(typeof r==="function"){n=r;r=undefined}}else{n=r;r=t;t=undefined}}r=r||{};if(e===undefined){e=r.bits||2048}if(t===undefined){t=r.e||65537}if(!i.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(_detectNodeCrypto("generateKeyPair")){return a.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(e,t,r){if(e){return n(e)}n(null,{privateKey:u.privateKeyFromPem(r),publicKey:u.publicKeyFromPem(t)})})}if(_detectSubtleCrypto("generateKey")&&_detectSubtleCrypto("exportKey")){return o.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:_intToUint8Array(t),hash:{name:"SHA-256"}},true,["sign","verify"]).then(function(e){return o.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)}).then(undefined,function(e){n(e)}).then(function(e){if(e){var t=u.privateKeyFromAsn1(s.fromDer(i.util.createBuffer(e)));n(null,{privateKey:t,publicKey:u.setRsaPublicKey(t.n,t.e)})}})}if(_detectSubtleMsCrypto("generateKey")&&_detectSubtleMsCrypto("exportKey")){var f=o.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:_intToUint8Array(t),hash:{name:"SHA-256"}},true,["sign","verify"]);f.oncomplete=function(e){var t=e.target.result;var r=o.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result;var r=u.privateKeyFromAsn1(s.fromDer(i.util.createBuffer(t)));n(null,{privateKey:r,publicKey:u.setRsaPublicKey(r.n,r.e)})};r.onerror=function(e){n(e)}};f.onerror=function(e){n(e)};return}}else{if(_detectNodeCrypto("generateKeyPairSync")){var c=a.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:u.privateKeyFromPem(c.privateKey),publicKey:u.publicKeyFromPem(c.publicKey)}}}}var l=u.rsa.createKeyPairGenerationState(e,t,r);if(!n){u.rsa.stepKeyPairGenerationState(l,0);return l.keys}_generateKeyPair(l,r,n)};u.setRsaPublicKey=u.rsa.setPublicKey=function(e,t){var r={n:e,e:t};r.encrypt=function(e,t,n){if(typeof t==="string"){t=t.toUpperCase()}else if(t===undefined){t="RSAES-PKCS1-V1_5"}if(t==="RSAES-PKCS1-V1_5"){t={encode:function(e,t,r){return _encodePkcs1_v1_5(e,t,2).getBytes()}}}else if(t==="RSA-OAEP"||t==="RSAES-OAEP"){t={encode:function(e,t){return i.pkcs1.encode_rsa_oaep(t,e,n)}}}else if(["RAW","NONE","NULL",null].indexOf(t)!==-1){t={encode:function(e){return e}}}else if(typeof t==="string"){throw new Error('Unsupported encryption scheme: "'+t+'".')}var a=t.encode(e,r,true);return u.rsa.encrypt(a,r,true)};r.verify=function(e,t,i){if(typeof i==="string"){i=i.toUpperCase()}else if(i===undefined){i="RSASSA-PKCS1-V1_5"}if(i==="RSASSA-PKCS1-V1_5"){i={verify:function(e,t){t=_decodePkcs1_v1_5(t,r,true);var i=s.fromDer(t);return e===i.value[1].value}}}else if(i==="NONE"||i==="NULL"||i===null){i={verify:function(e,t){t=_decodePkcs1_v1_5(t,r,true);return e===t}}}var n=u.rsa.decrypt(t,r,true,false);return i.verify(e,n,r.n.bitLength())};return r};u.setRsaPrivateKey=u.rsa.setPrivateKey=function(e,t,r,n,a,s,o,f){var c={n:e,e:t,d:r,p:n,q:a,dP:s,dQ:o,qInv:f};c.decrypt=function(e,t,r){if(typeof t==="string"){t=t.toUpperCase()}else if(t===undefined){t="RSAES-PKCS1-V1_5"}var n=u.rsa.decrypt(e,c,false,false);if(t==="RSAES-PKCS1-V1_5"){t={decode:_decodePkcs1_v1_5}}else if(t==="RSA-OAEP"||t==="RSAES-OAEP"){t={decode:function(e,t){return i.pkcs1.decode_rsa_oaep(t,e,r)}}}else if(["RAW","NONE","NULL",null].indexOf(t)!==-1){t={decode:function(e){return e}}}else{throw new Error('Unsupported encryption scheme: "'+t+'".')}return t.decode(n,c,false)};c.sign=function(e,t){var r=false;if(typeof t==="string"){t=t.toUpperCase()}if(t===undefined||t==="RSASSA-PKCS1-V1_5"){t={encode:d};r=1}else if(t==="NONE"||t==="NULL"||t===null){t={encode:function(){return e}};r=1}var i=t.encode(e,c.n.bitLength());return u.rsa.encrypt(i,c,r)};return c};u.wrapRsaPrivateKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.OID,false,s.oidToDer(u.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,false,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,false,s.toDer(e).getBytes())])};u.privateKeyFromAsn1=function(e){var t={};var r=[];if(s.validate(e,c,t,r)){e=s.fromDer(i.util.createBuffer(t.privateKey))}t={};r=[];if(!s.validate(e,l,t,r)){var a=new Error("Cannot read private key. "+"ASN.1 object does not contain an RSAPrivateKey.");a.errors=r;throw a}var o,f,h,p,d,y,g,v;o=i.util.createBuffer(t.privateKeyModulus).toHex();f=i.util.createBuffer(t.privateKeyPublicExponent).toHex();h=i.util.createBuffer(t.privateKeyPrivateExponent).toHex();p=i.util.createBuffer(t.privateKeyPrime1).toHex();d=i.util.createBuffer(t.privateKeyPrime2).toHex();y=i.util.createBuffer(t.privateKeyExponent1).toHex();g=i.util.createBuffer(t.privateKeyExponent2).toHex();v=i.util.createBuffer(t.privateKeyCoefficient).toHex();return u.setRsaPrivateKey(new n(o,16),new n(f,16),new n(h,16),new n(p,16),new n(d,16),new n(y,16),new n(g,16),new n(v,16))};u.privateKeyToAsn1=u.privateKeyToRSAPrivateKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.e)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.d)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.p)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.q)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.dP)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.dQ)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.qInv))])};u.publicKeyFromAsn1=function(e){var t={};var r=[];if(s.validate(e,p,t,r)){var a=s.derToOid(t.publicKeyOid);if(a!==u.oids.rsaEncryption){var o=new Error("Cannot read public key. Unknown OID.");o.oid=a;throw o}e=t.rsaPublicKey}r=[];if(!s.validate(e,h,t,r)){var o=new Error("Cannot read public key. "+"ASN.1 object does not contain an RSAPublicKey.");o.errors=r;throw o}var f=i.util.createBuffer(t.publicKeyModulus).toHex();var c=i.util.createBuffer(t.publicKeyExponent).toHex();return u.setRsaPublicKey(new n(f,16),new n(c,16))};u.publicKeyToAsn1=u.publicKeyToSubjectPublicKeyInfo=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.OID,false,s.oidToDer(u.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,false,"")]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,false,[u.publicKeyToRSAPublicKey(e)])])};u.publicKeyToRSAPublicKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,_bnToBytes(e.e))])};function _encodePkcs1_v1_5(e,t,r){var n=i.util.createBuffer();var a=Math.ceil(t.n.bitLength()/8);if(e.length>a-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");s.length=e.length;s.max=a-11;throw s}n.putByte(0);n.putByte(r);var o=a-3-e.length;var u;if(r===0||r===1){u=r===0?0:255;for(var f=0;f<o;++f){n.putByte(u)}}else{while(o>0){var c=0;var l=i.random.getBytes(o);for(var f=0;f<o;++f){u=l.charCodeAt(f);if(u===0){++c}else{n.putByte(u)}}o=c}}n.putByte(0);n.putBytes(e);return n}function _decodePkcs1_v1_5(e,t,r,n){var a=Math.ceil(t.n.bitLength()/8);var s=i.util.createBuffer(e);var o=s.getByte();var u=s.getByte();if(o!==0||r&&u!==0&&u!==1||!r&&u!=2||r&&u===0&&typeof n==="undefined"){throw new Error("Encryption block is invalid.")}var f=0;if(u===0){f=a-3-n;for(var c=0;c<f;++c){if(s.getByte()!==0){throw new Error("Encryption block is invalid.")}}}else if(u===1){f=0;while(s.length()>1){if(s.getByte()!==255){--s.read;break}++f}}else if(u===2){f=0;while(s.length()>1){if(s.getByte()===0){--s.read;break}++f}}var l=s.getByte();if(l!==0||f!==a-3-s.length()){throw new Error("Encryption block is invalid.")}return s.getBytes()}function _generateKeyPair(e,t,r){if(typeof t==="function"){r=t;t={}}t=t||{};var a={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};if("prng"in t){a.prng=t.prng}generate();function generate(){getPrime(e.pBits,function(t,i){if(t){return r(t)}e.p=i;if(e.q!==null){return finish(t,e.q)}getPrime(e.qBits,finish)})}function getPrime(e,t){i.prime.generateProbablePrime(e,a,t)}function finish(t,i){if(t){return r(t)}e.q=i;if(e.p.compareTo(e.q)<0){var a=e.p;e.p=e.q;e.q=a}if(e.p.subtract(n.ONE).gcd(e.e).compareTo(n.ONE)!==0){e.p=null;generate();return}if(e.q.subtract(n.ONE).gcd(e.e).compareTo(n.ONE)!==0){e.q=null;getPrime(e.qBits,finish);return}e.p1=e.p.subtract(n.ONE);e.q1=e.q.subtract(n.ONE);e.phi=e.p1.multiply(e.q1);if(e.phi.gcd(e.e).compareTo(n.ONE)!==0){e.p=e.q=null;generate();return}e.n=e.p.multiply(e.q);if(e.n.bitLength()!==e.bits){e.q=null;getPrime(e.qBits,finish);return}var s=e.e.modInverse(e.phi);e.keys={privateKey:u.rsa.setPrivateKey(e.n,e.e,s,e.p,e.q,s.mod(e.p1),s.mod(e.q1),e.q.modInverse(e.p)),publicKey:u.rsa.setPublicKey(e.n,e.e)};r(null,e.keys)}}function _bnToBytes(e){var t=e.toString(16);if(t[0]>="8"){t="00"+t}var r=i.util.hexToBytes(t);if(r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)===0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)){return r.substr(1)}return r}function _getMillerRabinTests(e){if(e<=100)return 27;if(e<=150)return 18;if(e<=200)return 15;if(e<=250)return 12;if(e<=300)return 9;if(e<=350)return 8;if(e<=400)return 7;if(e<=500)return 6;if(e<=600)return 5;if(e<=800)return 4;if(e<=1250)return 3;return 2}function _detectNodeCrypto(e){return i.util.isNodejs&&typeof a[e]==="function"}function _detectSubtleCrypto(e){return typeof o.globalScope!=="undefined"&&typeof o.globalScope.crypto==="object"&&typeof o.globalScope.crypto.subtle==="object"&&typeof o.globalScope.crypto.subtle[e]==="function"}function _detectSubtleMsCrypto(e){return typeof o.globalScope!=="undefined"&&typeof o.globalScope.msCrypto==="object"&&typeof o.globalScope.msCrypto.subtle==="object"&&typeof o.globalScope.msCrypto.subtle[e]==="function"}function _intToUint8Array(e){var t=i.util.hexToBytes(e.toString(16));var r=new Uint8Array(t.length);for(var n=0;n<t.length;++n){r[n]=t.charCodeAt(n)}return r}function _privateKeyFromJwk(e){if(e.kty!=="RSA"){throw new Error('Unsupported key algorithm "'+e.kty+'"; algorithm must be "RSA".')}return u.setRsaPrivateKey(_base64ToBigInt(e.n),_base64ToBigInt(e.e),_base64ToBigInt(e.d),_base64ToBigInt(e.p),_base64ToBigInt(e.q),_base64ToBigInt(e.dp),_base64ToBigInt(e.dq),_base64ToBigInt(e.qi))}function _publicKeyFromJwk(e){if(e.kty!=="RSA"){throw new Error('Key algorithm must be "RSA".')}return u.setRsaPublicKey(_base64ToBigInt(e.n),_base64ToBigInt(e.e))}function _base64ToBigInt(e){return new n(i.util.bytesToHex(i.util.decode64(e)),16)}},859:function(e,t,r){var i=r(936);r(621);var n=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173];var a=[1,2,3,5];var s=function(e,t){return e<<t&65535|(e&65535)>>16-t};var o=function(e,t){return(e&65535)>>t|e<<16-t&65535};e.exports=i.rc2=i.rc2||{};i.rc2.expandKey=function(e,t){if(typeof e==="string"){e=i.util.createBuffer(e)}t=t||128;var r=e;var a=e.length();var s=t;var o=Math.ceil(s/8);var u=255>>(s&7);var f;for(f=a;f<128;f++){r.putByte(n[r.at(f-1)+r.at(f-a)&255])}r.setAt(128-o,n[r.at(128-o)&u]);for(f=127-o;f>=0;f--){r.setAt(f,n[r.at(f+1)^r.at(f+o)])}return r};var u=function(e,t,r){var n=false,u=null,f=null,c=null;var l,h;var p,d,y=[];e=i.rc2.expandKey(e,t);for(p=0;p<64;p++){y.push(e.getInt16Le())}if(r){l=function(e){for(p=0;p<4;p++){e[p]+=y[d]+(e[(p+3)%4]&e[(p+2)%4])+(~e[(p+3)%4]&e[(p+1)%4]);e[p]=s(e[p],a[p]);d++}};h=function(e){for(p=0;p<4;p++){e[p]+=y[e[(p+3)%4]&63]}}}else{l=function(e){for(p=3;p>=0;p--){e[p]=o(e[p],a[p]);e[p]-=y[d]+(e[(p+3)%4]&e[(p+2)%4])+(~e[(p+3)%4]&e[(p+1)%4]);d--}};h=function(e){for(p=3;p>=0;p--){e[p]-=y[e[(p+3)%4]&63]}}}var g=function(e){var t=[];for(p=0;p<4;p++){var i=u.getInt16Le();if(c!==null){if(r){i^=c.getInt16Le()}else{c.putInt16Le(i)}}t.push(i&65535)}d=r?0:63;for(var n=0;n<e.length;n++){for(var a=0;a<e[n][0];a++){e[n][1](t)}}for(p=0;p<4;p++){if(c!==null){if(r){c.putInt16Le(t[p])}else{t[p]^=c.getInt16Le()}}f.putInt16Le(t[p])}};var v=null;v={start:function(e,t){if(e){if(typeof e==="string"){e=i.util.createBuffer(e)}}n=false;u=i.util.createBuffer();f=t||new i.util.createBuffer;c=e;v.output=f},update:function(e){if(!n){u.putBuffer(e)}while(u.length()>=8){g([[5,l],[1,h],[6,l],[1,h],[5,l]])}},finish:function(e){var t=true;if(r){if(e){t=e(8,u,!r)}else{var i=u.length()===8?8:8-u.length();u.fillWithByte(i,i)}}if(t){n=true;v.update()}if(!r){t=u.length()===0;if(t){if(e){t=e(8,f,!r)}else{var a=f.length();var s=f.at(a-1);if(s>a){t=false}else{f.truncate(s)}}}}return t}};return v};i.rc2.startEncrypting=function(e,t,r){var n=i.rc2.createEncryptionCipher(e,128);n.start(t,r);return n};i.rc2.createEncryptionCipher=function(e,t){return u(e,t,true)};i.rc2.startDecrypting=function(e,t,r){var n=i.rc2.createDecryptionCipher(e,128);n.start(t,r);return n};i.rc2.createDecryptionCipher=function(e,t){return u(e,t,false)}},867:function(e,t,r){var i=r(936);r(621);r(104);r(722);e.exports=i.kem=i.kem||{};var n=i.jsbn.BigInteger;i.kem.rsa={};i.kem.rsa.create=function(e,t){t=t||{};var r=t.prng||i.random;var a={};a.encrypt=function(t,a){var s=Math.ceil(t.n.bitLength()/8);var o;do{o=new n(i.util.bytesToHex(r.getBytesSync(s)),16).mod(t.n)}while(o.compareTo(n.ONE)<=0);o=i.util.hexToBytes(o.toString(16));var u=s-o.length;if(u>0){o=i.util.fillString(String.fromCharCode(0),u)+o}var f=t.encrypt(o,"NONE");var c=e.generate(o,a);return{encapsulation:f,key:c}};a.decrypt=function(t,r,i){var n=t.decrypt(r,"NONE");return e.generate(n,i)};return a};i.kem.kdf1=function(e,t){_createKDF(this,e,0,t||e.digestLength)};i.kem.kdf2=function(e,t){_createKDF(this,e,1,t||e.digestLength)};function _createKDF(e,t,r,n){e.generate=function(e,a){var s=new i.util.ByteBuffer;var o=Math.ceil(a/n)+r;var u=new i.util.ByteBuffer;for(var f=r;f<o;++f){u.putInt32(f);t.start();t.update(e+u.getBytes());var c=t.digest();s.putBytes(c.getBytes(n))}s.truncate(s.length()-a);return s.getBytes()}}},903:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});r(905)},905:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){function adopt(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,n){function fulfilled(e){try{step(i.next(e))}catch(e){n(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){n(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())})};var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const a=r(747);const s=r(582);const o=n(r(622));const u=__dirname;(()=>i(void 0,void 0,void 0,function*(){try{const e=yield collect(u);const t=JSON.stringify(e);const r=o.default.join(__dirname,"__COLLECTED__CSRS___.json");console.log(`WRITING CSRS TO ${r}`);yield a.promises.writeFile(r,t)}catch(e){console.error(e)}}))();function collect(e){return i(this,void 0,void 0,function*(){const t=new Date;const r={};const i=yield a.promises.readdir(e);for(const n of i){const i=o.default.join(e,n);const u=yield a.promises.stat(i);if(u.isDirectory()){const e=yield collect(i);Object.assign(r,e)}if(u.isFile()){if(n.match(/^.*cert\.pem$/)){const e=yield a.promises.readFile(i,"utf8");const n=s.pki.certificateFromPem(e);console.log(i);console.log(n.validity.notAfter);if(n.validity.notAfter<=t){r[i]={csr:yield createCsr(n,i)}}}}}return r})}function createCsr(e,t){return i(this,void 0,void 0,function*(){const r=t.replace(/\.cert\.pem$/,".key.pem");const i=yield a.promises.readFile(r,"utf8");const n=s.pki.privateKeyFromPem(i);const o=s.pki.createCertificationRequest();o.extensions=e.extensions;o.subject=e.subject;o.publicKey=e.publicKey;o.sign(n);const u=s.pki.certificationRequestToPem(o);return u})}},907:function(e,t,r){var i=r(936);e.exports=i.debug=i.debug||{};i.debug.storage={};i.debug.get=function(e,t){var r;if(typeof e==="undefined"){r=i.debug.storage}else if(e in i.debug.storage){if(typeof t==="undefined"){r=i.debug.storage[e]}else{r=i.debug.storage[e][t]}}return r};i.debug.set=function(e,t,r){if(!(e in i.debug.storage)){i.debug.storage[e]={}}i.debug.storage[e][t]=r};i.debug.clear=function(e,t){if(typeof e==="undefined"){i.debug.storage={}}else if(e in i.debug.storage){if(typeof t==="undefined"){delete i.debug.storage[e]}else{delete i.debug.storage[e][t]}}}},923:function(e,t,r){var i=r(936);r(511);r(621);var n=i.asn1;var a=e.exports=i.pkcs7asn1=i.pkcs7asn1||{};i.pkcs7=i.pkcs7||{};i.pkcs7.asn1=a;var s={name:"ContentInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"ContentInfo.ContentType",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"contentType"},{name:"ContentInfo.content",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,captureAsn1:"content"}]};a.contentInfoValidator=s;var o={name:"EncryptedContentInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"EncryptedContentInfo.contentType",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:n.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};a.envelopedDataValidator={name:"EnvelopedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"EnvelopedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:true,captureAsn1:"recipientInfos"}].concat(o)};a.encryptedDataValidator={name:"EncryptedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"EncryptedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,capture:"version"}].concat(o)};var u={name:"SignerInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"SignerInfo.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false},{name:"SignerInfo.issuerAndSerialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:n.Class.UNIVERSAL,constructed:false,captureAsn1:"digestParameter",optional:true}]},{name:"SignerInfo.authenticatedAttributes",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:false,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,constructed:true,optional:true,capture:"unauthenticatedAttributes"}]};a.signedDataValidator={name:"SignedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"SignedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:true,captureAsn1:"digestAlgorithms"},s,{name:"SignedData.Certificates",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,optional:true,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,optional:true,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,capture:"signerInfos",optional:true,value:[u]}]};a.recipientInfoValidator={name:"RecipientInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"RecipientInfo.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:false,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:true,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:false,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:n.Class.UNIVERSAL,constructed:false,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:false,capture:"encKey"}]}},936:function(e){e.exports={options:{usePureJavaScript:false}}},960:function(e,t,r){var i=r(936);r(621);e.exports=i.cipher=i.cipher||{};i.cipher.algorithms=i.cipher.algorithms||{};i.cipher.createCipher=function(e,t){var r=e;if(typeof r==="string"){r=i.cipher.getAlgorithm(r);if(r){r=r()}}if(!r){throw new Error("Unsupported algorithm: "+e)}return new i.cipher.BlockCipher({algorithm:r,key:t,decrypt:false})};i.cipher.createDecipher=function(e,t){var r=e;if(typeof r==="string"){r=i.cipher.getAlgorithm(r);if(r){r=r()}}if(!r){throw new Error("Unsupported algorithm: "+e)}return new i.cipher.BlockCipher({algorithm:r,key:t,decrypt:true})};i.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase();i.cipher.algorithms[e]=t};i.cipher.getAlgorithm=function(e){e=e.toUpperCase();if(e in i.cipher.algorithms){return i.cipher.algorithms[e]}return null};var n=i.cipher.BlockCipher=function(e){this.algorithm=e.algorithm;this.mode=this.algorithm.mode;this.blockSize=this.mode.blockSize;this._finish=false;this._input=null;this.output=null;this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt;this._decrypt=e.decrypt;this.algorithm.initialize(e)};n.prototype.start=function(e){e=e||{};var t={};for(var r in e){t[r]=e[r]}t.decrypt=this._decrypt;this._finish=false;this._input=i.util.createBuffer();this.output=e.output||i.util.createBuffer();this.mode.start(t)};n.prototype.update=function(e){if(e){this._input.putBuffer(e)}while(!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish){}this._input.compact()};n.prototype.finish=function(e){if(e&&(this.mode.name==="ECB"||this.mode.name==="CBC")){this.mode.pad=function(t){return e(this.blockSize,t,false)};this.mode.unpad=function(t){return e(this.blockSize,t,true)}}var t={};t.decrypt=this._decrypt;t.overflow=this._input.length()%this.blockSize;if(!this._decrypt&&this.mode.pad){if(!this.mode.pad(this._input,t)){return false}}this._finish=true;this.update();if(this._decrypt&&this.mode.unpad){if(!this.mode.unpad(this.output,t)){return false}}if(this.mode.afterFinish){if(!this.mode.afterFinish(this.output,t)){return false}}return true}}});